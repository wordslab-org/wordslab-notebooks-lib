<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mistral vibe 2.0 – wordslab-notebooks-lib</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Mistral vibe 2.0 – wordslab-notebooks-lib">
<meta property="og:description" content="Python library to help with AI usage in wordslab-notebooks">
<meta property="og:site_name" content="wordslab-notebooks-lib">
<meta name="twitter:title" content="Mistral vibe 2.0 – wordslab-notebooks-lib">
<meta name="twitter:description" content="Python library to help with AI usage in wordslab-notebooks">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">wordslab-notebooks-lib</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tools_study_mistral-vibe.html">Mistral vibe 2.0</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.core</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.env</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.chat</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_answerai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Answerai tools study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_anthropic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anthropic tools study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_mistral-vibe.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Mistral vibe 2.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.notebook</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mistral-vibe-architecture-overview" id="toc-mistral-vibe-architecture-overview" class="nav-link active" data-scroll-target="#mistral-vibe-architecture-overview">Mistral Vibe Architecture Overview</a>
  <ul class="collapse">
  <li><a href="#core-architecture-components" id="toc-core-architecture-components" class="nav-link" data-scroll-target="#core-architecture-components">Core Architecture Components</a></li>
  <li><a href="#key-features-and-workflows" id="toc-key-features-and-workflows" class="nav-link" data-scroll-target="#key-features-and-workflows">Key Features and Workflows</a></li>
  <li><a href="#architecture-patterns" id="toc-architecture-patterns" class="nav-link" data-scroll-target="#architecture-patterns">Architecture Patterns</a></li>
  <li><a href="#data-flow" id="toc-data-flow" class="nav-link" data-scroll-target="#data-flow">Data Flow</a></li>
  </ul></li>
  <li><a href="#mistral-vibe-tool-system-analysis" id="toc-mistral-vibe-tool-system-analysis" class="nav-link" data-scroll-target="#mistral-vibe-tool-system-analysis">Mistral Vibe Tool System Analysis</a></li>
  <li><a href="#built-in-tools" id="toc-built-in-tools" class="nav-link" data-scroll-target="#built-in-tools">Built-in Tools</a>
  <ul class="collapse">
  <li><a href="#read_file" id="toc-read_file" class="nav-link" data-scroll-target="#read_file">1. read_file</a></li>
  <li><a href="#write_file" id="toc-write_file" class="nav-link" data-scroll-target="#write_file">2. write_file</a></li>
  <li><a href="#search_replace" id="toc-search_replace" class="nav-link" data-scroll-target="#search_replace">3. search_replace</a></li>
  <li><a href="#bash" id="toc-bash" class="nav-link" data-scroll-target="#bash">4. bash</a></li>
  <li><a href="#grep" id="toc-grep" class="nav-link" data-scroll-target="#grep">5. grep</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo">6. todo</a></li>
  <li><a href="#ask_user_question" id="toc-ask_user_question" class="nav-link" data-scroll-target="#ask_user_question">7. ask_user_question</a></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task">8. task</a></li>
  </ul></li>
  <li><a href="#base-tool-security-framework" id="toc-base-tool-security-framework" class="nav-link" data-scroll-target="#base-tool-security-framework">Base Tool Security Framework</a>
  <ul class="collapse">
  <li><a href="#basetool-class" id="toc-basetool-class" class="nav-link" data-scroll-target="#basetool-class">BaseTool Class</a></li>
  <li><a href="#toolpermission-system" id="toc-toolpermission-system" class="nav-link" data-scroll-target="#toolpermission-system">ToolPermission System</a></li>
  <li><a href="#invokecontext" id="toc-invokecontext" class="nav-link" data-scroll-target="#invokecontext">InvokeContext</a></li>
  </ul></li>
  <li><a href="#security-best-practices" id="toc-security-best-practices" class="nav-link" data-scroll-target="#security-best-practices">Security Best Practices</a>
  <ul class="collapse">
  <li><a href="#path-security" id="toc-path-security" class="nav-link" data-scroll-target="#path-security">Path Security</a></li>
  <li><a href="#command-security" id="toc-command-security" class="nav-link" data-scroll-target="#command-security">Command Security</a></li>
  <li><a href="#file-security" id="toc-file-security" class="nav-link" data-scroll-target="#file-security">File Security</a></li>
  <li><a href="#process-security" id="toc-process-security" class="nav-link" data-scroll-target="#process-security">Process Security</a></li>
  <li><a href="#data-security" id="toc-data-security" class="nav-link" data-scroll-target="#data-security">Data Security</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#mistral-vibe-tool-system-comprehensive-security-analysis" id="toc-mistral-vibe-tool-system-comprehensive-security-analysis" class="nav-link" data-scroll-target="#mistral-vibe-tool-system-comprehensive-security-analysis">Mistral Vibe Tool System: Comprehensive Security Analysis</a>
  <ul class="collapse">
  <li><a href="#built-in-tools-overview" id="toc-built-in-tools-overview" class="nav-link" data-scroll-target="#built-in-tools-overview">Built-in Tools Overview</a></li>
  <li><a href="#key-security-features" id="toc-key-security-features" class="nav-link" data-scroll-target="#key-security-features">Key Security Features</a></li>
  <li><a href="#security-architecture" id="toc-security-architecture" class="nav-link" data-scroll-target="#security-architecture">Security Architecture</a></li>
  <li><a href="#most-important-security-aspects" id="toc-most-important-security-aspects" class="nav-link" data-scroll-target="#most-important-security-aspects">Most Important Security Aspects</a></li>
  <li><a href="#system-prompt-construction" id="toc-system-prompt-construction" class="nav-link" data-scroll-target="#system-prompt-construction">System Prompt Construction</a></li>
  <li><a href="#tool-integration" id="toc-tool-integration" class="nav-link" data-scroll-target="#tool-integration">Tool Integration</a></li>
  <li><a href="#key-integration-points" id="toc-key-integration-points" class="nav-link" data-scroll-target="#key-integration-points">Key Integration Points</a></li>
  <li><a href="#tool-execution-flow" id="toc-tool-execution-flow" class="nav-link" data-scroll-target="#tool-execution-flow">Tool Execution Flow</a></li>
  <li><a href="#multi-layered-architecture" id="toc-multi-layered-architecture" class="nav-link" data-scroll-target="#multi-layered-architecture">Multi-Layered Architecture</a></li>
  </ul></li>
  <li><a href="#search-path-discovery" id="toc-search-path-discovery" class="nav-link" data-scroll-target="#search-path-discovery">1. Search Path Discovery</a></li>
  <li><a href="#tool-class-discovery" id="toc-tool-class-discovery" class="nav-link" data-scroll-target="#tool-class-discovery">2. Tool Class Discovery</a></li>
  <li><a href="#tool-loading-from-files" id="toc-tool-loading-from-files" class="nav-link" data-scroll-target="#tool-loading-from-files">3. Tool Loading from Files</a></li>
  <li><a href="#mcp-integration" id="toc-mcp-integration" class="nav-link" data-scroll-target="#mcp-integration">4. MCP Integration</a></li>
  <li><a href="#filtering-and-availability" id="toc-filtering-and-availability" class="nav-link" data-scroll-target="#filtering-and-availability">5. Filtering and Availability</a></li>
  <li><a href="#default-search-paths" id="toc-default-search-paths" class="nav-link" data-scroll-target="#default-search-paths">Default Search Paths</a></li>
  <li><a href="#basetool-class-explanation" id="toc-basetool-class-explanation" class="nav-link" data-scroll-target="#basetool-class-explanation">BaseTool Class Explanation</a>
  <ul class="collapse">
  <li><a href="#key-components" id="toc-key-components" class="nav-link" data-scroll-target="#key-components">Key Components:</a></li>
  <li><a href="#design-patterns" id="toc-design-patterns" class="nav-link" data-scroll-target="#design-patterns">Design Patterns:</a></li>
  </ul></li>
  <li><a href="#mcp-server-discovery-and-integration" id="toc-mcp-server-discovery-and-integration" class="nav-link" data-scroll-target="#mcp-server-discovery-and-integration">MCP Server Discovery and Integration</a>
  <ul class="collapse">
  <li><a href="#configuration-structure" id="toc-configuration-structure" class="nav-link" data-scroll-target="#configuration-structure">1. Configuration Structure</a></li>
  <li><a href="#discovery-process" id="toc-discovery-process" class="nav-link" data-scroll-target="#discovery-process">2. Discovery Process</a></li>
  <li><a href="#proxy-tool-creation" id="toc-proxy-tool-creation" class="nav-link" data-scroll-target="#proxy-tool-creation">3. Proxy Tool Creation</a></li>
  <li><a href="#tool-execution-flow-1" id="toc-tool-execution-flow-1" class="nav-link" data-scroll-target="#tool-execution-flow-1">4. Tool Execution Flow</a></li>
  <li><a href="#result-handling" id="toc-result-handling" class="nav-link" data-scroll-target="#result-handling">5. Result Handling</a></li>
  <li><a href="#error-handling" id="toc-error-handling" class="nav-link" data-scroll-target="#error-handling">6. Error Handling</a></li>
  <li><a href="#integration-points" id="toc-integration-points" class="nav-link" data-scroll-target="#integration-points">7. Integration Points</a></li>
  </ul></li>
  <li><a href="#web-search-not-activated" id="toc-web-search-not-activated" class="nav-link" data-scroll-target="#web-search-not-activated">Web search not activated</a>
  <ul class="collapse">
  <li><a href="#non-streaming-completion-_chat-method-line-575-580" id="toc-non-streaming-completion-_chat-method-line-575-580" class="nav-link" data-scroll-target="#non-streaming-completion-_chat-method-line-575-580">1. Non-Streaming Completion (<code>_chat()</code> method, line 575-580)</a></li>
  <li><a href="#streaming-completion-_chat_streaming-method-line-619-624" id="toc-streaming-completion-_chat_streaming-method-line-619-624" class="nav-link" data-scroll-target="#streaming-completion-_chat_streaming-method-line-619-624">2. Streaming Completion (<code>_chat_streaming()</code> method, line 619-624)</a></li>
  <li><a href="#token-counting-_compact_session-method-line-843" id="toc-token-counting-_compact_session-method-line-843" class="nav-link" data-scroll-target="#token-counting-_compact_session-method-line-843">3. Token Counting (<code>_compact_session()</code> method, line 843)</a></li>
  <li><a href="#current-headers" id="toc-current-headers" class="nav-link" data-scroll-target="#current-headers">Current Headers</a></li>
  <li><a href="#how-to-extend-for-web-search" id="toc-how-to-extend-for-web-search" class="nav-link" data-scroll-target="#how-to-extend-for-web-search">How to Extend for Web Search</a></li>
  <li><a href="#implementation-approach" id="toc-implementation-approach" class="nav-link" data-scroll-target="#implementation-approach">Implementation Approach</a></li>
  </ul></li>
  <li><a href="#mistral-vibe-concepts" id="toc-mistral-vibe-concepts" class="nav-link" data-scroll-target="#mistral-vibe-concepts">Mistral vibe concepts</a>
  <ul class="collapse">
  <li><a href="#agents" id="toc-agents" class="nav-link" data-scroll-target="#agents">1. <strong>Agents</strong></a></li>
  <li><a href="#subagents" id="toc-subagents" class="nav-link" data-scroll-target="#subagents">2. <strong>Subagents</strong></a></li>
  <li><a href="#skills" id="toc-skills" class="nav-link" data-scroll-target="#skills">3. <strong>Skills</strong></a></li>
  <li><a href="#relationship-between-components" id="toc-relationship-between-components" class="nav-link" data-scroll-target="#relationship-between-components">4. <strong>Relationship Between Components</strong></a></li>
  <li><a href="#personalization-files" id="toc-personalization-files" class="nav-link" data-scroll-target="#personalization-files">5. <strong>Personalization Files</strong></a></li>
  <li><a href="#configuration" id="toc-configuration" class="nav-link" data-scroll-target="#configuration">6. <strong>Configuration</strong></a></li>
  </ul></li>
  <li><a href="#files-users-can-create-for-personalization" id="toc-files-users-can-create-for-personalization" class="nav-link" data-scroll-target="#files-users-can-create-for-personalization">Files Users Can Create for Personalization</a>
  <ul class="collapse">
  <li><a href="#agent-configuration-files-.toml" id="toc-agent-configuration-files-.toml" class="nav-link" data-scroll-target="#agent-configuration-files-.toml">1. <strong>Agent Configuration Files</strong> (<code>.toml</code>)</a></li>
  <li><a href="#skill-definition-files-skill.md" id="toc-skill-definition-files-skill.md" class="nav-link" data-scroll-target="#skill-definition-files-skill.md">2. <strong>Skill Definition Files</strong> (<code>SKILL.md</code>)</a></li>
  <li><a href="#tool-definition-files-.py" id="toc-tool-definition-files-.py" class="nav-link" data-scroll-target="#tool-definition-files-.py">3. <strong>Tool Definition Files</strong> (<code>.py</code>)</a></li>
  <li><a href="#system-prompt-files-.md" id="toc-system-prompt-files-.md" class="nav-link" data-scroll-target="#system-prompt-files-.md">4. <strong>System Prompt Files</strong> (<code>.md</code>)</a></li>
  <li><a href="#main-configuration-file-config.toml" id="toc-main-configuration-file-config.toml" class="nav-link" data-scroll-target="#main-configuration-file-config.toml">5. <strong>Main Configuration File</strong> (<code>config.toml</code>)</a></li>
  <li><a href="#documentation-files-optional" id="toc-documentation-files-optional" class="nav-link" data-scroll-target="#documentation-files-optional">6. <strong>Documentation Files</strong> (Optional)</a></li>
  </ul></li>
  <li><a href="#mistral-vibe-agents-skills-subagents-and-personalization" id="toc-mistral-vibe-agents-skills-subagents-and-personalization" class="nav-link" data-scroll-target="#mistral-vibe-agents-skills-subagents-and-personalization">Mistral Vibe: Agents, Skills, Subagents, and Personalization</a></li>
  <li><a href="#agents-1" id="toc-agents-1" class="nav-link" data-scroll-target="#agents-1">Agents</a>
  <ul class="collapse">
  <li><a href="#agent-profile-structure" id="toc-agent-profile-structure" class="nav-link" data-scroll-target="#agent-profile-structure">Agent Profile Structure</a></li>
  <li><a href="#built-in-agents" id="toc-built-in-agents" class="nav-link" data-scroll-target="#built-in-agents">Built-in Agents</a></li>
  <li><a href="#agent-safety-levels" id="toc-agent-safety-levels" class="nav-link" data-scroll-target="#agent-safety-levels">Agent Safety Levels</a></li>
  <li><a href="#using-agents" id="toc-using-agents" class="nav-link" data-scroll-target="#using-agents">Using Agents</a></li>
  </ul></li>
  <li><a href="#subagents-1" id="toc-subagents-1" class="nav-link" data-scroll-target="#subagents-1">Subagents</a>
  <ul class="collapse">
  <li><a href="#key-characteristics" id="toc-key-characteristics" class="nav-link" data-scroll-target="#key-characteristics">Key Characteristics</a></li>
  <li><a href="#example-delegating-to-a-subagent" id="toc-example-delegating-to-a-subagent" class="nav-link" data-scroll-target="#example-delegating-to-a-subagent">Example: Delegating to a Subagent</a></li>
  <li><a href="#creating-custom-subagents" id="toc-creating-custom-subagents" class="nav-link" data-scroll-target="#creating-custom-subagents">Creating Custom Subagents</a></li>
  </ul></li>
  <li><a href="#skills-1" id="toc-skills-1" class="nav-link" data-scroll-target="#skills-1">Skills</a>
  <ul class="collapse">
  <li><a href="#skill-structure" id="toc-skill-structure" class="nav-link" data-scroll-target="#skill-structure">Skill Structure</a></li>
  <li><a href="#skill-metadata-fields" id="toc-skill-metadata-fields" class="nav-link" data-scroll-target="#skill-metadata-fields">Skill Metadata Fields</a></li>
  <li><a href="#skill-discovery-paths" id="toc-skill-discovery-paths" class="nav-link" data-scroll-target="#skill-discovery-paths">Skill Discovery Paths</a></li>
  <li><a href="#managing-skills" id="toc-managing-skills" class="nav-link" data-scroll-target="#managing-skills">Managing Skills</a></li>
  </ul></li>
  <li><a href="#relationship-between-agents-skills-and-tools" id="toc-relationship-between-agents-skills-and-tools" class="nav-link" data-scroll-target="#relationship-between-agents-skills-and-tools">Relationship Between Agents, Skills, and Tools</a>
  <ul class="collapse">
  <li><a href="#the-architecture" id="toc-the-architecture" class="nav-link" data-scroll-target="#the-architecture">The Architecture</a></li>
  <li><a href="#how-they-work-together" id="toc-how-they-work-together" class="nav-link" data-scroll-target="#how-they-work-together">How They Work Together</a></li>
  <li><a href="#tool-permissions" id="toc-tool-permissions" class="nav-link" data-scroll-target="#tool-permissions">Tool Permissions</a></li>
  </ul></li>
  <li><a href="#personalization-files-1" id="toc-personalization-files-1" class="nav-link" data-scroll-target="#personalization-files-1">Personalization Files</a>
  <ul class="collapse">
  <li><a href="#agent-configuration-files" id="toc-agent-configuration-files" class="nav-link" data-scroll-target="#agent-configuration-files">1. Agent Configuration Files</a></li>
  <li><a href="#skill-definition-files" id="toc-skill-definition-files" class="nav-link" data-scroll-target="#skill-definition-files">2. Skill Definition Files</a></li>
  <li><a href="#tool-definition-files" id="toc-tool-definition-files" class="nav-link" data-scroll-target="#tool-definition-files">3. Tool Definition Files</a></li>
  <li><a href="#system-prompt-files" id="toc-system-prompt-files" class="nav-link" data-scroll-target="#system-prompt-files">4. System Prompt Files</a></li>
  <li><a href="#configuration-file" id="toc-configuration-file" class="nav-link" data-scroll-target="#configuration-file">5. Configuration File</a></li>
  </ul></li>
  <li><a href="#creating-custom-agents" id="toc-creating-custom-agents" class="nav-link" data-scroll-target="#creating-custom-agents">Creating Custom Agents</a>
  <ul class="collapse">
  <li><a href="#step-by-step-guide" id="toc-step-by-step-guide" class="nav-link" data-scroll-target="#step-by-step-guide">Step-by-Step Guide</a></li>
  <li><a href="#example-creating-a-review-agent" id="toc-example-creating-a-review-agent" class="nav-link" data-scroll-target="#example-creating-a-review-agent">Example: Creating a Review Agent</a></li>
  <li><a href="#using-the-custom-agent" id="toc-using-the-custom-agent" class="nav-link" data-scroll-target="#using-the-custom-agent">Using the Custom Agent</a></li>
  </ul></li>
  <li><a href="#creating-custom-skills" id="toc-creating-custom-skills" class="nav-link" data-scroll-target="#creating-custom-skills">Creating Custom Skills</a>
  <ul class="collapse">
  <li><a href="#step-by-step-guide-1" id="toc-step-by-step-guide-1" class="nav-link" data-scroll-target="#step-by-step-guide-1">Step-by-Step Guide</a></li>
  <li><a href="#example-creating-a-documentation-skill" id="toc-example-creating-a-documentation-skill" class="nav-link" data-scroll-target="#example-creating-a-documentation-skill">Example: Creating a Documentation Skill</a></li>
  </ul></li>
  <li><a href="#creating-custom-tools" id="toc-creating-custom-tools" class="nav-link" data-scroll-target="#creating-custom-tools">Creating Custom Tools</a>
  <ul class="collapse">
  <li><a href="#step-by-step-guide-2" id="toc-step-by-step-guide-2" class="nav-link" data-scroll-target="#step-by-step-guide-2">Step-by-Step Guide</a></li>
  <li><a href="#example-creating-a-custom-tool" id="toc-example-creating-a-custom-tool" class="nav-link" data-scroll-target="#example-creating-a-custom-tool">Example: Creating a Custom Tool</a></li>
  <li><a href="#using-the-custom-tool" id="toc-using-the-custom-tool" class="nav-link" data-scroll-target="#using-the-custom-tool">Using the Custom Tool</a></li>
  </ul></li>
  <li><a href="#configuration-overview" id="toc-configuration-overview" class="nav-link" data-scroll-target="#configuration-overview">Configuration Overview</a>
  <ul class="collapse">
  <li><a href="#configuration-file-structure" id="toc-configuration-file-structure" class="nav-link" data-scroll-target="#configuration-file-structure">Configuration File Structure</a></li>
  <li><a href="#configuration-inheritance" id="toc-configuration-inheritance" class="nav-link" data-scroll-target="#configuration-inheritance">Configuration Inheritance</a></li>
  <li><a href="#pattern-matching" id="toc-pattern-matching" class="nav-link" data-scroll-target="#pattern-matching">Pattern Matching</a></li>
  </ul></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  <li><a href="#prompt-personalization-options-in-mistral-vibe" id="toc-prompt-personalization-options-in-mistral-vibe" class="nav-link" data-scroll-target="#prompt-personalization-options-in-mistral-vibe">Prompt Personalization Options in Mistral Vibe</a>
  <ul class="collapse">
  <li><a href="#built-in-prompts" id="toc-built-in-prompts" class="nav-link" data-scroll-target="#built-in-prompts">1. <strong>Built-in Prompts</strong></a></li>
  <li><a href="#system-prompt-customization" id="toc-system-prompt-customization" class="nav-link" data-scroll-target="#system-prompt-customization">2. <strong>System Prompt Customization</strong></a></li>
  <li><a href="#utility-prompt-customization" id="toc-utility-prompt-customization" class="nav-link" data-scroll-target="#utility-prompt-customization">3. <strong>Utility Prompt Customization</strong></a></li>
  <li><a href="#project-context-configuration" id="toc-project-context-configuration" class="nav-link" data-scroll-target="#project-context-configuration">4. <strong>Project Context Configuration</strong></a></li>
  <li><a href="#session-specific-prompt-control" id="toc-session-specific-prompt-control" class="nav-link" data-scroll-target="#session-specific-prompt-control">5. <strong>Session-Specific Prompt Control</strong></a></li>
  <li><a href="#advanced-customization" id="toc-advanced-customization" class="nav-link" data-scroll-target="#advanced-customization">6. <strong>Advanced Customization</strong></a></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices">7. <strong>Best Practices</strong></a></li>
  </ul></li>
  <li><a href="#mistral-vibe-complete-prompt-personalization-guide" id="toc-mistral-vibe-complete-prompt-personalization-guide" class="nav-link" data-scroll-target="#mistral-vibe-complete-prompt-personalization-guide">Mistral Vibe: Complete Prompt Personalization Guide</a>
  <ul class="collapse">
  <li><a href="#understanding-the-prompt-system" id="toc-understanding-the-prompt-system" class="nav-link" data-scroll-target="#understanding-the-prompt-system">Understanding the Prompt System</a>
  <ul class="collapse">
  <li><a href="#prompt-construction-flow" id="toc-prompt-construction-flow" class="nav-link" data-scroll-target="#prompt-construction-flow">Prompt Construction Flow</a></li>
  </ul></li>
  <li><a href="#built-in-prompts-1" id="toc-built-in-prompts-1" class="nav-link" data-scroll-target="#built-in-prompts-1">Built-in Prompts</a>
  <ul class="collapse">
  <li><a href="#system-prompts" id="toc-system-prompts" class="nav-link" data-scroll-target="#system-prompts">System Prompts</a></li>
  <li><a href="#utility-prompts" id="toc-utility-prompts" class="nav-link" data-scroll-target="#utility-prompts">Utility Prompts</a></li>
  </ul></li>
  <li><a href="#system-prompt-customization-1" id="toc-system-prompt-customization-1" class="nav-link" data-scroll-target="#system-prompt-customization-1">System Prompt Customization</a>
  <ul class="collapse">
  <li><a href="#method-1-using-built-in-prompts" id="toc-method-1-using-built-in-prompts" class="nav-link" data-scroll-target="#method-1-using-built-in-prompts">Method 1: Using Built-in Prompts</a></li>
  <li><a href="#method-2-creating-custom-system-prompts" id="toc-method-2-creating-custom-system-prompts" class="nav-link" data-scroll-target="#method-2-creating-custom-system-prompts">Method 2: Creating Custom System Prompts</a></li>
  <li><a href="#prompt-discovery-order" id="toc-prompt-discovery-order" class="nav-link" data-scroll-target="#prompt-discovery-order">Prompt Discovery Order</a></li>
  </ul></li>
  <li><a href="#utility-prompt-customization-1" id="toc-utility-prompt-customization-1" class="nav-link" data-scroll-target="#utility-prompt-customization-1">Utility Prompt Customization</a>
  <ul class="collapse">
  <li><a href="#customizing-project-context" id="toc-customizing-project-context" class="nav-link" data-scroll-target="#customizing-project-context">Customizing Project Context</a></li>
  </ul></li>
  <li><a href="#project-context-customization" id="toc-project-context-customization" class="nav-link" data-scroll-target="#project-context-customization">Project Context Customization</a>
  <ul class="collapse">
  <li><a href="#configuration-options" id="toc-configuration-options" class="nav-link" data-scroll-target="#configuration-options">Configuration Options</a></li>
  <li><a href="#customizing-project-documentation" id="toc-customizing-project-documentation" class="nav-link" data-scroll-target="#customizing-project-documentation">Customizing Project Documentation</a></li>
  <li><a href="#disabling-project-context" id="toc-disabling-project-context" class="nav-link" data-scroll-target="#disabling-project-context">Disabling Project Context</a></li>
  </ul></li>
  <li><a href="#session-specific-prompt-control-1" id="toc-session-specific-prompt-control-1" class="nav-link" data-scroll-target="#session-specific-prompt-control-1">Session-Specific Prompt Control</a>
  <ul class="collapse">
  <li><a href="#available-configuration-options" id="toc-available-configuration-options" class="nav-link" data-scroll-target="#available-configuration-options">Available Configuration Options</a></li>
  <li><a href="#example-minimal-prompt-configuration" id="toc-example-minimal-prompt-configuration" class="nav-link" data-scroll-target="#example-minimal-prompt-configuration">Example: Minimal Prompt Configuration</a></li>
  <li><a href="#example-full-context-configuration" id="toc-example-full-context-configuration" class="nav-link" data-scroll-target="#example-full-context-configuration">Example: Full Context Configuration</a></li>
  </ul></li>
  <li><a href="#advanced-prompt-customization" id="toc-advanced-prompt-customization" class="nav-link" data-scroll-target="#advanced-prompt-customization">Advanced Prompt Customization</a>
  <ul class="collapse">
  <li><a href="#agent-specific-prompts" id="toc-agent-specific-prompts" class="nav-link" data-scroll-target="#agent-specific-prompts">Agent-Specific Prompts</a></li>
  <li><a href="#dynamic-prompt-selection" id="toc-dynamic-prompt-selection" class="nav-link" data-scroll-target="#dynamic-prompt-selection">Dynamic Prompt Selection</a></li>
  <li><a href="#custom-tool-prompts" id="toc-custom-tool-prompts" class="nav-link" data-scroll-target="#custom-tool-prompts">Custom Tool Prompts</a></li>
  </ul></li>
  <li><a href="#prompt-variables-and-dynamic-content" id="toc-prompt-variables-and-dynamic-content" class="nav-link" data-scroll-target="#prompt-variables-and-dynamic-content">Prompt Variables and Dynamic Content</a>
  <ul class="collapse">
  <li><a href="#system-prompt-variables" id="toc-system-prompt-variables" class="nav-link" data-scroll-target="#system-prompt-variables">System Prompt Variables</a></li>
  <li><a href="#project-context-variables" id="toc-project-context-variables" class="nav-link" data-scroll-target="#project-context-variables">Project Context Variables</a></li>
  <li><a href="#git-status-variables" id="toc-git-status-variables" class="nav-link" data-scroll-target="#git-status-variables">Git Status Variables</a></li>
  <li><a href="#dynamic-content-generation" id="toc-dynamic-content-generation" class="nav-link" data-scroll-target="#dynamic-content-generation">Dynamic Content Generation</a></li>
  </ul></li>
  <li><a href="#best-practices-for-prompt-customization" id="toc-best-practices-for-prompt-customization" class="nav-link" data-scroll-target="#best-practices-for-prompt-customization">Best Practices for Prompt Customization</a>
  <ul class="collapse">
  <li><a href="#start-with-the-built-in-prompt" id="toc-start-with-the-built-in-prompt" class="nav-link" data-scroll-target="#start-with-the-built-in-prompt">1. Start with the Built-in Prompt</a></li>
  <li><a href="#keep-prompts-concise" id="toc-keep-prompts-concise" class="nav-link" data-scroll-target="#keep-prompts-concise">2. Keep Prompts Concise</a></li>
  <li><a href="#be-specific-about-requirements" id="toc-be-specific-about-requirements" class="nav-link" data-scroll-target="#be-specific-about-requirements">3. Be Specific About Requirements</a></li>
  <li><a href="#test-incrementally" id="toc-test-incrementally" class="nav-link" data-scroll-target="#test-incrementally">4. Test Incrementally</a></li>
  <li><a href="#document-your-custom-prompts" id="toc-document-your-custom-prompts" class="nav-link" data-scroll-target="#document-your-custom-prompts">5. Document Your Custom Prompts</a></li>
  <li><a href="#consider-context-length" id="toc-consider-context-length" class="nav-link" data-scroll-target="#consider-context-length">6. Consider Context Length</a></li>
  <li><a href="#use-multiple-prompts-for-different-use-cases" id="toc-use-multiple-prompts-for-different-use-cases" class="nav-link" data-scroll-target="#use-multiple-prompts-for-different-use-cases">7. Use Multiple Prompts for Different Use Cases</a></li>
  </ul></li>
  <li><a href="#complete-example-custom-prompt-setup" id="toc-complete-example-custom-prompt-setup" class="nav-link" data-scroll-target="#complete-example-custom-prompt-setup">Complete Example: Custom Prompt Setup</a>
  <ul class="collapse">
  <li><a href="#step-1-create-custom-prompt-directory" id="toc-step-1-create-custom-prompt-directory" class="nav-link" data-scroll-target="#step-1-create-custom-prompt-directory">Step 1: Create Custom Prompt Directory</a></li>
  <li><a href="#step-2-create-custom-system-prompt" id="toc-step-2-create-custom-system-prompt" class="nav-link" data-scroll-target="#step-2-create-custom-system-prompt">Step 2: Create Custom System Prompt</a></li>
  <li><a href="#step-3-create-agent-configuration" id="toc-step-3-create-agent-configuration" class="nav-link" data-scroll-target="#step-3-create-agent-configuration">Step 3: Create Agent Configuration</a></li>
  <li><a href="#step-4-update-main-configuration" id="toc-step-4-update-main-configuration" class="nav-link" data-scroll-target="#step-4-update-main-configuration">Step 4: Update Main Configuration</a></li>
  <li><a href="#step-5-use-your-custom-setup" id="toc-step-5-use-your-custom-setup" class="nav-link" data-scroll-target="#step-5-use-your-custom-setup">Step 5: Use Your Custom Setup</a></li>
  </ul></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2">Summary</a>
  <ul class="collapse">
  <li><a href="#key-configuration-options" id="toc-key-configuration-options" class="nav-link" data-scroll-target="#key-configuration-options">Key Configuration Options</a></li>
  <li><a href="#customization-locations" id="toc-customization-locations" class="nav-link" data-scroll-target="#customization-locations">Customization Locations</a></li>
  </ul></li>
  <li><a href="#how-the-task-tool-works-in-mistral-vibe" id="toc-how-the-task-tool-works-in-mistral-vibe" class="nav-link" data-scroll-target="#how-the-task-tool-works-in-mistral-vibe">How the Task Tool Works in Mistral Vibe</a>
  <ul class="collapse">
  <li><a href="#core-functionality" id="toc-core-functionality" class="nav-link" data-scroll-target="#core-functionality"><strong>Core Functionality</strong></a></li>
  <li><a href="#how-it-works" id="toc-how-it-works" class="nav-link" data-scroll-target="#how-it-works"><strong>How It Works</strong></a></li>
  <li><a href="#key-security-mechanisms" id="toc-key-security-mechanisms" class="nav-link" data-scroll-target="#key-security-mechanisms"><strong>Key Security Mechanisms</strong></a></li>
  <li><a href="#task-arguments" id="toc-task-arguments" class="nav-link" data-scroll-target="#task-arguments"><strong>Task Arguments</strong></a></li>
  <li><a href="#task-results" id="toc-task-results" class="nav-link" data-scroll-target="#task-results"><strong>Task Results</strong></a></li>
  <li><a href="#best-practices-1" id="toc-best-practices-1" class="nav-link" data-scroll-target="#best-practices-1"><strong>Best Practices</strong></a></li>
  </ul></li>
  <li><a href="#complete-guide-to-the-task-tool" id="toc-complete-guide-to-the-task-tool" class="nav-link" data-scroll-target="#complete-guide-to-the-task-tool">Complete Guide to the Task Tool</a></li>
  <li><a href="#overview-of-the-task-tool" id="toc-overview-of-the-task-tool" class="nav-link" data-scroll-target="#overview-of-the-task-tool">Overview of the Task Tool</a>
  <ul class="collapse">
  <li><a href="#key-characteristics-1" id="toc-key-characteristics-1" class="nav-link" data-scroll-target="#key-characteristics-1">Key Characteristics</a></li>
  </ul></li>
  <li><a href="#how-the-task-tool-works" id="toc-how-the-task-tool-works" class="nav-link" data-scroll-target="#how-the-task-tool-works">How the Task Tool Works</a>
  <ul class="collapse">
  <li><a href="#core-process" id="toc-core-process" class="nav-link" data-scroll-target="#core-process">Core Process</a></li>
  <li><a href="#code-flow" id="toc-code-flow" class="nav-link" data-scroll-target="#code-flow">Code Flow</a></li>
  </ul></li>
  <li><a href="#task-execution-flow" id="toc-task-execution-flow" class="nav-link" data-scroll-target="#task-execution-flow">Task Execution Flow</a>
  <ul class="collapse">
  <li><a href="#step-by-step-execution" id="toc-step-by-step-execution" class="nav-link" data-scroll-target="#step-by-step-execution">Step-by-Step Execution</a></li>
  <li><a href="#event-types-handled" id="toc-event-types-handled" class="nav-link" data-scroll-target="#event-types-handled">Event Types Handled</a></li>
  </ul></li>
  <li><a href="#task-arguments-1" id="toc-task-arguments-1" class="nav-link" data-scroll-target="#task-arguments-1">Task Arguments</a>
  <ul class="collapse">
  <li><a href="#required-parameter" id="toc-required-parameter" class="nav-link" data-scroll-target="#required-parameter">Required Parameter</a></li>
  <li><a href="#optional-parameter" id="toc-optional-parameter" class="nav-link" data-scroll-target="#optional-parameter">Optional Parameter</a></li>
  <li><a href="#example-invocations" id="toc-example-invocations" class="nav-link" data-scroll-target="#example-invocations">Example Invocations</a></li>
  </ul></li>
  <li><a href="#task-results-1" id="toc-task-results-1" class="nav-link" data-scroll-target="#task-results-1">Task Results</a>
  <ul class="collapse">
  <li><a href="#result-fields" id="toc-result-fields" class="nav-link" data-scroll-target="#result-fields">Result Fields</a></li>
  <li><a href="#example-results" id="toc-example-results" class="nav-link" data-scroll-target="#example-results">Example Results</a></li>
  </ul></li>
  <li><a href="#security-and-safety-mechanisms" id="toc-security-and-safety-mechanisms" class="nav-link" data-scroll-target="#security-and-safety-mechanisms">Security and Safety Mechanisms</a>
  <ul class="collapse">
  <li><a href="#agent-type-validation" id="toc-agent-type-validation" class="nav-link" data-scroll-target="#agent-type-validation">1. Agent Type Validation</a></li>
  <li><a href="#isolated-configuration" id="toc-isolated-configuration" class="nav-link" data-scroll-target="#isolated-configuration">2. Isolated Configuration</a></li>
  <li><a href="#inherited-approval-callback" id="toc-inherited-approval-callback" class="nav-link" data-scroll-target="#inherited-approval-callback">3. Inherited Approval Callback</a></li>
  <li><a href="#turn-counting" id="toc-turn-counting" class="nav-link" data-scroll-target="#turn-counting">4. Turn Counting</a></li>
  <li><a href="#error-handling-1" id="toc-error-handling-1" class="nav-link" data-scroll-target="#error-handling-1">5. Error Handling</a></li>
  <li><a href="#middleware-integration" id="toc-middleware-integration" class="nav-link" data-scroll-target="#middleware-integration">6. Middleware Integration</a></li>
  </ul></li>
  <li><a href="#use-cases-and-best-practices" id="toc-use-cases-and-best-practices" class="nav-link" data-scroll-target="#use-cases-and-best-practices">Use Cases and Best Practices</a>
  <ul class="collapse">
  <li><a href="#when-to-use-the-task-tool" id="toc-when-to-use-the-task-tool" class="nav-link" data-scroll-target="#when-to-use-the-task-tool">When to Use the Task Tool</a></li>
  <li><a href="#best-practices-2" id="toc-best-practices-2" class="nav-link" data-scroll-target="#best-practices-2">Best Practices</a></li>
  <li><a href="#example-use-cases" id="toc-example-use-cases" class="nav-link" data-scroll-target="#example-use-cases">Example Use Cases</a></li>
  </ul></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a>
  <ul class="collapse">
  <li><a href="#functional-limitations" id="toc-functional-limitations" class="nav-link" data-scroll-target="#functional-limitations">Functional Limitations</a></li>
  <li><a href="#technical-limitations" id="toc-technical-limitations" class="nav-link" data-scroll-target="#technical-limitations">Technical Limitations</a></li>
  <li><a href="#error-handling-2" id="toc-error-handling-2" class="nav-link" data-scroll-target="#error-handling-2">Error Handling</a></li>
  </ul></li>
  <li><a href="#implementation-details" id="toc-implementation-details" class="nav-link" data-scroll-target="#implementation-details">Implementation Details</a>
  <ul class="collapse">
  <li><a href="#tool-class-structure" id="toc-tool-class-structure" class="nav-link" data-scroll-target="#tool-class-structure">Tool Class Structure</a></li>
  <li><a href="#key-methods" id="toc-key-methods" class="nav-link" data-scroll-target="#key-methods">Key Methods</a></li>
  <li><a href="#permission-model" id="toc-permission-model" class="nav-link" data-scroll-target="#permission-model">Permission Model</a></li>
  <li><a href="#ui-integration" id="toc-ui-integration" class="nav-link" data-scroll-target="#ui-integration">UI Integration</a></li>
  </ul></li>
  <li><a href="#complete-example" id="toc-complete-example" class="nav-link" data-scroll-target="#complete-example">Complete Example</a>
  <ul class="collapse">
  <li><a href="#creating-a-custom-subagent" id="toc-creating-a-custom-subagent" class="nav-link" data-scroll-target="#creating-a-custom-subagent">Creating a Custom Subagent</a></li>
  <li><a href="#using-the-custom-subagent" id="toc-using-the-custom-subagent" class="nav-link" data-scroll-target="#using-the-custom-subagent">Using the Custom Subagent</a></li>
  <li><a href="#expected-output" id="toc-expected-output" class="nav-link" data-scroll-target="#expected-output">Expected Output</a></li>
  </ul></li>
  <li><a href="#summary-3" id="toc-summary-3" class="nav-link" data-scroll-target="#summary-3">Summary</a>
  <ul class="collapse">
  <li><a href="#key-features" id="toc-key-features" class="nav-link" data-scroll-target="#key-features">Key Features</a></li>
  <li><a href="#best-practices-3" id="toc-best-practices-3" class="nav-link" data-scroll-target="#best-practices-3">Best Practices</a></li>
  </ul></li>
  <li><a href="#how-skills-work-in-mistral-vibe" id="toc-how-skills-work-in-mistral-vibe" class="nav-link" data-scroll-target="#how-skills-work-in-mistral-vibe">How Skills Work in Mistral Vibe</a>
  <ul class="collapse">
  <li><a href="#core-functionality-1" id="toc-core-functionality-1" class="nav-link" data-scroll-target="#core-functionality-1"><strong>Core Functionality</strong></a></li>
  <li><a href="#skill-structure-1" id="toc-skill-structure-1" class="nav-link" data-scroll-target="#skill-structure-1"><strong>Skill Structure</strong></a></li>
  <li><a href="#skill-metadata-fields-1" id="toc-skill-metadata-fields-1" class="nav-link" data-scroll-target="#skill-metadata-fields-1"><strong>Skill Metadata Fields</strong></a></li>
  <li><a href="#discovery-paths" id="toc-discovery-paths" class="nav-link" data-scroll-target="#discovery-paths"><strong>Discovery Paths</strong></a></li>
  <li><a href="#integration-points-1" id="toc-integration-points-1" class="nav-link" data-scroll-target="#integration-points-1"><strong>Integration Points</strong></a></li>
  <li><a href="#management" id="toc-management" class="nav-link" data-scroll-target="#management"><strong>Management</strong></a></li>
  <li><a href="#security-features" id="toc-security-features" class="nav-link" data-scroll-target="#security-features"><strong>Security Features</strong></a></li>
  </ul></li>
  <li><a href="#complete-guide-to-the-skills-system" id="toc-complete-guide-to-the-skills-system" class="nav-link" data-scroll-target="#complete-guide-to-the-skills-system">Complete Guide to the Skills System</a></li>
  <li><a href="#overview-of-the-skills-system" id="toc-overview-of-the-skills-system" class="nav-link" data-scroll-target="#overview-of-the-skills-system">Overview of the Skills System</a>
  <ul class="collapse">
  <li><a href="#key-characteristics-2" id="toc-key-characteristics-2" class="nav-link" data-scroll-target="#key-characteristics-2">Key Characteristics</a></li>
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose">Purpose</a></li>
  </ul></li>
  <li><a href="#skill-structure-and-format" id="toc-skill-structure-and-format" class="nav-link" data-scroll-target="#skill-structure-and-format">Skill Structure and Format</a>
  <ul class="collapse">
  <li><a href="#file-structure" id="toc-file-structure" class="nav-link" data-scroll-target="#file-structure">File Structure</a></li>
  <li><a href="#format-specification" id="toc-format-specification" class="nav-link" data-scroll-target="#format-specification">Format Specification</a></li>
  <li><a href="#frontmatter-requirements" id="toc-frontmatter-requirements" class="nav-link" data-scroll-target="#frontmatter-requirements">Frontmatter Requirements</a></li>
  </ul></li>
  <li><a href="#skill-discovery-and-loading" id="toc-skill-discovery-and-loading" class="nav-link" data-scroll-target="#skill-discovery-and-loading">Skill Discovery and Loading</a>
  <ul class="collapse">
  <li><a href="#discovery-process-1" id="toc-discovery-process-1" class="nav-link" data-scroll-target="#discovery-process-1">Discovery Process</a></li>
  <li><a href="#loading-code" id="toc-loading-code" class="nav-link" data-scroll-target="#loading-code">Loading Code</a></li>
  <li><a href="#error-handling-3" id="toc-error-handling-3" class="nav-link" data-scroll-target="#error-handling-3">Error Handling</a></li>
  </ul></li>
  <li><a href="#skill-metadata-fields-2" id="toc-skill-metadata-fields-2" class="nav-link" data-scroll-target="#skill-metadata-fields-2">Skill Metadata Fields</a>
  <ul class="collapse">
  <li><a href="#required-fields" id="toc-required-fields" class="nav-link" data-scroll-target="#required-fields">Required Fields</a></li>
  <li><a href="#optional-fields" id="toc-optional-fields" class="nav-link" data-scroll-target="#optional-fields">Optional Fields</a></li>
  <li><a href="#field-validation" id="toc-field-validation" class="nav-link" data-scroll-target="#field-validation">Field Validation</a></li>
  </ul></li>
  <li><a href="#skill-integration-with-the-system" id="toc-skill-integration-with-the-system" class="nav-link" data-scroll-target="#skill-integration-with-the-system">Skill Integration with the System</a>
  <ul class="collapse">
  <li><a href="#system-prompt-integration" id="toc-system-prompt-integration" class="nav-link" data-scroll-target="#system-prompt-integration">System Prompt Integration</a></li>
  <li><a href="#skill-section-format" id="toc-skill-section-format" class="nav-link" data-scroll-target="#skill-section-format">Skill Section Format</a></li>
  <li><a href="#html-escaping" id="toc-html-escaping" class="nav-link" data-scroll-target="#html-escaping">HTML Escaping</a></li>
  </ul></li>
  <li><a href="#skill-discovery-paths-1" id="toc-skill-discovery-paths-1" class="nav-link" data-scroll-target="#skill-discovery-paths-1">Skill Discovery Paths</a>
  <ul class="collapse">
  <li><a href="#default-search-paths-1" id="toc-default-search-paths-1" class="nav-link" data-scroll-target="#default-search-paths-1">Default Search Paths</a></li>
  <li><a href="#discovery-order" id="toc-discovery-order" class="nav-link" data-scroll-target="#discovery-order">Discovery Order</a></li>
  <li><a href="#path-resolution" id="toc-path-resolution" class="nav-link" data-scroll-target="#path-resolution">Path Resolution</a></li>
  <li><a href="#duplicate-handling" id="toc-duplicate-handling" class="nav-link" data-scroll-target="#duplicate-handling">Duplicate Handling</a></li>
  </ul></li>
  <li><a href="#skill-management-and-configuration" id="toc-skill-management-and-configuration" class="nav-link" data-scroll-target="#skill-management-and-configuration">Skill Management and Configuration</a>
  <ul class="collapse">
  <li><a href="#enabling-and-disabling-skills" id="toc-enabling-and-disabling-skills" class="nav-link" data-scroll-target="#enabling-and-disabling-skills">Enabling and Disabling Skills</a></li>
  <li><a href="#pattern-matching-1" id="toc-pattern-matching-1" class="nav-link" data-scroll-target="#pattern-matching-1">Pattern Matching</a></li>
  <li><a href="#configuration-logic" id="toc-configuration-logic" class="nav-link" data-scroll-target="#configuration-logic">Configuration Logic</a></li>
  <li><a href="#priority-rules" id="toc-priority-rules" class="nav-link" data-scroll-target="#priority-rules">Priority Rules</a></li>
  </ul></li>
  <li><a href="#skills-and-slash-commands" id="toc-skills-and-slash-commands" class="nav-link" data-scroll-target="#skills-and-slash-commands">Skills and Slash Commands</a>
  <ul class="collapse">
  <li><a href="#user-invocable-skills" id="toc-user-invocable-skills" class="nav-link" data-scroll-target="#user-invocable-skills">User-Invocable Skills</a></li>
  <li><a href="#slash-command-format" id="toc-slash-command-format" class="nav-link" data-scroll-target="#slash-command-format">Slash Command Format</a></li>
  <li><a href="#invocation-behavior" id="toc-invocation-behavior" class="nav-link" data-scroll-target="#invocation-behavior">Invocation Behavior</a></li>
  </ul></li>
  <li><a href="#best-practices-for-creating-skills" id="toc-best-practices-for-creating-skills" class="nav-link" data-scroll-target="#best-practices-for-creating-skills">Best Practices for Creating Skills</a>
  <ul class="collapse">
  <li><a href="#clear-and-descriptive-names" id="toc-clear-and-descriptive-names" class="nav-link" data-scroll-target="#clear-and-descriptive-names">1. Clear and Descriptive Names</a></li>
  <li><a href="#comprehensive-descriptions" id="toc-comprehensive-descriptions" class="nav-link" data-scroll-target="#comprehensive-descriptions">2. Comprehensive Descriptions</a></li>
  <li><a href="#detailed-documentation" id="toc-detailed-documentation" class="nav-link" data-scroll-target="#detailed-documentation">3. Detailed Documentation</a></li>
  <li><a href="#appropriate-tool-restrictions" id="toc-appropriate-tool-restrictions" class="nav-link" data-scroll-target="#appropriate-tool-restrictions">4. Appropriate Tool Restrictions</a></li>
  <li><a href="#versioning-and-compatibility" id="toc-versioning-and-compatibility" class="nav-link" data-scroll-target="#versioning-and-compatibility">5. Versioning and Compatibility</a></li>
  <li><a href="#testing" id="toc-testing" class="nav-link" data-scroll-target="#testing">6. Testing</a></li>
  </ul></li>
  <li><a href="#complete-example-creating-a-custom-skill" id="toc-complete-example-creating-a-custom-skill" class="nav-link" data-scroll-target="#complete-example-creating-a-custom-skill">Complete Example: Creating a Custom Skill</a>
  <ul class="collapse">
  <li><a href="#step-1-create-skill-directory" id="toc-step-1-create-skill-directory" class="nav-link" data-scroll-target="#step-1-create-skill-directory">Step 1: Create Skill Directory</a></li>
  <li><a href="#step-2-create-skill.md-file" id="toc-step-2-create-skill.md-file" class="nav-link" data-scroll-target="#step-2-create-skill.md-file">Step 2: Create SKILL.md File</a></li>
  <li><a href="#step-3-define-skill-metadata-and-documentation" id="toc-step-3-define-skill-metadata-and-documentation" class="nav-link" data-scroll-target="#step-3-define-skill-metadata-and-documentation">Step 3: Define Skill Metadata and Documentation</a></li>
  <li><a href="#step-4-verify-skill-discovery" id="toc-step-4-verify-skill-discovery" class="nav-link" data-scroll-target="#step-4-verify-skill-discovery">Step 4: Verify Skill Discovery</a></li>
  <li><a href="#step-5-test-the-skill" id="toc-step-5-test-the-skill" class="nav-link" data-scroll-target="#step-5-test-the-skill">Step 5: Test the Skill</a></li>
  </ul></li>
  <li><a href="#advanced-project-specific-skills" id="toc-advanced-project-specific-skills" class="nav-link" data-scroll-target="#advanced-project-specific-skills">Advanced: Project-Specific Skills</a></li>
  <li><a href="#summary-4" id="toc-summary-4" class="nav-link" data-scroll-target="#summary-4">Summary</a>
  <ul class="collapse">
  <li><a href="#key-benefits" id="toc-key-benefits" class="nav-link" data-scroll-target="#key-benefits">Key Benefits</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/wordslab-org/wordslab-notebooks-lib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="tools_study_mistral-vibe.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mistral vibe 2.0</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="mistral-vibe-architecture-overview" class="level2">
<h2 class="anchored" data-anchor-id="mistral-vibe-architecture-overview">Mistral Vibe Architecture Overview</h2>
<p>Mistral Vibe is a command-line coding assistant powered by Mistral’s models, providing a conversational interface to interact with codebases through natural language.</p>
<section id="core-architecture-components" class="level3">
<h3 class="anchored" data-anchor-id="core-architecture-components">Core Architecture Components</h3>
<section id="entry-point-cli-layer-vibeclientrypoint.py-vibeclicli.py" class="level4">
<h4 class="anchored" data-anchor-id="entry-point-cli-layer-vibeclientrypoint.py-vibeclicli.py">1. <strong>Entry Point &amp; CLI Layer</strong> (<code>vibe/cli/entrypoint.py</code>, <code>vibe/cli/cli.py</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Command-line interface and argument parsing</li>
<li><strong>Key Features</strong>:
<ul>
<li>Argument parsing for interactive vs programmatic modes</li>
<li>Trust folder system for security</li>
<li>Session continuation/resumption</li>
<li>Setup workflow for API keys</li>
<li>Working directory management</li>
</ul></li>
</ul>
</section>
<section id="agent-loop-vibecoreagent_loop.py" class="level4">
<h4 class="anchored" data-anchor-id="agent-loop-vibecoreagent_loop.py">2. <strong>Agent Loop</strong> (<code>vibe/core/agent_loop.py</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Main conversation loop and orchestration</li>
<li><strong>Key Responsibilities</strong>:
<ul>
<li>Manages conversation state and message history</li>
<li>Handles LLM interactions (streaming and non-streaming)</li>
<li>Tool execution lifecycle (approval, execution, result handling)</li>
<li>Middleware pipeline for turn limits, price limits, auto-compaction</li>
<li>Session management and logging</li>
<li>Context compaction for long conversations</li>
<li>Agent switching and configuration</li>
</ul></li>
</ul>
</section>
<section id="agents-system-vibecoreagents" class="level4">
<h4 class="anchored" data-anchor-id="agents-system-vibecoreagents">3. <strong>Agents System</strong> (<code>vibe/core/agents/</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Agent profile management and configuration</li>
<li><strong>Key Components</strong>:
<ul>
<li><code>AgentProfile</code>: Defines agent behavior (safety level, tool permissions, etc.)</li>
<li><code>AgentManager</code>: Manages active agent and profile switching</li>
<li>Built-in agents: <code>default</code>, <code>plan</code>, <code>accept-edits</code>, <code>auto-approve</code>, <code>explore</code></li>
<li>Agent types: <code>AGENT</code> (interactive) and <code>SUBAGENT</code> (background task worker)</li>
</ul></li>
</ul>
</section>
<section id="tool-system-vibecoretools" class="level4">
<h4 class="anchored" data-anchor-id="tool-system-vibecoretools">4. <strong>Tool System</strong> (<code>vibe/core/tools/</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Tool discovery, management, and execution</li>
<li><strong>Key Components</strong>:
<ul>
<li><code>ToolManager</code>: Discovers and manages available tools</li>
<li><code>BaseTool</code>: Abstract base class for all tools</li>
<li>Built-in tools:
<ul>
<li><code>read_file</code>, <code>write_file</code>, <code>search_replace</code>: File operations</li>
<li><code>bash</code>: Shell command execution</li>
<li><code>grep</code>: Code searching</li>
<li><code>todo</code>: Task management</li>
<li><code>ask_user_question</code>: Interactive user queries</li>
<li><code>task</code>: Subagent delegation</li>
</ul></li>
<li>MCP (Model Context Protocol) integration for external tools</li>
</ul></li>
</ul>
</section>
<section id="skills-system-vibecoreskills" class="level4">
<h4 class="anchored" data-anchor-id="skills-system-vibecoreskills">5. <strong>Skills System</strong> (<code>vibe/core/skills/</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Extensible functionality through reusable components</li>
<li><strong>Key Features</strong>:
<ul>
<li>Skill discovery from multiple paths (global, local, custom)</li>
<li>Pattern-based skill enabling/disabling</li>
<li>Skill metadata parsing from <code>SKILL.md</code> files</li>
<li>Follows Agent Skills specification</li>
</ul></li>
</ul>
</section>
<section id="configuration-vibecoreconfig.py" class="level4">
<h4 class="anchored" data-anchor-id="configuration-vibecoreconfig.py">6. <strong>Configuration</strong> (<code>vibe/core/config.py</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Centralized configuration management</li>
<li><strong>Key Features</strong>:
<ul>
<li>TOML-based configuration</li>
<li>Multiple provider support (Mistral, generic LLM APIs)</li>
<li>Model configuration and pricing</li>
<li>Tool permissions and allowlists/denylists</li>
<li>MCP server configuration</li>
<li>Session logging settings</li>
<li>Project context scanning configuration</li>
</ul></li>
</ul>
</section>
<section id="llm-backend-vibecorellm" class="level4">
<h4 class="anchored" data-anchor-id="llm-backend-vibecorellm">7. <strong>LLM Backend</strong> (<code>vibe/core/llm/</code>)</h4>
<ul>
<li><strong>Purpose</strong>: LLM provider integration and message formatting</li>
<li><strong>Key Components</strong>:
<ul>
<li>Backend factory for different providers</li>
<li>Message formatting and tool schema generation</li>
<li>Streaming and non-streaming completion support</li>
<li>Token counting and usage tracking</li>
</ul></li>
</ul>
</section>
<section id="textual-ui-vibeclitextual_ui" class="level4">
<h4 class="anchored" data-anchor-id="textual-ui-vibeclitextual_ui">8. <strong>Textual UI</strong> (<code>vibe/cli/textual_ui/</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Interactive terminal interface</li>
<li><strong>Key Features</strong>:
<ul>
<li>Rich terminal UI with Textual framework</li>
<li>Message display and history</li>
<li>Tool output viewing</li>
<li>Todo list management</li>
<li>Autocompletion for commands and file paths</li>
<li>Theme support and customization</li>
<li>External editor integration</li>
</ul></li>
</ul>
</section>
<section id="session-management-vibecoresession" class="level4">
<h4 class="anchored" data-anchor-id="session-management-vibecoresession">9. <strong>Session Management</strong> (<code>vibe/core/session/</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Persistent conversation state</li>
<li><strong>Key Features</strong>:
<ul>
<li>Session logging and saving</li>
<li>Session continuation/resumption</li>
<li>Session migration for version compatibility</li>
<li>Context compaction for long conversations</li>
</ul></li>
</ul>
</section>
<section id="middleware-pipeline-vibecoremiddleware.py" class="level4">
<h4 class="anchored" data-anchor-id="middleware-pipeline-vibecoremiddleware.py">10. <strong>Middleware Pipeline</strong> (<code>vibe/core/middleware.py</code>)</h4>
<ul>
<li><strong>Purpose</strong>: Extensible conversation flow control</li>
<li><strong>Key Middleware</strong>:
<ul>
<li><code>TurnLimitMiddleware</code>: Limits conversation turns</li>
<li><code>PriceLimitMiddleware</code>: Enforces cost limits</li>
<li><code>AutoCompactMiddleware</code>: Automatically compacts context</li>
<li><code>ContextWarningMiddleware</code>: Warns about context size</li>
<li><code>PlanAgentMiddleware</code>: Special handling for plan agent</li>
</ul></li>
</ul>
</section>
</section>
<section id="key-features-and-workflows" class="level3">
<h3 class="anchored" data-anchor-id="key-features-and-workflows">Key Features and Workflows</h3>
<ol type="1">
<li><strong>Interactive Mode</strong>:
<ul>
<li>Real-time conversation with the AI agent</li>
<li>Tool execution with approval workflow</li>
<li>Rich terminal UI with message history</li>
<li>Autocompletion for commands and file paths</li>
</ul></li>
<li><strong>Programmatic Mode</strong>:
<ul>
<li>Non-interactive execution via <code>--prompt</code> flag</li>
<li>Auto-approve mode for scripting</li>
<li>Multiple output formats (text, JSON, streaming)</li>
<li>Turn and price limits</li>
</ul></li>
<li><strong>Tool Execution</strong>:
<ul>
<li>Approval workflow (manual, auto-approve, or per-tool)</li>
<li>Allowlist/denylist filtering</li>
<li>Streaming tool output</li>
<li>Error handling and recovery</li>
</ul></li>
<li><strong>Skills System</strong>:
<ul>
<li>Extend functionality with reusable components</li>
<li>Custom slash commands</li>
<li>Pattern-based skill management</li>
</ul></li>
<li><strong>Security Features</strong>:
<ul>
<li>Trust folder system</li>
<li>Tool permission levels (never, ask, always)</li>
<li>Allowlist/denylist patterns</li>
<li>Session isolation</li>
</ul></li>
</ol>
</section>
<section id="architecture-patterns" class="level3">
<h3 class="anchored" data-anchor-id="architecture-patterns">Architecture Patterns</h3>
<ol type="1">
<li><strong>Dependency Injection</strong>:
<ul>
<li>Configuration is passed through callables to support dynamic updates</li>
<li>Backend factory pattern for LLM providers</li>
</ul></li>
<li><strong>Event-Driven Architecture</strong>:
<ul>
<li>Conversation events (user messages, assistant responses, tool calls)</li>
<li>Streaming events for real-time updates</li>
</ul></li>
<li><strong>Middleware Pattern</strong>:
<ul>
<li>Extensible pipeline for conversation flow control</li>
<li>Before/after turn hooks</li>
</ul></li>
<li><strong>Plugin System</strong>:
<ul>
<li>Skills for extensible functionality</li>
<li>MCP servers for external tools</li>
</ul></li>
<li><strong>State Management</strong>:
<ul>
<li>Immutable message history</li>
<li>Session logging and continuation</li>
<li>Context compaction for long conversations</li>
</ul></li>
</ol>
</section>
<section id="data-flow" class="level3">
<h3 class="anchored" data-anchor-id="data-flow">Data Flow</h3>
<ol type="1">
<li><strong>User Input</strong> → CLI Entry Point → Agent Loop</li>
<li><strong>Agent Loop</strong> → LLM Backend (for completions) → Message Formatting</li>
<li><strong>Tool Calls</strong> → Tool Manager → Tool Execution → Results</li>
<li><strong>Events</strong> → UI Updates → User Feedback Loop</li>
<li><strong>Session Data</strong> → Session Logger → Persistent Storage</li>
</ol>
<p>This architecture provides a flexible, extensible foundation for building a powerful CLI coding assistant with support for multiple workflows, security features, and extensibility through skills and MCP servers.</p>
</section>
</section>
<section id="mistral-vibe-tool-system-analysis" class="level2">
<h2 class="anchored" data-anchor-id="mistral-vibe-tool-system-analysis">Mistral Vibe Tool System Analysis</h2>
<p>Mistral Vibe’s tool system provides a powerful, extensible framework for interacting with the filesystem, running commands, and performing various operations. Each tool is a self-contained unit with its own configuration, state, and security model.</p>
</section>
<section id="built-in-tools" class="level2">
<h2 class="anchored" data-anchor-id="built-in-tools">Built-in Tools</h2>
<section id="read_file" class="level3">
<h3 class="anchored" data-anchor-id="read_file">1. read_file</h3>
<p><strong>Purpose</strong>: Read a UTF-8 file, returning content from a specific line range.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReadFileArgs(BaseModel):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    offset: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Line number to start reading from (0-indexed, inclusive)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    limit: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>  <span class="co"># Maximum number of lines to read</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReadFileResult(BaseModel):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    content: <span class="bu">str</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    lines_read: <span class="bu">int</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    was_truncated: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Path Validation</strong>: - Expands user home directory (<code>~</code>) - Resolves relative paths to absolute - Validates path exists and is a file (not directory) - Checks path is within project directory using <code>path.relative_to(Path.cwd().resolve())</code> - Raises <code>ToolError</code> with security message if path is outside project</p>
<ol start="2" type="1">
<li><strong>Size Limits</strong>:
<ul>
<li>Configurable <code>max_read_bytes</code> (default: 64,000 bytes)</li>
<li>Tracks bytes read and stops at limit</li>
<li>Sets <code>was_truncated</code> flag in result</li>
</ul></li>
<li><strong>Allowlist/Denylist</strong>:
<ul>
<li>Uses <code>fnmatch</code> for pattern matching</li>
<li>Checks file path against configured patterns</li>
<li>Returns <code>ToolPermission.ALWAYS</code> or <code>ToolPermission.NEVER</code></li>
</ul></li>
<li><strong>Error Handling</strong>:
<ul>
<li>Catches <code>OSError</code> and wraps in <code>ToolError</code></li>
<li>Validates input parameters (empty path, negative offset, invalid limit)</li>
</ul></li>
<li><strong>State Tracking</strong>:
<ul>
<li>Maintains history of recently read files (max 10)</li>
<li>Helps prevent infinite loops</li>
</ul></li>
</ol>
<p><strong>Prompt</strong>:</p>
<pre><code>Use `read_file` to read the content of a file. It's designed to handle large files safely.

- By default, it reads from the beginning of the file.
- Use `offset` (line number) and `limit` (number of lines) to read specific parts or chunks of a file. This is efficient for exploring large files.
- The result includes `was_truncated: true` if the file content was cut short due to size limits.

**Strategy for large files:**

1. Call `read_file` with a `limit` (e.g., 1000 lines) to get the start of the file.
2. If `was_truncated` is true, you know the file is large.
3. To read the next chunk, call `read_file` again with an `offset`. For example, `offset=1000, limit=1000`.

This is more efficient than using `bash` with `cat` or `wc`.</code></pre>
<hr>
</section>
<section id="write_file" class="level3">
<h3 class="anchored" data-anchor-id="write_file">2. write_file</h3>
<p><strong>Purpose</strong>: Create or overwrite a UTF-8 file.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WriteFileArgs(BaseModel):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    content: <span class="bu">str</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    overwrite: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>  <span class="co"># Must be true to overwrite existing files</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WriteFileResult(BaseModel):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    bytes_written: <span class="bu">int</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    file_existed: <span class="bu">bool</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    content: <span class="bu">str</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Path Validation</strong>: - Expands user home directory - Resolves relative paths to absolute - Validates path is within project directory - Raises <code>ToolError</code> if path is outside project</p>
<ol start="2" type="1">
<li><strong>Overwrite Protection</strong>:
<ul>
<li>Default <code>overwrite=False</code> prevents accidental overwrites</li>
<li>Explicit <code>overwrite=True</code> required to replace existing files</li>
<li>Validates file existence before writing</li>
</ul></li>
<li><strong>Size Limits</strong>:
<ul>
<li>Configurable <code>max_write_bytes</code> (default: 64,000 bytes)</li>
<li>Rejects content exceeding limit</li>
</ul></li>
<li><strong>Directory Creation</strong>:
<ul>
<li>Configurable <code>create_parent_dirs</code> (default: True)</li>
<li>Creates parent directories if enabled</li>
<li>Validates parent directory exists if disabled</li>
</ul></li>
<li><strong>Allowlist/Denylist</strong>:
<ul>
<li>Uses <code>fnmatch</code> for pattern matching</li>
<li>Checks file path against configured patterns</li>
</ul></li>
<li><strong>Error Handling</strong>:
<ul>
<li>Validates non-empty path</li>
<li>Catches <code>OSError</code> and wraps in <code>ToolError</code></li>
<li>Validates content size before writing</li>
</ul></li>
</ol>
<p><strong>Prompt</strong>:</p>
<pre><code>Use `write_file` to write content to a file.

**Arguments:**
- `path`: The file path (relative or absolute)
- `content`: The content to write to the file
- `overwrite`: Must be set to `true` to overwrite an existing file (default: `false`)

**IMPORTANT SAFETY RULES:**

- By default, the tool will **fail if the file already exists** to prevent accidental data loss
- To **overwrite** an existing file, you **MUST** set `overwrite: true`
- To **create a new file**, just provide the `path` and `content` (overwrite defaults to false)
- If parent directories don't exist, they will be created automatically

**BEST PRACTICES:**

- **ALWAYS** use the `read_file` tool first before overwriting an existing file to understand its current contents
- **ALWAYS** prefer using `search_replace` to edit existing files rather than overwriting them completely
- **NEVER** write new files unless explicitly required - prefer modifying existing files
- **NEVER** proactively create documentation files (*.md) or README files unless explicitly requested
- **AVOID** using emojis in file content unless the user explicitly requests them

**Usage Examples:**

``python
# Create a new file (will error if file exists)
write_file(
    path="src/new_module.py",
    content="def hello():\n    return 'Hello World'"
)

# Overwrite an existing file (must read it first!)
# First: read_file(path="src/existing.py")
# Then:
write_file(
    path="src/existing.py",
    content="# Updated content\ndef new_function():\n    pass",
    overwrite=True
)
``

**Remember:** For editing existing files, prefer `search_replace` over `write_file` to preserve unchanged portions and avoid accidental data loss.</code></pre>
<hr>
</section>
<section id="search_replace" class="level3">
<h3 class="anchored" data-anchor-id="search_replace">3. search_replace</h3>
<p><strong>Purpose</strong>: Replace sections of files using SEARCH/REPLACE blocks.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SearchReplaceArgs(BaseModel):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    file_path: <span class="bu">str</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    content: <span class="bu">str</span>  <span class="co"># Contains SEARCH/REPLACE blocks</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SearchReplaceResult(BaseModel):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>: <span class="bu">str</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    blocks_applied: <span class="bu">int</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    lines_changed: <span class="bu">int</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    content: <span class="bu">str</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    warnings: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> []</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Path Validation</strong>: - Validates file exists and is a file (not directory) - Resolves relative paths to absolute - Checks path is within project directory</p>
<ol start="2" type="1">
<li><strong>Content Validation</strong>:
<ul>
<li>Validates non-empty content</li>
<li>Configurable <code>max_content_size</code> (default: 100,000 bytes)</li>
<li>Parses SEARCH/REPLACE blocks with regex</li>
<li>Validates block format and content</li>
</ul></li>
<li><strong>Backup Support</strong>:
<ul>
<li>Configurable <code>create_backup</code> (default: False)</li>
<li>Creates <code>.bak</code> files when enabled</li>
</ul></li>
<li><strong>Fuzzy Matching</strong>:
<ul>
<li>Configurable <code>fuzzy_threshold</code> (default: 0.9)</li>
<li>Provides context when search text not found</li>
<li>Shows unified diff of closest match</li>
</ul></li>
<li><strong>Error Handling</strong>:
<ul>
<li>Detailed error messages with context</li>
<li>Shows line numbers and surrounding content</li>
<li>Warns about multiple occurrences</li>
<li>Handles Unicode decode errors</li>
<li>Permission error handling</li>
</ul></li>
</ol>
<p><strong>Prompt</strong></p>
<pre><code>Use `search_replace` to make targeted changes to files using SEARCH/REPLACE blocks. This tool finds exact text matches and replaces them.

Arguments:
- `file_path`: The path to the file to modify
- `content`: The SEARCH/REPLACE blocks defining the changes

The content format is:

``
&lt;&lt;&lt;&lt;&lt;&lt;&lt; SEARCH
[exact text to find in the file]
=======
[exact text to replace it with]
&gt;&gt;&gt;&gt;&gt;&gt;&gt; REPLACE
``

You can include multiple SEARCH/REPLACE blocks to make multiple changes to the same file:

``
&lt;&lt;&lt;&lt;&lt;&lt;&lt; SEARCH
def old_function():
    return "old value"
=======
def new_function():
    return "new value"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; REPLACE

&lt;&lt;&lt;&lt;&lt;&lt;&lt; SEARCH
import os
=======
import os
import sys
&gt;&gt;&gt;&gt;&gt;&gt;&gt; REPLACE
``

IMPORTANT:

- The SEARCH text must match EXACTLY (including whitespace, indentation, and line endings)
- The SEARCH text must appear exactly once in the file - if it appears multiple times, the tool will error
- Use at least 5 equals signs (=====) between SEARCH and REPLACE sections
- The tool will provide detailed error messages showing context if search text is not found
- Each search/replace block is applied in order, so later blocks see the results of earlier ones
- Be careful with escape sequences in string literals - use \n not \\n for newlines in code</code></pre>
<hr>
</section>
<section id="bash" class="level3">
<h3 class="anchored" data-anchor-id="bash">4. bash</h3>
<p><strong>Purpose</strong>: Run one-off bash commands and capture output.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BashArgs(BaseModel):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    command: <span class="bu">str</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    timeout: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>  <span class="co"># Override default timeout</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BashResult(BaseModel):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    command: <span class="bu">str</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    stdout: <span class="bu">str</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    stderr: <span class="bu">str</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    returncode: <span class="bu">int</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Command Analysis</strong>: - Uses tree-sitter to parse bash commands - Extracts individual commands from compound statements - Analyzes command structure for security</p>
<ol start="2" type="1">
<li><strong>Allowlist/Denylist</strong>:
<ul>
<li>Default allowlist: safe commands (echo, find, git, etc.)</li>
<li>Default denylist: interactive shells, editors, debuggers</li>
<li>Denylist for standalone commands (python, bash, etc.)</li>
<li>Pattern matching using <code>startswith()</code></li>
</ul></li>
<li><strong>Process Isolation</strong>:
<ul>
<li>Creates new process group (<code>start_new_session</code> on Unix)</li>
<li>Sets environment variables to prevent interaction:
<ul>
<li><code>CI=true</code>, <code>NONINTERACTIVE=1</code>, <code>NO_TTY=1</code></li>
<li><code>TERM=dumb</code>, <code>DEBIAN_FRONTEND=noninteractive</code></li>
<li>Disables pagers (<code>PAGER=cat</code>, <code>GIT_PAGER=cat</code>)</li>
</ul></li>
</ul></li>
<li><strong>Timeout Enforcement</strong>:
<ul>
<li>Configurable default timeout (300 seconds)</li>
<li>Uses <code>asyncio.wait_for()</code> to kill hanging processes</li>
<li>Process tree killing on timeout</li>
<li>Different methods for Windows vs Unix</li>
</ul></li>
<li><strong>Output Limits</strong>:
<ul>
<li>Configurable <code>max_output_bytes</code> (default: 16,000 bytes)</li>
<li>Truncates stdout/stderr at limit</li>
</ul></li>
<li><strong>Error Handling</strong>:
<ul>
<li>Non-zero return codes raise <code>ToolError</code></li>
<li>Timeout errors are caught and wrapped</li>
<li>Process cleanup in finally block</li>
<li>Encoding handling for Windows</li>
</ul></li>
</ol>
<p><strong>Prompt</strong></p>
<pre><code>Use the `bash` tool to run one-off shell commands.

**Key characteristics:**
- **Stateless**: Each command runs independently in a fresh environment

**Timeout:**
- The `timeout` argument controls how long the command can run before being killed
- When `timeout` is not specified (or set to `None`), the config default is used
- If a command is timing out, do not hesitate to increase the timeout using the `timeout` argument

**IMPORTANT: Use dedicated tools if available instead of these bash commands:**

**File Operations - DO NOT USE:**
- `cat filename` → Use `read_file(path="filename")`
- `head -n 20 filename` → Use `read_file(path="filename", limit=20)`
- `tail -n 20 filename` → Read with offset: `read_file(path="filename", offset=&lt;line_number&gt;, limit=20)`
- `sed -n '100,200p' filename` → Use `read_file(path="filename", offset=99, limit=101)`
- `less`, `more`, `vim`, `nano` → Use `read_file` with offset/limit for navigation
- `echo "content" &gt; file` → Use `write_file(path="file", content="content")`
- `echo "content" &gt;&gt; file` → Read first, then `write_file` with overwrite=true

**Search Operations - DO NOT USE:**
- `grep -r "pattern" .` → Use `grep(pattern="pattern", path=".")`
- `find . -name "*.py"` → Use `bash("ls -la")` for current dir or `grep` with appropriate pattern
- `ag`, `ack`, `rg` commands → Use the `grep` tool
- `locate` → Use `grep` tool

**File Modification - DO NOT USE:**
- `sed -i 's/old/new/g' file` → Use `search_replace` tool
- `awk` for file editing → Use `search_replace` tool
- Any in-place file editing → Use `search_replace` tool

**APPROPRIATE bash uses:**
- System information: `pwd`, `whoami`, `date`, `uname -a`
- Directory listings: `ls -la`, `tree` (if available)
- Git operations: `git status`, `git log --oneline -10`, `git diff`
- Process info: `ps aux | grep process`, `top -n 1`
- Network checks: `ping -c 1 google.com`, `curl -I https://example.com`
- Package management: `pip list`, `npm list`
- Environment checks: `env | grep VAR`, `which python`
- File metadata: `stat filename`, `file filename`, `wc -l filename`

**Example: Reading a large file efficiently**

WRONG:
``bash
bash("cat large_file.txt")  # May hit size limits
bash("head -1000 large_file.txt")  # Inefficient
``

RIGHT:
``python
# First chunk
read_file(path="large_file.txt", limit=1000)
# If was_truncated=true, read next chunk
read_file(path="large_file.txt", offset=1000, limit=1000)
``

**Example: Searching for patterns**

WRONG:
``bash
bash("grep -r 'TODO' src/")  # Don't use bash for grep
bash("find . -type f -name '*.py' | xargs grep 'import'")  # Too complex
``

RIGHT:
``python
grep(pattern="TODO", path="src/")
grep(pattern="import", path=".")
``

**Remember:** Bash is best for quick system checks and git operations. For file operations, searching, and editing, always use the dedicated tools when they are available.</code></pre>
<hr>
</section>
<section id="grep" class="level3">
<h3 class="anchored" data-anchor-id="grep">5. grep</h3>
<p><strong>Purpose</strong>: Recursively search files for a regex pattern.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GrepArgs(BaseModel):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    pattern: <span class="bu">str</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span> <span class="op">=</span> <span class="st">"."</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    max_matches: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    use_default_ignore: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GrepResult(BaseModel):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    matches: <span class="bu">str</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    match_count: <span class="bu">int</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    was_truncated: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Backend Detection</strong>: - Prefers <code>ripgrep</code> (rg) over <code>grep</code> - Falls back to GNU grep if rg not available - Raises error if neither is installed</p>
<ol start="2" type="1">
<li><strong>Exclusion Patterns</strong>:
<ul>
<li>Default exclusion list for common directories:
<ul>
<li><code>.venv/</code>, <code>venv/</code>, <code>.env/</code>, <code>env/</code></li>
<li><code>node_modules/</code>, <code>.git/</code>, <code>__pycache__/</code></li>
<li>Cache directories, build directories, IDE files</li>
<li>Binary files, system files</li>
</ul></li>
<li>Loads additional patterns from <code>.vibeignore</code></li>
<li>Respects <code>.gitignore</code> and <code>.ignore</code> files</li>
</ul></li>
<li><strong>Output Limits</strong>:
<ul>
<li>Configurable <code>max_output_bytes</code> (default: 64,000 bytes)</li>
<li>Configurable <code>default_max_matches</code> (default: 100)</li>
<li>Tracks truncation state</li>
</ul></li>
<li><strong>Timeout</strong>:
<ul>
<li>Configurable <code>default_timeout</code> (default: 60 seconds)</li>
<li>Kills process on timeout</li>
</ul></li>
<li><strong>Path Validation</strong>:
<ul>
<li>Validates search path exists</li>
<li>Expands relative paths</li>
</ul></li>
</ol>
<p><strong>Prompt</strong></p>
<pre><code>Use `grep` to recursively search for a regular expression pattern in files.

- It's very fast and automatically ignores files that you should not read like .pyc files, .venv directories, etc.
- Use this to find where functions are defined, how variables are used, or to locate specific error messages.</code></pre>
<hr>
</section>
<section id="todo" class="level3">
<h3 class="anchored" data-anchor-id="todo">6. todo</h3>
<p><strong>Purpose</strong>: Manage a simple task list.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TodoArgs(BaseModel):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    action: <span class="bu">str</span>  <span class="co"># "read" or "write"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    todos: <span class="bu">list</span>[TodoItem] <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TodoResult(BaseModel):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    message: <span class="bu">str</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    todos: <span class="bu">list</span>[TodoItem]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    total_count: <span class="bu">int</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>State Isolation</strong>: - Maintains separate state per tool instance - No external filesystem access - No command execution</p>
<ol start="2" type="1">
<li><strong>Limit Enforcement</strong>:
<ul>
<li>Configurable <code>max_todos</code> (default: 100)</li>
<li>Validates todo count on write</li>
</ul></li>
<li><strong>Data Validation</strong>:
<ul>
<li>Validates unique IDs</li>
<li>Validates status and priority values</li>
<li>Pydantic model validation</li>
</ul></li>
<li><strong>Permission</strong>:
<ul>
<li>Default permission: <code>ToolPermission.ALWAYS</code></li>
<li>No sensitive operations</li>
</ul></li>
</ol>
<p><strong>Prompt</strong></p>
<pre><code>Use the `todo` tool to manage a simple task list. This tool helps you track tasks and their progress.

## How it works

- **Reading:** Use `action: "read"` to view the current todo list
- **Writing:** Use `action: "write"` with the complete `todos` list to update. You must provide the ENTIRE list - this replaces everything.

## Todo Structure
Each todo item has:
- `id`: A unique string identifier (e.g., "1", "2", "task-a")
- `content`: The task description
- `status`: One of: "pending", "in_progress", "completed", "cancelled"
- `priority`: One of: "high", "medium", "low"

## When to Use This Tool

**Use proactively for:**
- Complex multi-step tasks (3+ distinct steps)
- Non-trivial tasks requiring careful planning
- Multiple tasks provided by the user (numbered or comma-separated)
- Tracking progress on ongoing work
- After receiving new instructions - immediately capture requirements
- When starting work - mark task as in_progress BEFORE beginning
- After completing work - mark as completed and add any follow-up tasks discovered

**Skip this tool for:**
- Single, straightforward tasks
- Trivial operations (&lt; 3 simple steps)
- Purely conversational or informational requests
- Tasks that provide no organizational benefit

## Task Management Best Practices

1. **Status Management:**
   - Only ONE task should be `in_progress` at a time
   - Mark tasks `in_progress` BEFORE starting work on them
   - Mark tasks `completed` IMMEDIATELY after finishing
   - Keep tasks `in_progress` if blocked or encountering errors

2. **Task Completion Rules:**
   - ONLY mark as `completed` when FULLY accomplished
   - Never mark complete if tests are failing, implementation is partial, or errors are unresolved
   - When blocked, create a new task describing what needs resolution

3. **Task Organization:**
   - Create specific, actionable items
   - Break complex tasks into manageable steps
   - Use clear, descriptive task names
   - Remove irrelevant tasks entirely (don't just mark cancelled)

## Examples

**Example 1: Reading todos**
``json
{
  "action": "read"
}
``

**Example 2: Initial task creation (user requests multiple features)**
``json
{
  "action": "write",
  "todos": [
    {
      "id": "1",
      "content": "Add dark mode toggle to settings",
      "status": "pending",
      "priority": "high"
    },
    {
      "id": "2",
      "content": "Implement theme context/state management",
      "status": "pending",
      "priority": "high"
    },
    {
      "id": "3",
      "content": "Update components for theme switching",
      "status": "pending",
      "priority": "medium"
    },
    {
      "id": "4",
      "content": "Run tests and verify build",
      "status": "pending",
      "priority": "medium"
    }
  ]
}
``

**Example 3: Starting work (marking one task in_progress)**
``json
{
  "action": "write",
  "todos": [
    {
      "id": "1",
      "content": "Add dark mode toggle to settings",
      "status": "in_progress",
      "priority": "high"
    },
    {
      "id": "2",
      "content": "Implement theme context/state management",
      "status": "pending",
      "priority": "high"
    },
    {
      "id": "3",
      "content": "Update components for theme switching",
      "status": "pending",
      "priority": "medium"
    },
    {
      "id": "4",
      "content": "Run tests and verify build",
      "status": "pending",
      "priority": "medium"
    }
  ]
}
``

**Example 4: Completing task and adding discovered subtask**
``json
{
  "action": "write",
  "todos": [
    {
      "id": "1",
      "content": "Add dark mode toggle to settings",
      "status": "completed",
      "priority": "high"
    },
    {
      "id": "2",
      "content": "Implement theme context/state management",
      "status": "in_progress",
      "priority": "high"
    },
    {
      "id": "3",
      "content": "Update components for theme switching",
      "status": "pending",
      "priority": "medium"
    },
    {
      "id": "4",
      "content": "Fix TypeScript errors in theme types",
      "status": "pending",
      "priority": "high"
    },
    {
      "id": "5",
      "content": "Run tests and verify build",
      "status": "pending",
      "priority": "medium"
    }
  ]
}
``

**Example 5: Handling blockers (keeping task in_progress)**
``json
{
  "action": "write",
  "todos": [
    {
      "id": "1",
      "content": "Deploy to production",
      "status": "in_progress",
      "priority": "high"
    },
    {
      "id": "2",
      "content": "BLOCKER: Fix failing deployment pipeline",
      "status": "pending",
      "priority": "high"
    },
    {
      "id": "3",
      "content": "Update documentation",
      "status": "pending",
      "priority": "low"
    }
  ]
}
``

## Common Scenarios

**Multi-file refactoring:** Create todos for each file that needs updating
**Performance optimization:** List specific bottlenecks as individual tasks
**Bug fixing:** Track reproduction, diagnosis, fix, and verification as separate tasks
**Feature implementation:** Break down into UI, logic, tests, and documentation tasks

Remember: When writing, you must include ALL todos you want to keep. Any todo not in the list will be removed. Be proactive with task management to demonstrate thoroughness and ensure all requirements are completed successfully.</code></pre>
<hr>
</section>
<section id="ask_user_question" class="level3">
<h3 class="anchored" data-anchor-id="ask_user_question">7. ask_user_question</h3>
<p><strong>Purpose</strong>: Ask the user one or more questions and wait for responses.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AskUserQuestionArgs(BaseModel):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    questions: <span class="bu">list</span>[Question]  <span class="co"># 1-4 questions</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AskUserQuestionResult(BaseModel):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    answers: <span class="bu">list</span>[Answer]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    cancelled: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Context Validation</strong>: - Requires <code>InvokeContext</code> with <code>user_input_callback</code> - Fails if not in interactive UI - Prevents use in non-interactive contexts</p>
<ol start="2" type="1">
<li><strong>Input Validation</strong>:
<ul>
<li>Validates question count (1-4)</li>
<li>Validates option count (2-4 per question)</li>
<li>Validates header length (max 12 characters)</li>
<li>Pydantic model validation</li>
</ul></li>
<li><strong>No External Access</strong>:
<ul>
<li>No filesystem operations</li>
<li>No command execution</li>
<li>Pure UI interaction</li>
</ul></li>
<li><strong>Permission</strong>:
<ul>
<li>Default permission: <code>ToolPermission.ALWAYS</code></li>
<li>Safe, read-only operation</li>
</ul></li>
</ol>
<p><strong>Prompt</strong>: See <code>vibe/core/tools/builtins/prompts/ask_user_question.md</code></p>
<hr>
</section>
<section id="task" class="level3">
<h3 class="anchored" data-anchor-id="task">8. task</h3>
<p><strong>Purpose</strong>: Delegate work to a subagent for independent execution.</p>
<p><strong>Input Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TaskArgs(BaseModel):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    task: <span class="bu">str</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    agent: <span class="bu">str</span> <span class="op">=</span> <span class="st">"explore"</span>  <span class="co"># Must be a subagent</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Output Signature</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TaskResult(BaseModel):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    response: <span class="bu">str</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    turns_used: <span class="bu">int</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    completed: <span class="bu">bool</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Security Mechanisms</strong>: 1. <strong>Agent Type Validation</strong>: - Validates agent exists - Checks <code>agent_type == AgentType.SUBAGENT</code> - Prevents recursive spawning of regular agents - Prevents spawning interactive agents</p>
<ol start="2" type="1">
<li><strong>Isolation</strong>:
<ul>
<li>Creates separate <code>AgentLoop</code> instance</li>
<li>Disables session logging for subagents</li>
<li>Separate configuration and state</li>
</ul></li>
<li><strong>Resource Limits</strong>:
<ul>
<li>Tracks turns used</li>
<li>Detects interruption/completion</li>
<li>Limits output accumulation</li>
</ul></li>
<li><strong>Permission</strong>:
<ul>
<li>Default permission: <code>ToolPermission.ASK</code></li>
<li>Requires explicit approval</li>
</ul></li>
</ol>
<p><strong>Prompt</strong></p>
<pre><code>Use `ask_user_question` to gather information from the user when you need clarification, want to validate assumptions, or need help making a decision. **Don't hesitate to use this tool** - it's better to ask than to guess wrong.

## When to Use

- **Clarifying requirements**: Ambiguous instructions, unclear scope
- **Technical decisions**: Architecture choices, library selection, tradeoffs
- **Preference gathering**: UI style, naming conventions, approach options
- **Validation**: Confirming understanding before starting significant work
- **Multiple valid paths**: When several approaches could work and you want user input

## Question Structure

Each question has these fields:

- `question`: The full question text (be specific and clear)
- `header`: A short label displayed as a chip (max 12 characters, e.g., "Auth", "Database", "Approach")
- `options`: 2-4 choices (an "Other" option is automatically added for free text)
- `multi_select`: Set to `true` if user can pick multiple options (default: `false`)

### Options Structure

Each option has:
- `label`: Short display text (1-5 words)
- `description`: Brief explanation of what this choice means or its implications

## Examples

**Single question with recommended option:**
``json
{
  "questions": [{
    "question": "Which authentication method should we use?",
    "header": "Auth",
    "options": [
      {"label": "JWT tokens (Recommended)", "description": "Stateless, scalable, works well with APIs"},
      {"label": "Session cookies", "description": "Traditional approach, requires session storage"},
      {"label": "OAuth 2.0", "description": "Third-party auth, more complex setup"}
    ],
    "multi_select": false
  }]
}
``

**Multiple questions (displayed as tabs):**
``json
{
  "questions": [
    {
      "question": "Which database should we use?",
      "header": "Database",
      "options": [
        {"label": "PostgreSQL", "description": "Relational, ACID compliant"},
        {"label": "MongoDB", "description": "Document store, flexible schema"}
      ],
      "multi_select": false
    },
    {
      "question": "Which features should be included in v1?",
      "header": "Features",
      "options": [
        {"label": "User auth", "description": "Login, signup, password reset"},
        {"label": "Search", "description": "Full-text search across content"},
        {"label": "Export", "description": "CSV and PDF export"}
      ],
      "multi_select": true
    }
  ]
}
``

## Key Constraints

- **Header max length**: 12 characters (keeps UI clean)
- **Options count**: 2-4 per question (plus automatic "Other")
- **Questions count**: 1-4 per call
- **Label length**: Keep to 1-5 words for readability

## Tips

1. **Put recommended option first** and add "(Recommended)" to its label
2. **Use descriptive headers** that categorize the question type
3. **Keep descriptions concise** but informative about tradeoffs
4. **Use multi_select** when choices aren't mutually exclusive (e.g., features to include)
5. **Ask early** - it's better to clarify before starting than to redo work</code></pre>
</section>
</section>
<section id="base-tool-security-framework" class="level2">
<h2 class="anchored" data-anchor-id="base-tool-security-framework">Base Tool Security Framework</h2>
<section id="basetool-class" class="level3">
<h3 class="anchored" data-anchor-id="basetool-class">BaseTool Class</h3>
<p>All tools inherit from <code>BaseTool</code> which provides:</p>
<ol type="1">
<li><strong>Type Safety</strong>:
<ul>
<li>Generic types for arguments, results, config, and state</li>
<li>Pydantic model validation</li>
<li>Type extraction from annotations</li>
</ul></li>
<li><strong>Configuration</strong>:
<ul>
<li><code>BaseToolConfig</code> with permission model</li>
<li><code>ToolPermission</code> enum (ALWAYS, NEVER, ASK)</li>
<li>Allowlist/denylist patterns</li>
</ul></li>
<li><strong>State Management</strong>:
<ul>
<li><code>BaseToolState</code> for persistent tool state</li>
<li>Separate state per tool instance</li>
</ul></li>
</ol>
</section>
<section id="toolpermission-system" class="level3">
<h3 class="anchored" data-anchor-id="toolpermission-system">ToolPermission System</h3>
<p>Three permission levels: - <strong>ALWAYS</strong>: Tool executes without approval - <strong>NEVER</strong>: Tool is permanently disabled - <strong>ASK</strong>: User must approve each execution</p>
<p><strong>Permission Check Flow</strong>: 1. Tool calls <code>check_allowlist_denylist(args)</code> 2. If returns ALWAYS or NEVER, use that permission 3. Otherwise, use config permission 4. Agent loop applies final approval logic</p>
</section>
<section id="invokecontext" class="level3">
<h3 class="anchored" data-anchor-id="invokecontext">InvokeContext</h3>
<p>Provides execution context: - <code>tool_call_id</code>: Unique identifier for this invocation - <code>approval_callback</code>: Function to request user approval - <code>agent_manager</code>: Access to agent system - <code>user_input_callback</code>: Function to ask user questions</p>
</section>
</section>
<section id="security-best-practices" class="level2">
<h2 class="anchored" data-anchor-id="security-best-practices">Security Best Practices</h2>
<section id="path-security" class="level3">
<h3 class="anchored" data-anchor-id="path-security">Path Security</h3>
<ol type="1">
<li>Always resolve relative paths to absolute</li>
<li>Validate paths are within project directory</li>
<li>Use <code>path.relative_to()</code> for containment checks</li>
<li>Never allow <code>..</code> to escape project root</li>
</ol>
</section>
<section id="command-security" class="level3">
<h3 class="anchored" data-anchor-id="command-security">Command Security</h3>
<ol type="1">
<li>Parse and analyze command structure</li>
<li>Use allowlist/denylist patterns</li>
<li>Isolate processes (new session/group)</li>
<li>Set safe environment variables</li>
<li>Enforce timeouts</li>
<li>Limit output size</li>
</ol>
</section>
<section id="file-security" class="level3">
<h3 class="anchored" data-anchor-id="file-security">File Security</h3>
<ol type="1">
<li>Validate file existence and type</li>
<li>Enforce size limits</li>
<li>Require explicit overwrite for existing files</li>
<li>Create backups when appropriate</li>
<li>Handle encoding errors gracefully</li>
</ol>
</section>
<section id="process-security" class="level3">
<h3 class="anchored" data-anchor-id="process-security">Process Security</h3>
<ol type="1">
<li>Kill process trees on timeout/interrupt</li>
<li>Clean up resources in finally blocks</li>
<li>Handle platform differences (Windows vs Unix)</li>
<li>Use asyncio for process management</li>
</ol>
</section>
<section id="data-security" class="level3">
<h3 class="anchored" data-anchor-id="data-security">Data Security</h3>
<ol type="1">
<li>Validate all inputs with Pydantic models</li>
<li>Enforce limits on content size</li>
<li>Sanitize output (truncate when needed)</li>
<li>Never expose sensitive information in errors</li>
</ol>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Mistral Vibe’s tool system implements a comprehensive security model:</p>
<ol type="1">
<li><strong>Defense in Depth</strong>: Multiple layers of validation and checking</li>
<li><strong>Least Privilege</strong>: Tools have minimal required permissions</li>
<li><strong>Explicit Approval</strong>: Most tools require user approval</li>
<li><strong>Input Validation</strong>: Strict validation of all parameters</li>
<li><strong>Output Limits</strong>: Prevents resource exhaustion</li>
<li><strong>Process Isolation</strong>: Safe command execution</li>
<li><strong>Path Containment</strong>: Prevents directory traversal</li>
<li><strong>Error Handling</strong>: Graceful degradation and recovery</li>
</ol>
<p>Each tool follows the same security patterns while adapting them to the specific requirements of its operation.</p>
</section>
<section id="mistral-vibe-tool-system-comprehensive-security-analysis" class="level2">
<h2 class="anchored" data-anchor-id="mistral-vibe-tool-system-comprehensive-security-analysis">Mistral Vibe Tool System: Comprehensive Security Analysis</h2>
<p>I’ve completed an in-depth exploration of Mistral Vibe’s tool system, documenting each built-in tool, its security mechanisms, and the overall architecture. Here’s a comprehensive summary:</p>
<section id="built-in-tools-overview" class="level3">
<h3 class="anchored" data-anchor-id="built-in-tools-overview">Built-in Tools Overview</h3>
<p>Mistral Vibe provides 8 built-in tools, each with sophisticated security mechanisms:</p>
<ol type="1">
<li><strong>read_file</strong> - Safe file reading with byte limits and path validation</li>
<li><strong>write_file</strong> - Protected file writing with overwrite confirmation</li>
<li><strong>search_replace</strong> - Precise file editing with backup support</li>
<li><strong>bash</strong> - Secure command execution with allowlist/denylist and process isolation</li>
<li><strong>grep</strong> - Safe code searching with exclusion patterns</li>
<li><strong>todo</strong> - Task management with state isolation</li>
<li><strong>ask_user_question</strong> - Interactive user queries with context validation</li>
<li><strong>task</strong> - Subagent delegation with agent type validation</li>
</ol>
</section>
<section id="key-security-features" class="level3">
<h3 class="anchored" data-anchor-id="key-security-features">Key Security Features</h3>
<p><strong>1. Path Security</strong> - All tools validate paths are within the project directory using <code>path.relative_to()</code> - Prevents directory traversal attacks - Expands and resolves paths consistently</p>
<p><strong>2. Permission System</strong> - Three-level permission model: ALWAYS, NEVER, ASK - Allowlist/denylist patterns using <code>fnmatch</code> - Configurable per-tool permissions - Explicit user approval for most operations</p>
<p><strong>3. Resource Limits</strong> - Byte limits for file operations (64KB-100KB) - Output limits for commands (16KB-64KB) - Match limits for searches (100 matches) - Timeout enforcement (60-300 seconds)</p>
<p><strong>4. Process Isolation</strong> - Bash commands run in isolated process groups - Safe environment variables (CI=true, NONINTERACTIVE=1) - Process tree killing on timeout - Platform-specific handling (Windows vs Unix)</p>
<p><strong>5. Input Validation</strong> - Pydantic model validation for all parameters - Strict type checking and constraints - Parameter range validation - Empty/null checking</p>
<p><strong>6. Error Handling</strong> - Graceful error recovery - Detailed error messages with context - Wrapping of low-level errors - Prevention of information leakage</p>
</section>
<section id="security-architecture" class="level3">
<h3 class="anchored" data-anchor-id="security-architecture">Security Architecture</h3>
<p>The tool system implements a <strong>defense-in-depth</strong> approach:</p>
<ol type="1">
<li><strong>BaseTool Framework</strong> - Provides type safety, configuration, and state management</li>
<li><strong>Permission System</strong> - Three-tier approval model with allowlist/denylist</li>
<li><strong>InvokeContext</strong> - Execution context with approval callbacks</li>
<li><strong>ToolManager</strong> - Centralized tool discovery and instantiation</li>
<li><strong>Agent Loop</strong> - Orchestrates tool execution with middleware</li>
</ol>
</section>
<section id="most-important-security-aspects" class="level3">
<h3 class="anchored" data-anchor-id="most-important-security-aspects">Most Important Security Aspects</h3>
<p><strong>Path Containment</strong>: The most critical security feature is path validation. All file operations check that paths remain within the project directory using <code>path.relative_to(Path.cwd().resolve())</code>, preventing directory traversal attacks.</p>
<p><strong>Process Isolation</strong>: For command execution, the system uses tree-sitter to parse commands, sets safe environment variables, creates isolated process groups, and enforces strict timeouts to prevent command injection and resource exhaustion.</p>
<p><strong>Permission Model</strong>: The three-level permission system (ALWAYS/NEVER/ASK) with allowlist/denylist support provides fine-grained control over tool execution, requiring explicit user approval for most operations.</p>
<p><strong>Resource Limits</strong>: Byte limits, output limits, and timeouts prevent resource exhaustion attacks, ensuring the system remains responsive even with malicious input.</p>
<p>The documentation file <code>mistral-vibe-tool-system-analysis.md</code> provides a detailed, comprehensive analysis of each tool’s security mechanisms, input/output signatures, and implementation details.</p>
</section>
<section id="system-prompt-construction" class="level3">
<h3 class="anchored" data-anchor-id="system-prompt-construction">System Prompt Construction</h3>
<p>The system prompt is constructed by the <code>get_universal_system_prompt()</code> function in <code>vibe/core/system_prompt.py</code>. It combines multiple components:</p>
<ol type="1">
<li><strong>Base System Prompt</strong> (<code>vibe/core/prompts/cli.md</code>)
<ul>
<li>General guidelines for the AI assistant</li>
<li>Tool usage best practices</li>
<li>Code modification guidelines</li>
<li>Tone and style requirements</li>
</ul></li>
<li><strong>Optional Components</strong> (controlled by config flags)
<ul>
<li>Commit signature instructions</li>
<li>Model information</li>
<li>Platform-specific information (OS, shell)</li>
<li>Tool-specific prompts</li>
<li>Available skills</li>
<li>Available subagents</li>
</ul></li>
<li><strong>Project Context</strong> (if enabled)
<ul>
<li>Directory structure with limits</li>
<li>Git status and recent commits</li>
<li>Project documentation</li>
</ul></li>
</ol>
</section>
<section id="tool-integration" class="level3">
<h3 class="anchored" data-anchor-id="tool-integration">Tool Integration</h3>
<p>Tools are integrated in two ways:</p>
<section id="tool-prompts-in-system-message" class="level4">
<h4 class="anchored" data-anchor-id="tool-prompts-in-system-message">1. Tool Prompts in System Message</h4>
<p>Each tool has an associated <code>.md</code> file in <code>vibe/core/tools/builtins/prompts/</code> that provides detailed usage guidelines. These are loaded when <code>config.include_prompt_detail</code> is True.</p>
<p><strong>Tool Prompts Include:</strong> - <code>read_file.md</code> - File reading best practices - <code>write_file.md</code> - File writing safety rules - <code>search_replace.md</code> - Search/replace block format - <code>bash.md</code> - Command execution guidelines - <code>grep.md</code> - Search operation best practices - <code>todo.md</code> - Task management guidelines - <code>ask_user_question.md</code> - User interaction patterns - <code>task.md</code> - Subagent delegation best practices</p>
</section>
<section id="tool-schemas-in-llm-api-calls" class="level4">
<h4 class="anchored" data-anchor-id="tool-schemas-in-llm-api-calls">2. Tool Schemas in LLM API Calls</h4>
<p>The <code>APIToolFormatHandler</code> class provides tool schemas to the LLM:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_available_tools(<span class="va">self</span>, tool_manager: ToolManager) <span class="op">-&gt;</span> <span class="bu">list</span>[AvailableTool]:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        AvailableTool(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            function<span class="op">=</span>AvailableFunction(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                name<span class="op">=</span>tool_class.get_name(),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                description<span class="op">=</span>tool_class.description,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                parameters<span class="op">=</span>tool_class.get_parameters(),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tool_class <span class="kw">in</span> tool_manager.available_tools.values()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    ]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Tool Schema Components:</strong> - <strong>Name</strong>: Derived from class name (e.g., <code>ReadFile</code> → <code>read_file</code>) - <strong>Description</strong>: Class variable description - <strong>Parameters</strong>: JSON schema from Pydantic model</p>
</section>
</section>
<section id="key-integration-points" class="level3">
<h3 class="anchored" data-anchor-id="key-integration-points">Key Integration Points</h3>
<ol type="1">
<li><strong><code>get_universal_system_prompt()</code></strong> - Builds the complete system prompt</li>
<li><strong><code>BaseTool.get_tool_prompt()</code></strong> - Loads tool-specific documentation</li>
<li><strong><code>APIToolFormatHandler.get_available_tools()</code></strong> - Provides tool schemas to LLM</li>
<li><strong><code>ToolManager</code></strong> - Discovers and manages available tools</li>
</ol>
</section>
<section id="tool-execution-flow" class="level3">
<h3 class="anchored" data-anchor-id="tool-execution-flow">Tool Execution Flow</h3>
<ol type="1">
<li>LLM receives system prompt + tool schemas</li>
<li>LLM generates tool calls in API format</li>
<li><code>parse_message()</code> extracts tool calls</li>
<li><code>resolve_tool_calls()</code> validates tool names and arguments</li>
<li>Agent loop executes tools with permission checks</li>
<li>Results are formatted and added to conversation</li>
</ol>
</section>
<section id="multi-layered-architecture" class="level3">
<h3 class="anchored" data-anchor-id="multi-layered-architecture">Multi-Layered Architecture</h3>
<p>The system uses a <strong>multi-layered approach</strong>:</p>
<ol type="1">
<li><strong>Guidance Layer</strong>: System prompt with best practices</li>
<li><strong>Documentation Layer</strong>: Tool-specific prompts for complex operations</li>
<li><strong>API Layer</strong>: Tool schemas for function calling</li>
<li><strong>Context Layer</strong>: Project-specific information</li>
</ol>
<p>This separation allows the LLM to understand both the “how” (guidelines) and the “what” (API structure) of tool usage, resulting in more accurate and safe tool execution.</p>
<p>The documentation file <code>system-prompt-and-tool-integration.md</code> provides a complete, detailed explanation of the construction process and integration mechanisms.</p>
<p>The ToolManager discovers tools through a multi-step process:</p>
</section>
</section>
<section id="search-path-discovery" class="level2">
<h2 class="anchored" data-anchor-id="search-path-discovery">1. Search Path Discovery</h2>
<p>The manager first computes search paths from configuration: - Default tool directory (<code>DEFAULT_TOOL_DIR.path</code>) - User-configured tool paths (<code>config.tool_paths</code>) - Local tools directory (discovered from current working directory) - Global tools directory (<code>GLOBAL_TOOLS_DIR.path</code>)</p>
<p>These paths are deduplicated to avoid scanning the same location multiple times.</p>
</section>
<section id="tool-class-discovery" class="level2">
<h2 class="anchored" data-anchor-id="tool-class-discovery">2. Tool Class Discovery</h2>
<p>The <code>_iter_tool_classes()</code> method recursively scans all search paths:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="at">@staticmethod</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _iter_tool_classes(search_paths: <span class="bu">list</span>[Path]) <span class="op">-&gt;</span> Iterator[<span class="bu">type</span>[BaseTool]]:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Iterate over all search_paths to find tool classes."""</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> search_paths:</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> base.is_dir() <span class="kw">and</span> base.name.endswith(<span class="st">".py"</span>):</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> tools <span class="op">:=</span> ToolManager._load_tools_from_file(base):</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> tool <span class="kw">in</span> tools:</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> tool</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> path <span class="kw">in</span> base.rglob(<span class="st">"*.py"</span>):</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> tools <span class="op">:=</span> ToolManager._load_tools_from_file(path):</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> tool <span class="kw">in</span> tools:</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> tool</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This method: - Handles both directories and individual <code>.py</code> files - Recursively scans directories with <code>rglob("*.py")</code> - Uses <code>_load_tools_from_file()</code> to extract tool classes from each Python file</p>
</section>
<section id="tool-loading-from-files" class="level2">
<h2 class="anchored" data-anchor-id="tool-loading-from-files">3. Tool Loading from Files</h2>
<p>The <code>_load_tools_from_file()</code> method: - Skips files starting with <code>_</code> (private modules) - Computes a module name (canonical for vibe package files, hash-based for external files) - Dynamically imports the module using <code>importlib.util</code> - Inspects the module’s namespace for classes that: - Are subclasses of <code>BaseTool</code> - Are not abstract - Are not the <code>BaseTool</code> class itself</p>
</section>
<section id="mcp-integration" class="level2">
<h2 class="anchored" data-anchor-id="mcp-integration">4. MCP Integration</h2>
<p>Additionally, the manager integrates MCP (Model Context Protocol) tools: - HTTP-based MCP servers - Stdio-based MCP servers - Each MCP server is queried for available tools - Remote tools are wrapped in proxy classes that inherit from <code>BaseTool</code></p>
</section>
<section id="filtering-and-availability" class="level2">
<h2 class="anchored" data-anchor-id="filtering-and-availability">5. Filtering and Availability</h2>
<p>After discovery, tools are filtered based on configuration: - <code>enabled_tools</code>: Only tools matching these patterns are available - <code>disabled_tools</code>: Tools matching these patterns are excluded - If neither is specified, all discovered tools are available</p>
<p>The discovered tools are stored in the <code>_available</code> dictionary with tool names as keys and tool classes as values.</p>
<p>This comprehensive discovery mechanism allows the ToolManager to find tools from multiple sources: built-in tools, user-provided tools, local project tools, and MCP servers.</p>
</section>
<section id="default-search-paths" class="level2">
<h2 class="anchored" data-anchor-id="default-search-paths">Default Search Paths</h2>
<p>The default search paths for tool discovery are:</p>
<ol type="1">
<li><strong>DEFAULT_TOOL_DIR</strong>: <code>VIBE_ROOT / "core" / "tools" / "builtins"</code>
<ul>
<li>This is the built-in tools directory in the vibe package</li>
<li>Contains the 8 built-in tools: ask_user_question, bash, grep, read_file, search_replace, write_file, task, ui</li>
</ul></li>
<li><strong>GLOBAL_TOOLS_DIR</strong>: <code>VIBE_HOME / "tools"</code>
<ul>
<li>Located at <code>~/.vibe/tools</code> (or <code>$VIBE_HOME/tools</code> if VIBE_HOME env var is set)</li>
<li>User can place custom tools here for global availability</li>
</ul></li>
<li><strong>Local Tools Directory</strong>: <code>Path.cwd() / ".vibe" / "tools"</code>
<ul>
<li>Discovered from the current working directory</li>
<li>Only available if the current directory is trusted</li>
<li>Allows project-specific tools</li>
</ul></li>
<li><strong>User-configured paths</strong>: Additional paths can be specified in the configuration</li>
</ol>
</section>
<section id="basetool-class-explanation" class="level2">
<h2 class="anchored" data-anchor-id="basetool-class-explanation">BaseTool Class Explanation</h2>
<p>The <code>BaseTool</code> class is an abstract base class that defines the interface for all tools in the system. It uses generic type parameters to ensure type safety:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>BaseTool[</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    ToolArgs: BaseModel,      <span class="co"># Input arguments model</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    ToolResult: BaseModel,    <span class="co"># Output result model</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    ToolConfig: BaseToolConfig,  <span class="co"># Configuration model</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    ToolState: BaseToolState,  <span class="co"># State model</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>](ABC)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<section id="key-components" class="level3">
<h3 class="anchored" data-anchor-id="key-components">Key Components:</h3>
<p><strong>1. InvokeContext</strong> - Contains execution context: tool_call_id, approval_callback, agent_manager, user_input_callback - Passed to tools during invocation for access to system services</p>
<p><strong>2. ToolPermission</strong> - Enum with three values: ALWAYS, NEVER, ASK - Controls whether a tool can be used without user approval - Default is ASK (requires user approval)</p>
<p><strong>3. BaseToolConfig</strong> - Base configuration class with: - <code>permission</code>: ToolPermission level - <code>allowlist</code>: Patterns that automatically allow execution - <code>denylist</code>: Patterns that automatically deny execution - Supports extra fields via <code>extra="allow"</code></p>
<p><strong>4. BaseToolState</strong> - Base state class for maintaining tool-specific state - Uses Pydantic BaseModel with strict validation</p>
<p><strong>5. Core Methods:</strong></p>
<ul>
<li><strong><code>run(args, ctx)</code></strong>: Abstract method that tools must implement
<ul>
<li>Takes input arguments and optional context</li>
<li>Returns an AsyncGenerator yielding ToolStreamEvent or ToolResult</li>
<li>This is where the actual tool logic goes</li>
</ul></li>
<li><strong><code>invoke(ctx, **raw)</code></strong>: Validates arguments and runs the tool
<ul>
<li>Validates input using Pydantic</li>
<li>Handles errors gracefully</li>
<li>Yields results from the run method</li>
</ul></li>
<li><strong><code>from_config(config)</code></strong>: Factory method to create tool instances
<ul>
<li>Creates initial state and returns configured tool instance</li>
</ul></li>
</ul>
<p><strong>6. Utility Methods:</strong></p>
<ul>
<li><strong><code>get_tool_prompt()</code></strong>: Loads the tool’s prompt file (from prompts/ subdirectory)</li>
<li><strong><code>get_name()</code></strong>: Returns the tool name in snake_case format</li>
<li><strong><code>get_parameters()</code></strong>: Returns JSON schema for the tool’s arguments</li>
<li><strong><code>check_allowlist_denylist()</code></strong>: Checks if arguments match allowlist/denylist (can be overridden)</li>
</ul>
<p><strong>7. Type Extraction:</strong></p>
<ul>
<li><strong><code>_get_tool_config_class()</code></strong>: Extracts ToolConfig type from class hierarchy</li>
<li><strong><code>_get_tool_state_class()</code></strong>: Extracts ToolState type from class hierarchy</li>
<li><strong><code>_get_tool_args_results()</code></strong>: Extracts ToolArgs and ToolResult types from run method signature</li>
<li><strong><code>_extract_result_type()</code></strong>: Extracts ToolResult from AsyncGenerator return type</li>
</ul>
</section>
<section id="design-patterns" class="level3">
<h3 class="anchored" data-anchor-id="design-patterns">Design Patterns:</h3>
<ol type="1">
<li><strong>Generic Base Class</strong>: Uses Python generics to ensure type safety while allowing customization</li>
<li><strong>Pydantic Validation</strong>: All arguments, results, config, and state use Pydantic models for validation</li>
<li><strong>Async Streaming</strong>: Tools yield results asynchronously for better UX</li>
<li><strong>Dependency Injection</strong>: Configuration and state are injected at creation time</li>
<li><strong>Type Introspection</strong>: Extracts types from method signatures for runtime validation</li>
</ol>
<p>The BaseTool class provides a solid foundation for creating type-safe, validated tools with consistent behavior across the system.</p>
</section>
</section>
<section id="mcp-server-discovery-and-integration" class="level2">
<h2 class="anchored" data-anchor-id="mcp-server-discovery-and-integration">MCP Server Discovery and Integration</h2>
<section id="configuration-structure" class="level3">
<h3 class="anchored" data-anchor-id="configuration-structure">1. Configuration Structure</h3>
<p>MCP servers are configured in the VibeConfig with three types:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>MCPServer <span class="op">=</span> Annotated[</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    MCPHttp <span class="op">|</span> MCPStreamableHttp <span class="op">|</span> MCPStdio,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    Field(discriminator<span class="op">=</span><span class="st">"transport"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Each MCP server has: - <strong><code>name</code></strong>: Short alias used to prefix tool names - <strong><code>prompt</code></strong>: Optional usage hint - <strong><code>startup_timeout_sec</code></strong>: Timeout for server initialization (default: 10s) - <strong><code>tool_timeout_sec</code></strong>: Timeout for tool execution (default: 60s)</p>
<p><strong>Transport Types:</strong> - <strong>HTTP</strong>: Remote servers accessed via HTTP - <code>url</code>: Base URL - <code>headers</code>: Additional HTTP headers - <code>api_key_env</code>: Environment variable for API token - <code>api_key_header</code>: HTTP header for the token - <code>api_key_format</code>: Format string for header value</p>
<ul>
<li><strong>Streamable HTTP</strong>: Similar to HTTP but with streaming support
<ul>
<li>Same fields as HTTP</li>
</ul></li>
<li><strong>Stdio</strong>: Local servers run as subprocesses
<ul>
<li><code>command</code>: Command to run (string or list)</li>
<li><code>args</code>: Additional arguments</li>
<li><code>env</code>: Environment variables</li>
</ul></li>
</ul>
</section>
<section id="discovery-process" class="level3">
<h3 class="anchored" data-anchor-id="discovery-process">2. Discovery Process</h3>
<p>The discovery happens in <code>ToolManager._integrate_mcp()</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> _integrate_mcp_async(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        http_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        stdio_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> srv <span class="kw">in</span> <span class="va">self</span>._config.mcp_servers:</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">match</span> srv.transport:</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="st">"http"</span> <span class="op">|</span> <span class="st">"streamable-http"</span>:</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                    http_count <span class="op">+=</span> <span class="cf">await</span> <span class="va">self</span>._register_http_server(srv)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> <span class="st">"stdio"</span>:</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                    stdio_count <span class="op">+=</span> <span class="cf">await</span> <span class="va">self</span>._register_stdio_server(srv)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">case</span> _:</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                    logger.warning(<span class="st">"Unsupported MCP transport: </span><span class="sc">%r</span><span class="st">"</span>, srv.transport)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        logger.info(</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MCP integration registered </span><span class="sc">%d</span><span class="st"> tools (http=</span><span class="sc">%d</span><span class="st">, stdio=</span><span class="sc">%d</span><span class="st">)"</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>            http_count <span class="op">+</span> stdio_count,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>            http_count,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>            stdio_count,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> exc:</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        logger.warning(<span class="st">"Failed to integrate MCP tools: </span><span class="sc">%s</span><span class="st">"</span>, exc)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>For HTTP/Streamable HTTP servers:</strong> 1. Connect to the server URL with optional headers 2. Initialize the MCP client session 3. Call <code>session.list_tools()</code> to get available tools 4. For each remote tool, create a proxy class using <code>create_mcp_http_proxy_tool_class()</code></p>
<p><strong>For Stdio servers:</strong> 1. Start the subprocess with the configured command 2. Initialize the MCP client session 3. Call <code>session.list_tools()</code> to get available tools 4. For each remote tool, create a proxy class using <code>create_mcp_stdio_proxy_tool_class()</code></p>
</section>
<section id="proxy-tool-creation" class="level3">
<h3 class="anchored" data-anchor-id="proxy-tool-creation">3. Proxy Tool Creation</h3>
<p>Two factory functions create proxy tool classes:</p>
<section id="create_mcp_http_proxy_tool_class" class="level4">
<h4 class="anchored" data-anchor-id="create_mcp_http_proxy_tool_class"><code>create_mcp_http_proxy_tool_class()</code></h4>
<p>Creates a <code>BaseTool</code> subclass that wraps an HTTP MCP tool:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_mcp_http_proxy_tool_class(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    url: <span class="bu">str</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    remote: RemoteTool,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    alias: <span class="bu">str</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    server_hint: <span class="bu">str</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    headers: <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    startup_timeout_sec: <span class="bu">float</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    tool_timeout_sec: <span class="bu">float</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">type</span>[BaseTool[_OpenArgs, MCPToolResult, BaseToolConfig, BaseToolState]]:</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Key features:</strong> - Generates a unique tool name: <code>{alias}_{remote.name}</code> or <code>{host}_{port}_{remote.name}</code> - Stores connection parameters as class variables - Implements <code>run()</code> to call the remote tool via HTTP - Returns <code>MCPToolResult</code> containing the tool execution result - Provides custom display methods for UI integration</p>
</section>
<section id="create_mcp_stdio_proxy_tool_class" class="level4">
<h4 class="anchored" data-anchor-id="create_mcp_stdio_proxy_tool_class"><code>create_mcp_stdio_proxy_tool_class()</code></h4>
<p>Creates a <code>BaseTool</code> subclass that wraps a stdio MCP tool:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_mcp_stdio_proxy_tool_class(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    command: <span class="bu">list</span>[<span class="bu">str</span>],</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    remote: RemoteTool,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    alias: <span class="bu">str</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    server_hint: <span class="bu">str</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    env: <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    startup_timeout_sec: <span class="bu">float</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    tool_timeout_sec: <span class="bu">float</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">type</span>[BaseTool[_OpenArgs, MCPToolResult, BaseToolConfig, BaseToolState]]:</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Key features:</strong> - Generates a unique tool name using command hash for stability - Stores command and environment as class variables - Implements <code>run()</code> to call the remote tool via stdio - Returns <code>MCPToolResult</code> containing the tool execution result - Provides custom display methods for UI integration</p>
</section>
</section>
<section id="tool-execution-flow-1" class="level3">
<h3 class="anchored" data-anchor-id="tool-execution-flow-1">4. Tool Execution Flow</h3>
<p>When an MCP proxy tool is invoked:</p>
<ol type="1">
<li><strong>Argument Validation</strong>: Input is validated against the remote tool’s schema</li>
<li><strong>Connection Setup</strong>: HTTP connection or stdio subprocess is established</li>
<li><strong>Tool Call</strong>: The remote tool is called with the provided arguments</li>
<li><strong>Result Parsing</strong>: The MCP response is parsed into <code>MCPToolResult</code></li>
<li><strong>Result Yielding</strong>: The result is yielded as an async generator</li>
</ol>
</section>
<section id="result-handling" class="level3">
<h3 class="anchored" data-anchor-id="result-handling">5. Result Handling</h3>
<p>The <code>MCPToolResult</code> model contains: - <code>ok</code>: Boolean indicating success - <code>server</code>: Server identifier (URL or command) - <code>tool</code>: Tool name - <code>text</code>: Text content (if any) - <code>structured</code>: Structured content (if any)</p>
<p>Results are displayed in the UI with custom <code>get_call_display()</code> and <code>get_result_display()</code> methods.</p>
</section>
<section id="error-handling" class="level3">
<h3 class="anchored" data-anchor-id="error-handling">6. Error Handling</h3>
<ul>
<li>Connection timeouts are handled via <code>startup_timeout_sec</code> and <code>tool_timeout_sec</code></li>
<li>Failed calls raise <code>ToolError</code> with descriptive messages</li>
<li>Discovery failures are logged but don’t crash the system</li>
<li>Individual tool registration failures are logged and skipped</li>
</ul>
</section>
<section id="integration-points" class="level3">
<h3 class="anchored" data-anchor-id="integration-points">7. Integration Points</h3>
<p>MCP tools are fully integrated into the tool system: - Discovered tools are added to <code>ToolManager._available</code> - Can be enabled/disabled via <code>enabled_tools</code>/<code>disabled_tools</code> config - Respect the same permission model as built-in tools - Use the same configuration and state management - Appear in tool listings and autocompletion</p>
<p>This architecture allows seamless integration of external MCP servers as first-class tools in the Vibe system, with proper type safety, error handling, and UI integration.</p>
</section>
</section>
<section id="web-search-not-activated" class="level2">
<h2 class="anchored" data-anchor-id="web-search-not-activated">Web search not activated</h2>
<p>Usage of <code>extra_headers</code> Parameter in LLM Calls</p>
<p>The <code>extra_headers</code> parameter is used in three places in the agent loop to pass additional HTTP headers to the LLM provider:</p>
<section id="non-streaming-completion-_chat-method-line-575-580" class="level3">
<h3 class="anchored" data-anchor-id="non-streaming-completion-_chat-method-line-575-580">1. Non-Streaming Completion (<code>_chat()</code> method, line 575-580)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="cf">await</span> backend.complete(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>active_model,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    messages<span class="op">=</span><span class="va">self</span>.messages,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span>active_model.temperature,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    tools<span class="op">=</span>available_tools,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    tool_choice<span class="op">=</span>tool_choice,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    extra_headers<span class="op">=</span>{</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"user-agent"</span>: get_user_agent(provider.backend),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"x-affinity"</span>: <span class="va">self</span>.session_id,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    max_tokens<span class="op">=</span>max_tokens,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="streaming-completion-_chat_streaming-method-line-619-624" class="level3">
<h3 class="anchored" data-anchor-id="streaming-completion-_chat_streaming-method-line-619-624">2. Streaming Completion (<code>_chat_streaming()</code> method, line 619-624)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="cf">for</span> chunk <span class="kw">in</span> backend.complete_streaming(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>active_model,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    messages<span class="op">=</span><span class="va">self</span>.messages,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span>active_model.temperature,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    tools<span class="op">=</span>available_tools,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    tool_choice<span class="op">=</span>tool_choice,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    extra_headers<span class="op">=</span>{</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"user-agent"</span>: get_user_agent(provider.backend),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"x-affinity"</span>: <span class="va">self</span>.session_id,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    max_tokens<span class="op">=</span>max_tokens,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>):</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="token-counting-_compact_session-method-line-843" class="level3">
<h3 class="anchored" data-anchor-id="token-counting-_compact_session-method-line-843">3. Token Counting (<code>_compact_session()</code> method, line 843)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>actual_context_tokens <span class="op">=</span> <span class="cf">await</span> backend.count_tokens(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>active_model,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    messages<span class="op">=</span><span class="va">self</span>.messages,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    tools<span class="op">=</span><span class="va">self</span>.format_handler.get_available_tools(<span class="va">self</span>.tool_manager),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    extra_headers<span class="op">=</span>{<span class="st">"user-agent"</span>: get_user_agent(provider.backend)},</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="current-headers" class="level3">
<h3 class="anchored" data-anchor-id="current-headers">Current Headers</h3>
<p>The system currently sends two headers: 1. <strong><code>user-agent</code></strong>: Identifies the client as “Mistral-Vibe” with version info 2. <strong><code>x-affinity</code></strong>: Contains the session ID for request correlation</p>
</section>
<section id="how-to-extend-for-web-search" class="level3">
<h3 class="anchored" data-anchor-id="how-to-extend-for-web-search">How to Extend for Web Search</h3>
<p>To enable web search capabilities, additional headers could be added to <code>extra_headers</code>. For example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>extra_headers<span class="op">=</span>{</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"user-agent"</span>: get_user_agent(provider.backend),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"x-affinity"</span>: <span class="va">self</span>.session_id,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X-Web-Search"</span>: <span class="st">"enabled"</span>,  <span class="co"># Provider-specific web search header</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X-Web-Search-Model"</span>: <span class="st">"web-search-preview"</span>,  <span class="co"># Specific model for web search</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="implementation-approach" class="level3">
<h3 class="anchored" data-anchor-id="implementation-approach">Implementation Approach</h3>
<p>The architecture allows for web search to be enabled by: 1. Adding provider-specific headers through the <code>extra_headers</code> parameter 2. These headers are passed to the backend (GenericBackend or MistralBackend) 3. The backend includes them in the HTTP request to the provider 4. The provider handles the web search internally and returns results</p>
<p>This mechanism provides a clean way to enable provider-specific capabilities like web search without modifying the core tool system.</p>
</section>
</section>
<section id="mistral-vibe-concepts" class="level2">
<h2 class="anchored" data-anchor-id="mistral-vibe-concepts">Mistral vibe concepts</h2>
<section id="agents" class="level3">
<h3 class="anchored" data-anchor-id="agents">1. <strong>Agents</strong></h3>
<ul>
<li>Main entities that interact with users</li>
<li>Have profiles defining behavior, safety level, and tool permissions</li>
<li>Built-in agents: <code>default</code>, <code>plan</code>, <code>accept-edits</code>, <code>auto-approve</code>, <code>explore</code></li>
<li>Safety levels: SAFE, NEUTRAL, DESTRUCTIVE, YOLO</li>
</ul>
</section>
<section id="subagents" class="level3">
<h3 class="anchored" data-anchor-id="subagents">2. <strong>Subagents</strong></h3>
<ul>
<li>Specialized agents for task delegation</li>
<li>Run independently to prevent context overload</li>
<li>Invoked using the <code>task</code> tool</li>
<li>Can be created by setting <code>agent_type = "subagent"</code></li>
</ul>
</section>
<section id="skills" class="level3">
<h3 class="anchored" data-anchor-id="skills">3. <strong>Skills</strong></h3>
<ul>
<li>Reusable components that extend functionality</li>
<li>Defined in directories with <code>SKILL.md</code> files</li>
<li>Support metadata like name, description, allowed tools</li>
<li>Discovered from multiple paths (global, local, custom)</li>
</ul>
</section>
<section id="relationship-between-components" class="level3">
<h3 class="anchored" data-anchor-id="relationship-between-components">4. <strong>Relationship Between Components</strong></h3>
<ul>
<li><strong>Agents</strong> define which tools are available and their permissions</li>
<li><strong>Skills</strong> can add new tools or modify behavior (experimental)</li>
<li><strong>Tools</strong> are the actual implementations that perform actions</li>
<li><strong>Subagents</strong> are specialized agents for delegation</li>
</ul>
</section>
<section id="personalization-files" class="level3">
<h3 class="anchored" data-anchor-id="personalization-files">5. <strong>Personalization Files</strong></h3>
<p>Users can create these files to customize Mistral Vibe:</p>
<ol type="1">
<li><strong>Agent Configuration Files</strong> (<code>~/.vibe/agents/*.toml</code>)</li>
<li><strong>Skill Definition Files</strong> (<code>~/.vibe/skills/*/SKILL.md</code>)</li>
<li><strong>Tool Definition Files</strong> (<code>~/.vibe/tools/*.py</code>)</li>
<li><strong>System Prompt Files</strong> (<code>~/.vibe/prompts/*.md</code>)</li>
<li><strong>Main Configuration File</strong> (<code>~/.vibe/config.toml</code>)</li>
</ol>
</section>
<section id="configuration" class="level3">
<h3 class="anchored" data-anchor-id="configuration">6. <strong>Configuration</strong></h3>
<ul>
<li>Supports pattern matching (exact names, globs, regex)</li>
<li>Configuration inheritance: defaults → global config → project config → agent overrides</li>
<li>Tool permissions: <code>always</code>, <code>never</code>, <code>ask</code></li>
</ul>
<p>The document provides step-by-step guides for creating custom agents, skills, and tools, along with complete examples.</p>
</section>
</section>
<section id="files-users-can-create-for-personalization" class="level2">
<h2 class="anchored" data-anchor-id="files-users-can-create-for-personalization">Files Users Can Create for Personalization</h2>
<section id="agent-configuration-files-.toml" class="level3">
<h3 class="anchored" data-anchor-id="agent-configuration-files-.toml">1. <strong>Agent Configuration Files</strong> (<code>.toml</code>)</h3>
<ul>
<li><strong>Location</strong>: <code>~/.vibe/agents/</code> or <code>.vibe/agents/</code> (project-specific)</li>
<li><strong>Purpose</strong>: Define custom agent profiles with specific tool permissions</li>
<li><strong>Format</strong>: TOML with agent metadata and overrides</li>
</ul>
</section>
<section id="skill-definition-files-skill.md" class="level3">
<h3 class="anchored" data-anchor-id="skill-definition-files-skill.md">2. <strong>Skill Definition Files</strong> (<code>SKILL.md</code>)</h3>
<ul>
<li><strong>Location</strong>: <code>~/.vibe/skills/*/SKILL.md</code> or <code>.vibe/skills/*/SKILL.md</code></li>
<li><strong>Purpose</strong>: Define reusable skills with metadata</li>
<li><strong>Format</strong>: Markdown with YAML frontmatter</li>
</ul>
</section>
<section id="tool-definition-files-.py" class="level3">
<h3 class="anchored" data-anchor-id="tool-definition-files-.py">3. <strong>Tool Definition Files</strong> (<code>.py</code>)</h3>
<ul>
<li><strong>Location</strong>: <code>~/.vibe/tools/</code> or <code>.vibe/tools/</code> (project-specific)</li>
<li><strong>Purpose</strong>: Create custom tools by extending <code>BaseTool</code></li>
<li><strong>Format</strong>: Python files with async methods</li>
</ul>
</section>
<section id="system-prompt-files-.md" class="level3">
<h3 class="anchored" data-anchor-id="system-prompt-files-.md">4. <strong>System Prompt Files</strong> (<code>.md</code>)</h3>
<ul>
<li><strong>Location</strong>: <code>~/.vibe/prompts/</code></li>
<li><strong>Purpose</strong>: Customize the system prompt for different use cases</li>
<li><strong>Format</strong>: Markdown files</li>
</ul>
</section>
<section id="main-configuration-file-config.toml" class="level3">
<h3 class="anchored" data-anchor-id="main-configuration-file-config.toml">5. <strong>Main Configuration File</strong> (<code>config.toml</code>)</h3>
<ul>
<li><strong>Location</strong>: <code>~/.vibe/config.toml</code> or <code>.vibe/config.toml</code></li>
<li><strong>Purpose</strong>: Global configuration for agents, skills, tools, and MCP servers</li>
<li><strong>Format</strong>: TOML</li>
</ul>
</section>
<section id="documentation-files-optional" class="level3">
<h3 class="anchored" data-anchor-id="documentation-files-optional">6. <strong>Documentation Files</strong> (Optional)</h3>
<p>While not required by the system, users can create: - <code>AGENTS.md</code> - Documentation for custom agents - <code>SKILLS.md</code> - Documentation for custom skills - <code>TOOLS.md</code> - Documentation for custom tools - <code>README.md</code> - Project-specific documentation</p>
<p>These documentation files would be in the project’s <code>.vibe/</code> directory and serve as reference material for team members or future maintainers.</p>
<p>The comprehensive document I created (<code>mistral-vibe-agents-skills-personalization.md</code>) explains all of this in detail with examples and step-by-step guides.</p>
</section>
</section>
<section id="mistral-vibe-agents-skills-subagents-and-personalization" class="level2">
<h2 class="anchored" data-anchor-id="mistral-vibe-agents-skills-subagents-and-personalization">Mistral Vibe: Agents, Skills, Subagents, and Personalization</h2>
<p>This document explains the core concepts of agents, skills, subagents in Mistral Vibe, how they relate to each other and to tools, and how users can personalize their Vibe experience.</p>
<ol type="1">
<li><a href="#agents">Agents</a></li>
<li><a href="#subagents">Subagents</a></li>
<li><a href="#skills">Skills</a></li>
<li><a href="#relationship-between-agents-skills-and-tools">Relationship Between Agents, Skills, and Tools</a></li>
<li><a href="#personalization-files">Personalization Files</a></li>
<li><a href="#creating-custom-agents">Creating Custom Agents</a></li>
<li><a href="#creating-custom-skills">Creating Custom Skills</a></li>
<li><a href="#creating-custom-tools">Creating Custom Tools</a></li>
<li><a href="#configuration-overview">Configuration Overview</a></li>
</ol>
</section>
<section id="agents-1" class="level2">
<h2 class="anchored" data-anchor-id="agents-1">Agents</h2>
<p><strong>Agents</strong> are the main entities that interact with users and execute tasks. Each agent has a profile that defines its behavior, safety level, and tool permissions.</p>
<section id="agent-profile-structure" class="level3">
<h3 class="anchored" data-anchor-id="agent-profile-structure">Agent Profile Structure</h3>
<p>An agent profile consists of: - <strong>Name</strong>: Unique identifier for the agent - <strong>Display Name</strong>: Human-readable name - <strong>Description</strong>: What the agent does - <strong>Safety Level</strong>: One of SAFE, NEUTRAL, DESTRUCTIVE, or YOLO - <strong>Agent Type</strong>: AGENT (primary) or SUBAGENT (for delegation) - <strong>Overrides</strong>: Configuration overrides (tools, permissions, etc.)</p>
</section>
<section id="built-in-agents" class="level3">
<h3 class="anchored" data-anchor-id="built-in-agents">Built-in Agents</h3>
<p>Mistral Vibe comes with several built-in agents:</p>
<ol type="1">
<li><strong><code>default</code></strong> - Standard agent requiring approval for tool executions</li>
<li><strong><code>plan</code></strong> - Read-only agent for exploration and planning (auto-approves safe tools)</li>
<li><strong><code>accept-edits</code></strong> - Auto-approves file edits only</li>
<li><strong><code>auto-approve</code></strong> - Auto-approves all tool executions (use with caution)</li>
<li><strong><code>explore</code></strong> - Read-only subagent for codebase exploration</li>
</ol>
</section>
<section id="agent-safety-levels" class="level3">
<h3 class="anchored" data-anchor-id="agent-safety-levels">Agent Safety Levels</h3>
<ul>
<li><strong>SAFE</strong>: Read-only operations, no destructive actions</li>
<li><strong>NEUTRAL</strong>: Default level, requires approval for most actions</li>
<li><strong>DESTRUCTIVE</strong>: Can modify files but with restrictions</li>
<li><strong>YOLO</strong>: No restrictions, auto-approves everything</li>
</ul>
</section>
<section id="using-agents" class="level3">
<h3 class="anchored" data-anchor-id="using-agents">Using Agents</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vibe</span> <span class="at">--agent</span> plan</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="ex">vibe</span> <span class="at">--agent</span> auto-approve</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="subagents-1" class="level2">
<h2 class="anchored" data-anchor-id="subagents-1">Subagents</h2>
<p><strong>Subagents</strong> are specialized agents designed for task delegation. They run independently and can perform work without user interaction, preventing context overload.</p>
<section id="key-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="key-characteristics">Key Characteristics</h3>
<ul>
<li>Run in parallel with the main agent</li>
<li>Have their own configuration and tool permissions</li>
<li>Can be invoked using the <code>task</code> tool</li>
<li>Useful for long-running or specialized tasks</li>
</ul>
</section>
<section id="example-delegating-to-a-subagent" class="level3">
<h3 class="anchored" data-anchor-id="example-delegating-to-a-subagent">Example: Delegating to a Subagent</h3>
<pre><code>&gt; Can you explore the codebase structure while I work on something else?

🤖 I'll use the task tool to delegate this to the explore subagent.

&gt; task(task="Analyze the project structure and architecture", agent="explore")</code></pre>
</section>
<section id="creating-custom-subagents" class="level3">
<h3 class="anchored" data-anchor-id="creating-custom-subagents">Creating Custom Subagents</h3>
<p>To create a custom subagent, add <code>agent_type = "subagent"</code> to your agent configuration:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/agents/my-subagent.toml</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"my-subagent"</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="dt">display_name</span> <span class="op">=</span> <span class="st">"My Subagent"</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="dt">description</span> <span class="op">=</span> <span class="st">"Specialized subagent for my tasks"</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="dt">safety</span> <span class="op">=</span> <span class="st">"safe"</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="dt">agent_type</span> <span class="op">=</span> <span class="st">"subagent"</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.read_file]</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.grep]</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="skills-1" class="level2">
<h2 class="anchored" data-anchor-id="skills-1">Skills</h2>
<p><strong>Skills</strong> are reusable components that extend Vibe’s functionality. They can add new tools, slash commands, and specialized behaviors.</p>
<section id="skill-structure" class="level3">
<h3 class="anchored" data-anchor-id="skill-structure">Skill Structure</h3>
<p>Skills are defined in directories with a <code>SKILL.md</code> file containing YAML frontmatter:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> code-review</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> Perform automated code reviews</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="an">license:</span><span class="co"> MIT</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="an">compatibility:</span><span class="co"> Python 3.12+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="an">user-invocable:</span><span class="co"> true</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="an">allowed-tools:</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - read_file</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - grep</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - ask_user_question</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code Review Skill</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>This skill helps analyze code quality and suggest improvements.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="skill-metadata-fields" class="level3">
<h3 class="anchored" data-anchor-id="skill-metadata-fields">Skill Metadata Fields</h3>
<ul>
<li><strong>name</strong>: Skill identifier (lowercase, hyphens only)</li>
<li><strong>description</strong>: What the skill does</li>
<li><strong>license</strong>: License name or reference</li>
<li><strong>compatibility</strong>: Environment requirements</li>
<li><strong>metadata</strong>: Arbitrary key-value pairs</li>
<li><strong>allowed-tools</strong>: Pre-approved tools (experimental)</li>
<li><strong>user-invocable</strong>: Whether the skill appears in slash command menu</li>
</ul>
</section>
<section id="skill-discovery-paths" class="level3">
<h3 class="anchored" data-anchor-id="skill-discovery-paths">Skill Discovery Paths</h3>
<p>Vibe discovers skills from: 1. <strong>Global skills directory</strong>: <code>~/.vibe/skills/</code> 2. <strong>Local project skills</strong>: <code>.vibe/skills/</code> in your project 3. <strong>Custom paths</strong>: Configured in <code>config.toml</code></p>
</section>
<section id="managing-skills" class="level3">
<h3 class="anchored" data-anchor-id="managing-skills">Managing Skills</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable specific skills</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled_skills</span> <span class="op">=</span> <span class="op">[</span><span class="st">"code-review"</span><span class="op">,</span> <span class="st">"test-*"</span><span class="op">]</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Disable specific skills</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="dt">disabled_skills</span> <span class="op">=</span> <span class="op">[</span><span class="st">"experimental-*"</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="relationship-between-agents-skills-and-tools" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-agents-skills-and-tools">Relationship Between Agents, Skills, and Tools</h2>
<section id="the-architecture" class="level3">
<h3 class="anchored" data-anchor-id="the-architecture">The Architecture</h3>
<pre><code>┌───────────────────────────────────────────────────────────────┐
│                        User Interface                         │
└───────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌───────────────────────────────────────────────────────────────┐
│                        Agent Manager                          │
│  - Manages agent profiles (built-in + custom)                 │
│  - Handles agent switching and configuration                  │
└───────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌───────────────────────────────────────────────────────────────┐
│                        Skill Manager                          │
│  - Discovers and loads skills from multiple paths             │
│  - Manages skill enable/disable patterns                      │
└───────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌───────────────────────────────────────────────────────────────┐
│                        Tool Manager                           │
│  - Discovers built-in and custom tools                       │
│  - Integrates MCP servers as tools                            │
│  - Manages tool configuration and permissions                  │
└───────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌───────────────────────────────────────────────────────────────┐
│                        LLM Backend                            │
│  - Executes agent conversations                               │
│  - Handles tool calls and responses                            │
└───────────────────────────────────────────────────────────────┘</code></pre>
</section>
<section id="how-they-work-together" class="level3">
<h3 class="anchored" data-anchor-id="how-they-work-together">How They Work Together</h3>
<ol type="1">
<li><strong>Agent</strong> defines which tools are available and their permissions</li>
<li><strong>Skills</strong> can add new tools or modify behavior (experimental)</li>
<li><strong>Tools</strong> are the actual implementations that perform actions</li>
<li><strong>Subagents</strong> are specialized agents that can be delegated to</li>
</ol>
</section>
<section id="tool-permissions" class="level3">
<h3 class="anchored" data-anchor-id="tool-permissions">Tool Permissions</h3>
<p>Each tool can have different permission levels: - <strong>always</strong>: Auto-approved, no user confirmation - <strong>never</strong>: Disabled for this agent - <strong>ask</strong>: Requires user approval (default)</p>
<p>Example agent configuration with tool permissions:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.write_file]</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.bash]</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"ask"</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.search_replace]</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"never"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="personalization-files-1" class="level2">
<h2 class="anchored" data-anchor-id="personalization-files-1">Personalization Files</h2>
<p>Users can personalize Mistral Vibe by creating files in specific directories:</p>
<section id="agent-configuration-files" class="level3">
<h3 class="anchored" data-anchor-id="agent-configuration-files">1. Agent Configuration Files</h3>
<p><strong>Location</strong>: <code>~/.vibe/agents/</code> or <code>.vibe/agents/</code> (project-specific)</p>
<p><strong>Format</strong>: TOML files with <code>.toml</code> extension</p>
<p><strong>Example</strong>: <code>~/.vibe/agents/my-agent.toml</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"my-agent"</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="dt">display_name</span> <span class="op">=</span> <span class="st">"My Custom Agent"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="dt">description</span> <span class="op">=</span> <span class="st">"Agent configured for my specific needs"</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="dt">safety</span> <span class="op">=</span> <span class="st">"neutral"</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Override global configuration</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="dt">active_model</span> <span class="op">=</span> <span class="st">"devstral-2"</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"cli"</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tool-specific configuration</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.bash]</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.write_file]</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"ask"</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.read_file]</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="skill-definition-files" class="level3">
<h3 class="anchored" data-anchor-id="skill-definition-files">2. Skill Definition Files</h3>
<p><strong>Location</strong>: <code>~/.vibe/skills/</code> or <code>.vibe/skills/</code> (project-specific)</p>
<p><strong>Format</strong>: Directories with <code>SKILL.md</code> file</p>
<p><strong>Example</strong>: <code>~/.vibe/skills/my-skill/SKILL.md</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> my-skill</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> My custom skill for specialized tasks</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="an">license:</span><span class="co"> MIT</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="an">compatibility:</span><span class="co"> Python 3.12+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="an">user-invocable:</span><span class="co"> true</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="an">allowed-tools:</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - read_file</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - grep</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu"># My Skill Documentation</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>This skill provides custom functionality for my workflow.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="tool-definition-files" class="level3">
<h3 class="anchored" data-anchor-id="tool-definition-files">3. Tool Definition Files</h3>
<p><strong>Location</strong>: <code>~/.vibe/tools/</code> or <code>.vibe/tools/</code> (project-specific)</p>
<p><strong>Format</strong>: Python files with <code>BaseTool</code> subclasses</p>
<p><strong>Example</strong>: <code>~/.vibe/tools/my_tool.py</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vibe.core.tools.base <span class="im">import</span> BaseTool, BaseToolConfig</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyToolConfig(BaseToolConfig):</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    my_option: <span class="bu">str</span> <span class="op">=</span> <span class="st">"default"</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyTool(BaseTool[MyToolConfig]):</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_name(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"my_tool"</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_description(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"My custom tool that does something useful"</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> run(<span class="va">self</span>, my_option: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Run the tool with the given option."""</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Tool executed with option: </span><span class="sc">{</span>my_option<span class="sc">}</span><span class="ss">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="system-prompt-files" class="level3">
<h3 class="anchored" data-anchor-id="system-prompt-files">4. System Prompt Files</h3>
<p><strong>Location</strong>: <code>~/.vibe/prompts/</code></p>
<p><strong>Format</strong>: Markdown files with <code>.md</code> extension</p>
<p><strong>Example</strong>: <code>~/.vibe/prompts/my-prompt.md</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Custom System Prompt</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>You are a helpful coding assistant...</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then reference it in config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"my-prompt"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="configuration-file" class="level3">
<h3 class="anchored" data-anchor-id="configuration-file">5. Configuration File</h3>
<p><strong>Location</strong>: <code>~/.vibe/config.toml</code> or <code>.vibe/config.toml</code> (project-specific)</p>
<p><strong>Format</strong>: TOML</p>
<p><strong>Example</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="dt">active_model</span> <span class="op">=</span> <span class="st">"devstral-2"</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="dt">textual_theme</span> <span class="op">=</span> <span class="st">"terminal"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="dt">auto_approve</span> <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Agent paths</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="dt">agent_paths</span> <span class="op">=</span> <span class="op">[</span><span class="st">"/path/to/custom/agents"</span><span class="op">]</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Skill paths</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="dt">skill_paths</span> <span class="op">=</span> <span class="op">[</span><span class="st">"/path/to/custom/skills"</span><span class="op">]</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tool paths</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="dt">tool_paths</span> <span class="op">=</span> <span class="op">[</span><span class="st">"/path/to/custom/tools"</span><span class="op">]</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable/disable specific agents</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled_agents</span> <span class="op">=</span> <span class="op">[</span><span class="st">"default"</span><span class="op">,</span> <span class="st">"plan"</span><span class="op">]</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="dt">disabled_agents</span> <span class="op">=</span> <span class="op">[</span><span class="st">"auto-approve"</span><span class="op">]</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable/disable specific skills</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled_skills</span> <span class="op">=</span> <span class="op">[</span><span class="st">"code-review"</span><span class="op">]</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="dt">disabled_skills</span> <span class="op">=</span> <span class="op">[</span><span class="st">"experimental-*"</span><span class="op">]</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable/disable specific tools</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled_tools</span> <span class="op">=</span> <span class="op">[</span><span class="st">"read_file"</span><span class="op">,</span> <span class="st">"grep"</span><span class="op">,</span> <span class="st">"bash"</span><span class="op">]</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="dt">disabled_tools</span> <span class="op">=</span> <span class="op">[</span><span class="st">"write_file"</span><span class="op">,</span> <span class="st">"search_replace"</span><span class="op">]</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co"># MCP server configuration</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="kw">[[mcp_servers]]</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"my_server"</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="dt">transport</span> <span class="op">=</span> <span class="st">"http"</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="dt">url</span> <span class="op">=</span> <span class="st">"http://localhost:8000"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="creating-custom-agents" class="level2">
<h2 class="anchored" data-anchor-id="creating-custom-agents">Creating Custom Agents</h2>
<section id="step-by-step-guide" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-guide">Step-by-Step Guide</h3>
<ol type="1">
<li><strong>Create a new TOML file</strong> in <code>~/.vibe/agents/</code> or <code>.vibe/agents/</code></li>
<li><strong>Define the agent profile</strong> with name, description, and safety level</li>
<li><strong>Configure tool permissions</strong> as needed</li>
<li><strong>Use the agent</strong> with the <code>--agent</code> flag</li>
</ol>
</section>
<section id="example-creating-a-review-agent" class="level3">
<h3 class="anchored" data-anchor-id="example-creating-a-review-agent">Example: Creating a Review Agent</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/agents/reviewer.toml</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reviewer"</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="dt">display_name</span> <span class="op">=</span> <span class="st">"Code Reviewer"</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="dt">description</span> <span class="op">=</span> <span class="st">"Specialized agent for code reviews"</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="dt">safety</span> <span class="op">=</span> <span class="st">"safe"</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Only allow read operations</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.read_file]</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.grep]</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.bash]</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"never"</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.write_file]</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"never"</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.search_replace]</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"never"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="using-the-custom-agent" class="level3">
<h3 class="anchored" data-anchor-id="using-the-custom-agent">Using the Custom Agent</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vibe</span> <span class="at">--agent</span> reviewer</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="creating-custom-skills" class="level2">
<h2 class="anchored" data-anchor-id="creating-custom-skills">Creating Custom Skills</h2>
<section id="step-by-step-guide-1" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-guide-1">Step-by-Step Guide</h3>
<ol type="1">
<li><strong>Create a directory</strong> for your skill in <code>~/.vibe/skills/</code> or <code>.vibe/skills/</code></li>
<li><strong>Create a <code>SKILL.md</code> file</strong> with YAML frontmatter</li>
<li><strong>Document the skill</strong> in markdown format</li>
<li><strong>Enable the skill</strong> in your configuration (if needed)</li>
</ol>
</section>
<section id="example-creating-a-documentation-skill" class="level3">
<h3 class="anchored" data-anchor-id="example-creating-a-documentation-skill">Example: Creating a Documentation Skill</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># ~/.vibe/skills/documentation/SKILL.md</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>name: documentation</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>description: Generate and maintain project documentation</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>description: MIT</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>compatibility: Python 3.12+</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>user-invocable: true</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>allowed-tools:</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>read_file</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>grep</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>write_file</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># Documentation Skill</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>This skill helps generate and maintain project documentation by analyzing</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>code structure and creating comprehensive docs.</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Features</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analyze code structure</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generate API documentation</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create README files</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Update documentation based on code changes</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="creating-custom-tools" class="level2">
<h2 class="anchored" data-anchor-id="creating-custom-tools">Creating Custom Tools</h2>
<section id="step-by-step-guide-2" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-guide-2">Step-by-Step Guide</h3>
<ol type="1">
<li><strong>Create a Python file</strong> in <code>~/.vibe/tools/</code> or <code>.vibe/tools/</code></li>
<li><strong>Define a class</strong> that extends <code>BaseTool</code></li>
<li><strong>Implement the <code>run</code> method</strong> asynchronously</li>
<li><strong>Configure tool permissions</strong> in your agent profile</li>
</ol>
</section>
<section id="example-creating-a-custom-tool" class="level3">
<h3 class="anchored" data-anchor-id="example-creating-a-custom-tool">Example: Creating a Custom Tool</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/tools/project_stats.py</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vibe.core.tools.base <span class="im">import</span> BaseTool, BaseToolConfig</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProjectStatsConfig(BaseToolConfig):</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    include_hidden: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    max_depth: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProjectStats(BaseTool[ProjectStatsConfig]):</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_name(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"project_stats"</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_description(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Generate statistics about the project structure"</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> run(</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, </span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>        include_hidden: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>        max_depth: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate project statistics."""</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        base_path <span class="op">=</span> Path.cwd()</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Count files and directories</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>        files <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>        dirs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> path <span class="kw">in</span> base_path.rglob(<span class="st">"*"</span>):</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> path.is_file():</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                files <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> path.is_dir():</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>                dirs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Apply filters</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> path.name.startswith(<span class="st">"."</span>) <span class="kw">and</span> <span class="kw">not</span> include_hidden:</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Project Statistics:</span><span class="ch">\n</span><span class="ss">- Files: </span><span class="sc">{</span>files<span class="sc">}</span><span class="ch">\n</span><span class="ss">- Directories: </span><span class="sc">{</span>dirs<span class="sc">}</span><span class="ss">"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="using-the-custom-tool" class="level3">
<h3 class="anchored" data-anchor-id="using-the-custom-tool">Using the Custom Tool</h3>
<p>Once created, the tool will be automatically discovered and available to agents:</p>
<pre><code>&gt; project_stats()</code></pre>
</section>
</section>
<section id="configuration-overview" class="level2">
<h2 class="anchored" data-anchor-id="configuration-overview">Configuration Overview</h2>
<section id="configuration-file-structure" class="level3">
<h3 class="anchored" data-anchor-id="configuration-file-structure">Configuration File Structure</h3>
<p>The main configuration file (<code>config.toml</code>) controls:</p>
<ol type="1">
<li><strong>Global Settings</strong>: Model, theme, behavior</li>
<li><strong>Agent Management</strong>: Paths, enable/disable patterns</li>
<li><strong>Skill Management</strong>: Paths, enable/disable patterns</li>
<li><strong>Tool Management</strong>: Paths, enable/disable patterns, permissions</li>
<li><strong>MCP Server Configuration</strong>: HTTP and stdio servers</li>
<li><strong>Session Management</strong>: Logging, save directory</li>
</ol>
</section>
<section id="configuration-inheritance" class="level3">
<h3 class="anchored" data-anchor-id="configuration-inheritance">Configuration Inheritance</h3>
<p>Configuration follows this inheritance order (later overrides earlier):</p>
<ol type="1">
<li>Default values (built into Vibe)</li>
<li>Global config (<code>~/.vibe/config.toml</code>)</li>
<li>Project config (<code>.vibe/config.toml</code>)</li>
<li>Agent-specific overrides (from agent profile)</li>
</ol>
</section>
<section id="pattern-matching" class="level3">
<h3 class="anchored" data-anchor-id="pattern-matching">Pattern Matching</h3>
<p>Vibe supports three types of patterns for enabling/disabling agents, skills, and tools:</p>
<ol type="1">
<li><strong>Exact names</strong>: <code>"default"</code> matches only “default”</li>
<li><strong>Glob patterns</strong>: <code>"test-*"</code> matches “test-1”, “test-2”, etc.</li>
<li><strong>Regex patterns</strong>: <code>"re:^serena_.*$"</code> matches regex pattern</li>
</ol>
</section>
</section>
<section id="summary-1" class="level2">
<h2 class="anchored" data-anchor-id="summary-1">Summary</h2>
<ul>
<li><strong>Agents</strong> are the main entities that interact with users</li>
<li><strong>Subagents</strong> are specialized agents for task delegation</li>
<li><strong>Skills</strong> extend functionality through reusable components</li>
<li><strong>Tools</strong> are the actual implementations that perform actions</li>
<li><strong>All can be customized</strong> through configuration files and Python code</li>
<li><strong>Configuration</strong> controls which agents, skills, and tools are available</li>
</ul>
<p>This architecture provides a flexible and extensible system for personalizing Mistral Vibe to your specific workflow and needs.</p>
</section>
<section id="prompt-personalization-options-in-mistral-vibe" class="level2">
<h2 class="anchored" data-anchor-id="prompt-personalization-options-in-mistral-vibe">Prompt Personalization Options in Mistral Vibe</h2>
<section id="built-in-prompts" class="level3">
<h3 class="anchored" data-anchor-id="built-in-prompts">1. <strong>Built-in Prompts</strong></h3>
<ul>
<li><strong>System Prompts</strong>: <code>cli</code> (default), <code>tests</code> (minimal)</li>
<li><strong>Utility Prompts</strong>: <code>compact</code> (conversation summaries), <code>project_context</code> (project info), <code>dangerous_directory</code> (security warnings)</li>
</ul>
</section>
<section id="system-prompt-customization" class="level3">
<h3 class="anchored" data-anchor-id="system-prompt-customization">2. <strong>System Prompt Customization</strong></h3>
<ul>
<li><strong>Create custom prompts</strong> in <code>~/.vibe/prompts/</code> or <code>.vibe/prompts/</code> (project-specific)</li>
<li><strong>Reference them</strong> via <code>system_prompt_id</code> in config</li>
<li><strong>Discovery order</strong>: project → global → built-in</li>
</ul>
</section>
<section id="utility-prompt-customization" class="level3">
<h3 class="anchored" data-anchor-id="utility-prompt-customization">3. <strong>Utility Prompt Customization</strong></h3>
<ul>
<li><strong>Project Context Template</strong>: Can be customized with placeholders like <code>{structure}</code>, <code>{abs_path}</code>, <code>{git_status}</code></li>
<li><strong>Dangerous Directory Prompt</strong>: Can be customized for security warnings</li>
</ul>
</section>
<section id="project-context-configuration" class="level3">
<h3 class="anchored" data-anchor-id="project-context-configuration">4. <strong>Project Context Configuration</strong></h3>
<ul>
<li><strong>Configurable parameters</strong>:
<ul>
<li><code>max_chars</code>, <code>max_depth</code>, <code>max_files</code>, <code>max_dirs_per_level</code></li>
<li><code>timeout_seconds</code>, <code>default_commit_count</code>, <code>max_doc_bytes</code></li>
</ul></li>
<li><strong>Automatic documentation loading</strong> from README files</li>
<li><strong>Git status integration</strong> with branch info and recent commits</li>
</ul>
</section>
<section id="session-specific-prompt-control" class="level3">
<h3 class="anchored" data-anchor-id="session-specific-prompt-control">5. <strong>Session-Specific Prompt Control</strong></h3>
<ul>
<li><strong>Include/exclude layers</strong>:
<ul>
<li><code>include_commit_signature</code> - Git commit instructions</li>
<li><code>include_model_info</code> - Model name</li>
<li><code>include_prompt_detail</code> - OS/shell info and tool prompts</li>
<li><code>include_project_context</code> - Project structure and git status</li>
</ul></li>
</ul>
</section>
<section id="advanced-customization" class="level3">
<h3 class="anchored" data-anchor-id="advanced-customization">6. <strong>Advanced Customization</strong></h3>
<ul>
<li><strong>Agent-specific prompts</strong> - Different prompts for different agents</li>
<li><strong>Custom tool prompts</strong> - Override <code>get_tool_prompt()</code> in custom tools</li>
<li><strong>Dynamic content</strong> - Directory structure, git status, skills, subagents</li>
</ul>
</section>
<section id="best-practices" class="level3">
<h3 class="anchored" data-anchor-id="best-practices">7. <strong>Best Practices</strong></h3>
<ul>
<li>Start with built-in prompts and modify incrementally</li>
<li>Keep prompts concise (token limits)</li>
<li>Test changes incrementally</li>
<li>Use multiple prompts for different use cases</li>
<li>Document your custom prompts</li>
</ul>
<p>The document provides complete examples and step-by-step guides for creating custom prompts, configuring project context, and controlling prompt layers for different scenarios.</p>
</section>
</section>
<section id="mistral-vibe-complete-prompt-personalization-guide" class="level1">
<h1>Mistral Vibe: Complete Prompt Personalization Guide</h1>
<ol type="1">
<li><a href="#understanding-the-prompt-system">Understanding the Prompt System</a></li>
<li><a href="#built-in-prompts">Built-in Prompts</a></li>
<li><a href="#system-prompt-customization">System Prompt Customization</a></li>
<li><a href="#utility-prompt-customization">Utility Prompt Customization</a></li>
<li><a href="#project-context-customization">Project Context Customization</a></li>
<li><a href="#session-specific-prompt-control">Session-Specific Prompt Control</a></li>
<li><a href="#advanced-prompt-customization">Advanced Prompt Customization</a></li>
<li><a href="#prompt-variables-and-dynamic-content">Prompt Variables and Dynamic Content</a></li>
<li><a href="#best-practices-for-prompt-customization">Best Practices for Prompt Customization</a></li>
</ol>
<section id="understanding-the-prompt-system" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-prompt-system">Understanding the Prompt System</h2>
<p>Mistral Vibe uses a multi-layered prompt architecture that combines:</p>
<ol type="1">
<li><strong>Base System Prompt</strong> - Defines the agent’s core behavior and guidelines</li>
<li><strong>Utility Prompts</strong> - Contextual information like project structure and git status</li>
<li><strong>Tool Prompts</strong> - Specific instructions for each available tool</li>
<li><strong>Skill Prompts</strong> - Information about available skills</li>
<li><strong>Subagent Prompts</strong> - Information about available subagents</li>
</ol>
<p>The final prompt sent to the LLM is constructed by combining these layers based on configuration settings.</p>
<section id="prompt-construction-flow" class="level3">
<h3 class="anchored" data-anchor-id="prompt-construction-flow">Prompt Construction Flow</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                 System Prompt (Base)                        │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                 Optional Layers                            │
│  - Commit Signature (if enabled)                           │
│  - Model Info (if enabled)                                 │
│  - OS System Prompt (if enabled)                            │
│  - Tool Prompts (if enabled)                                │
│  - Skill Prompts (if enabled)                               │
│  - Subagent Prompts (if enabled)                            │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                 Project Context (if enabled)                │
│  - Directory Structure                                      │
│  - Git Status                                               │
│  - Project Documentation (if available)                     │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                 Final Prompt Sent to LLM                    │
└─────────────────────────────────────────────────────────────┘</code></pre>
</section>
</section>
<section id="built-in-prompts-1" class="level2">
<h2 class="anchored" data-anchor-id="built-in-prompts-1">Built-in Prompts</h2>
<p>Mistral Vibe comes with several built-in prompts:</p>
<section id="system-prompts" class="level3">
<h3 class="anchored" data-anchor-id="system-prompts">System Prompts</h3>
<ol type="1">
<li><strong><code>cli</code></strong> - The default system prompt for CLI interactions (see <code>vibe/core/prompts/cli.md</code>)
<ul>
<li>Focuses on tool usage, code modifications, and professional objectivity</li>
<li>Designed for coding assistance in a terminal environment</li>
</ul></li>
<li><strong><code>tests</code></strong> - A minimal test prompt (see <code>vibe/core/prompts/tests.md</code>)
<ul>
<li>Simple prompt for testing purposes</li>
</ul></li>
</ol>
</section>
<section id="utility-prompts" class="level3">
<h3 class="anchored" data-anchor-id="utility-prompts">Utility Prompts</h3>
<ol type="1">
<li><strong><code>compact</code></strong> - Prompt for creating conversation summaries (see <code>vibe/core/prompts/compact.md</code>)
<ul>
<li>Used when the conversation needs to be compacted</li>
<li>Requires specific structure with 7 sections</li>
</ul></li>
<li><strong><code>project_context</code></strong> - Template for project context information (see <code>vibe/core/prompts/project_context.md</code>)
<ul>
<li>Displays directory structure and git status</li>
<li>Used to provide project-aware context</li>
</ul></li>
<li><strong><code>dangerous_directory</code></strong> - Warning for dangerous directories (see <code>vibe/core/prompts/dangerous_directory.md</code>)
<ul>
<li>Shown when scanning is disabled for security reasons</li>
</ul></li>
</ol>
</section>
</section>
<section id="system-prompt-customization-1" class="level2">
<h2 class="anchored" data-anchor-id="system-prompt-customization-1">System Prompt Customization</h2>
<p>The system prompt is the foundation of the agent’s behavior and can be fully customized.</p>
<section id="method-1-using-built-in-prompts" class="level3">
<h3 class="anchored" data-anchor-id="method-1-using-built-in-prompts">Method 1: Using Built-in Prompts</h3>
<p>Simply set the <code>system_prompt_id</code> in your configuration:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"cli"</span>  <span class="co"># or "tests"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="method-2-creating-custom-system-prompts" class="level3">
<h3 class="anchored" data-anchor-id="method-2-creating-custom-system-prompts">Method 2: Creating Custom System Prompts</h3>
<p>You can create your own system prompts by placing markdown files in the prompts directory.</p>
<section id="step-by-step-guide-3" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-guide-3">Step-by-Step Guide</h4>
<ol type="1">
<li><p><strong>Create a prompts directory</strong> (if it doesn’t exist):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.vibe/prompts</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Create a markdown file</strong> with your custom prompt:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/my-custom-prompt.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Define your prompt</strong> in the markdown file:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># My Custom Prompt</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>You are a helpful coding assistant specialized in <span class="co">[</span><span class="ot">your domain</span><span class="co">]</span>.</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Guidelines</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always be helpful and friendly</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Focus on <span class="co">[</span><span class="ot">specific requirements</span><span class="co">]</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Avoid <span class="co">[</span><span class="ot">certain behaviors</span><span class="co">]</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prefer <span class="co">[</span><span class="ot">specific approaches</span><span class="co">]</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tool Usage</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use tools to fulfill requests</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always check parameters before using tools</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Match the existing code style</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Activate your custom prompt</strong> in config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"my-custom-prompt"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ol>
</section>
<section id="project-specific-custom-prompts" class="level4">
<h4 class="anchored" data-anchor-id="project-specific-custom-prompts">Project-Specific Custom Prompts</h4>
<p>You can also create prompts specific to a project:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> .vibe/prompts</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> .vibe/prompts/project-prompt.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then reference it:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .vibe/config.toml</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"project-prompt"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="prompt-discovery-order" class="level3">
<h3 class="anchored" data-anchor-id="prompt-discovery-order">Prompt Discovery Order</h3>
<p>Vibe looks for custom prompts in this order: 1. <strong>Project-specific prompts</strong>: <code>.vibe/prompts/[name].md</code> 2. <strong>Global prompts</strong>: <code>~/.vibe/prompts/[name].md</code> 3. <strong>Built-in prompts</strong>: <code>vibe/core/prompts/[name].md</code></p>
</section>
</section>
<section id="utility-prompt-customization-1" class="level2">
<h2 class="anchored" data-anchor-id="utility-prompt-customization-1">Utility Prompt Customization</h2>
<p>Utility prompts are used for specific contextual information and can also be customized.</p>
<section id="customizing-project-context" class="level3">
<h3 class="anchored" data-anchor-id="customizing-project-context">Customizing Project Context</h3>
<p>The project context template (<code>project_context.md</code>) can be customized:</p>
<ol type="1">
<li><p><strong>Create a custom template</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/project_context.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Modify the template</strong> with your preferred format: ```markdown directoryStructure: Below is a snapshot of {abs_path} at the start of the conversation.{large_repo_warning}</p></li>
</ol>
<p>{structure}</p>
<p>Absolute path: {abs_path}</p>
<p>gitStatus: This is the git status at the start of the conversation. {git_status}</p>
<p>Additional Context: - Current timestamp: {timestamp} - User: {username}</p>
<pre><code>
3. **Note**: The template uses placeholders that will be replaced at runtime:
   - `{large_repo_warning}` - Warning if repository is large
   - `{structure}` - Directory structure
   - `{abs_path}` - Absolute path
   - `{git_status}` - Git status information

### Customizing Dangerous Directory Prompt

The dangerous directory prompt can also be customized:

```bash
nano ~/.vibe/prompts/dangerous_directory.md</code></pre>
<p>Example custom version:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>⚠️  Security Restriction Active ⚠️</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>Project context scanning has been disabled because {reason}.</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>This is for your security. You can still use tools to explore the project:</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`read_file`</span> to read specific files</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`bash`</span> to run commands</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`grep`</span> to search for patterns</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>Absolute path: {abs_path}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="project-context-customization" class="level2">
<h2 class="anchored" data-anchor-id="project-context-customization">Project Context Customization</h2>
<p>The project context provides information about the current project and can be extensively customized through configuration.</p>
<section id="configuration-options" class="level3">
<h3 class="anchored" data-anchor-id="configuration-options">Configuration Options</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="kw">[project_context]</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum characters in directory structure</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="dt">max_chars</span> <span class="op">=</span> <span class="dv">40000</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Default number of commits to show in git status</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="dt">default_commit_count</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum size of documentation files to load</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="dt">max_doc_bytes</span> <span class="op">=</span> <span class="dv">32768</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Buffer for truncation warnings</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="dt">truncation_buffer</span> <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum depth for directory traversal</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="dt">max_depth</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum number of files to show</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="dt">max_files</span> <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum directories per level</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="dt">max_dirs_per_level</span> <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Timeout for git operations (seconds)</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="dt">timeout_seconds</span> <span class="op">=</span> <span class="fl">2.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="customizing-project-documentation" class="level3">
<h3 class="anchored" data-anchor-id="customizing-project-documentation">Customizing Project Documentation</h3>
<p>Vibe automatically loads documentation from these files in the project root: - <code>README.md</code> - <code>README.rst</code> - <code>README.txt</code> - <code>README.markdown</code> - <code>README</code> - <code>readme.md</code> - <code>readme.rst</code> - <code>readme.txt</code> - <code>readme.markdown</code> - <code>readme</code></p>
<p>The documentation is loaded with a size limit (default: 32KB) and displayed in the prompt.</p>
</section>
<section id="disabling-project-context" class="level3">
<h3 class="anchored" data-anchor-id="disabling-project-context">Disabling Project Context</h3>
<p>You can disable project context entirely:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="dt">include_project_context</span> <span class="op">=</span> <span class="cn">false</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="session-specific-prompt-control-1" class="level2">
<h2 class="anchored" data-anchor-id="session-specific-prompt-control-1">Session-Specific Prompt Control</h2>
<p>You can control which prompt layers are included in each session through configuration.</p>
<section id="available-configuration-options" class="level3">
<h3 class="anchored" data-anchor-id="available-configuration-options">Available Configuration Options</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Include commit signature instructions</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="dt">include_commit_signature</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Include model information</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="dt">include_model_info</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Include OS and shell information</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="dt">include_prompt_detail</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Include project context</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="dt">include_project_context</span> <span class="op">=</span> <span class="cn">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-minimal-prompt-configuration" class="level3">
<h3 class="anchored" data-anchor-id="example-minimal-prompt-configuration">Example: Minimal Prompt Configuration</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="dt">include_commit_signature</span> <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="dt">include_model_info</span> <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="dt">include_prompt_detail</span> <span class="op">=</span> <span class="cn">false</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="dt">include_project_context</span> <span class="op">=</span> <span class="cn">false</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This would result in just the base system prompt being sent to the LLM.</p>
</section>
<section id="example-full-context-configuration" class="level3">
<h3 class="anchored" data-anchor-id="example-full-context-configuration">Example: Full Context Configuration</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="dt">include_commit_signature</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="dt">include_model_info</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="dt">include_prompt_detail</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="dt">include_project_context</span> <span class="op">=</span> <span class="cn">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This would include all available context layers.</p>
</section>
</section>
<section id="advanced-prompt-customization" class="level2">
<h2 class="anchored" data-anchor-id="advanced-prompt-customization">Advanced Prompt Customization</h2>
<section id="agent-specific-prompts" class="level3">
<h3 class="anchored" data-anchor-id="agent-specific-prompts">Agent-Specific Prompts</h3>
<p>You can override the system prompt for specific agents:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/agents/reviewer.toml</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"reviewer"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="dt">display_name</span> <span class="op">=</span> <span class="st">"Code Reviewer"</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"review-prompt"</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.read_file]</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then create the custom prompt:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/review-prompt.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="dynamic-prompt-selection" class="level3">
<h3 class="anchored" data-anchor-id="dynamic-prompt-selection">Dynamic Prompt Selection</h3>
<p>While Vibe doesn’t support dynamic prompt selection based on runtime conditions out of the box, you can:</p>
<ol type="1">
<li><strong>Create multiple prompts</strong> and switch between them using different agents</li>
<li><strong>Use environment variables</strong> in your prompts (though they won’t be expanded automatically)</li>
<li><strong>Use MCP servers</strong> to provide dynamic context through tools</li>
</ol>
</section>
<section id="custom-tool-prompts" class="level3">
<h3 class="anchored" data-anchor-id="custom-tool-prompts">Custom Tool Prompts</h3>
<p>Each tool can have its own prompt. To customize tool prompts:</p>
<ol type="1">
<li><strong>Create a custom tool</strong> in <code>~/.vibe/tools/</code></li>
<li><strong>Override the <code>get_tool_prompt()</code> method</strong>:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/tools/my_tool.py</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vibe.core.tools.base <span class="im">import</span> BaseTool, BaseToolConfig</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyTool(BaseTool[BaseToolConfig]):</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_name(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"my_tool"</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_description(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"My custom tool"</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_tool_prompt(cls) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Custom prompt for this tool."""</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"""</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="st"># My Tool Usage</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="st">When using my_tool, always:</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="st">- Provide the my_option parameter</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="st">- Use lowercase values</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="st">- Check the result before proceeding</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> run(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Tool executed"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="prompt-variables-and-dynamic-content" class="level2">
<h2 class="anchored" data-anchor-id="prompt-variables-and-dynamic-content">Prompt Variables and Dynamic Content</h2>
<p>The prompt system supports several dynamic variables that are replaced at runtime:</p>
<section id="system-prompt-variables" class="level3">
<h3 class="anchored" data-anchor-id="system-prompt-variables">System Prompt Variables</h3>
<ul>
<li><code>{config.active_model}</code> - The currently active model name</li>
<li><code>{config.textual_theme}</code> - The current UI theme</li>
<li><code>{platform}</code> - Operating system platform</li>
<li><code>{shell}</code> - Default shell</li>
</ul>
</section>
<section id="project-context-variables" class="level3">
<h3 class="anchored" data-anchor-id="project-context-variables">Project Context Variables</h3>
<ul>
<li><code>{large_repo_warning}</code> - Warning if repository is large</li>
<li><code>{structure}</code> - Directory structure tree</li>
<li><code>{abs_path}</code> - Absolute path to project root</li>
<li><code>{git_status}</code> - Git repository status</li>
</ul>
</section>
<section id="git-status-variables" class="level3">
<h3 class="anchored" data-anchor-id="git-status-variables">Git Status Variables</h3>
<ul>
<li><code>Current branch</code> - Name of current git branch</li>
<li><code>Main branch</code> - Name of main branch (main or master)</li>
<li><code>Status</code> - Repository status (clean or number of changes)</li>
<li><code>Recent commits</code> - List of recent commits</li>
</ul>
</section>
<section id="dynamic-content-generation" class="level3">
<h3 class="anchored" data-anchor-id="dynamic-content-generation">Dynamic Content Generation</h3>
<p>Some content is generated dynamically:</p>
<ol type="1">
<li><strong>Directory Structure</strong> - Built from actual filesystem</li>
<li><strong>Git Status</strong> - Fetched from git commands</li>
<li><strong>Available Skills</strong> - List of loaded skills</li>
<li><strong>Available Subagents</strong> - List of available subagents</li>
<li><strong>Tool Prompts</strong> - Prompts from each available tool</li>
</ol>
</section>
</section>
<section id="best-practices-for-prompt-customization" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-for-prompt-customization">Best Practices for Prompt Customization</h2>
<section id="start-with-the-built-in-prompt" class="level3">
<h3 class="anchored" data-anchor-id="start-with-the-built-in-prompt">1. Start with the Built-in Prompt</h3>
<p>Begin by using the built-in <code>cli</code> prompt and make incremental changes:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> vibe/core/prompts/cli.md ~/.vibe/prompts/my-prompt.md</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/my-prompt.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="keep-prompts-concise" class="level3">
<h3 class="anchored" data-anchor-id="keep-prompts-concise">2. Keep Prompts Concise</h3>
<ul>
<li>The LLM has token limits, so keep prompts focused</li>
<li>Remove guidelines that aren’t essential for your use case</li>
<li>Avoid redundant information</li>
</ul>
</section>
<section id="be-specific-about-requirements" class="level3">
<h3 class="anchored" data-anchor-id="be-specific-about-requirements">3. Be Specific About Requirements</h3>
<p>If you have specific requirements, state them clearly:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## Domain-Specific Guidelines</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always use TypeScript for frontend code</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prefer functional components over class components</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use the @mui/material library for UI components</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="test-incrementally" class="level3">
<h3 class="anchored" data-anchor-id="test-incrementally">4. Test Incrementally</h3>
<p>Make small changes and test them before making larger modifications:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"test-v1"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Test, then:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"test-v2"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="document-your-custom-prompts" class="level3">
<h3 class="anchored" data-anchor-id="document-your-custom-prompts">5. Document Your Custom Prompts</h3>
<p>Add comments to explain why certain guidelines exist:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb76"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Style Guidelines</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use 2-space indentation (company standard)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prefer const over let (immutability best practice)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="consider-context-length" class="level3">
<h3 class="anchored" data-anchor-id="consider-context-length">6. Consider Context Length</h3>
<p>Remember that the prompt is combined with: - Conversation history - Previous tool outputs - Current user message</p>
<p>Keep the total under the model’s context window limit.</p>
</section>
<section id="use-multiple-prompts-for-different-use-cases" class="level3">
<h3 class="anchored" data-anchor-id="use-multiple-prompts-for-different-use-cases">7. Use Multiple Prompts for Different Use Cases</h3>
<p>Create different prompts for different scenarios:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb77"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For code reviews</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/review.md</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For documentation</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/docs.md</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For testing</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/test.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then use different agents for each:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/agents/reviewer.toml</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"review"</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/agents/docwriter.toml</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"docs"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="complete-example-custom-prompt-setup" class="level2">
<h2 class="anchored" data-anchor-id="complete-example-custom-prompt-setup">Complete Example: Custom Prompt Setup</h2>
<section id="step-1-create-custom-prompt-directory" class="level3">
<h3 class="anchored" data-anchor-id="step-1-create-custom-prompt-directory">Step 1: Create Custom Prompt Directory</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb79"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.vibe/prompts</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-2-create-custom-system-prompt" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-custom-system-prompt">Step 2: Create Custom System Prompt</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb80"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/prompts/enterprise-dev.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb81"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Enterprise Development Assistant</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>You are operating as and within Mistral Vibe, configured for enterprise development standards.</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Core Principles</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Security First**: Always consider security implications</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Maintainability**: Write code that's easy to understand and maintain</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Performance**: Optimize for performance where it matters</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Standards Compliance**: Follow all company coding standards</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tool Usage Guidelines</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always use tools to fulfill user requests</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check parameters before using tools</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Match existing code style exactly</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Keep changes minimal and focused</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Enterprise-Specific Rules</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use TypeScript for all new frontend code</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use React with @mui/material for UI components</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Follow the monorepo structure</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use npm workspaces for package management</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always add proper documentation</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Quality</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Write clean, self-documenting code</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add JSDoc/TypeScript comments for public APIs</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Follow SOLID principles</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Write unit tests for all new code</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ensure code passes linting checks</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-3-create-agent-configuration" class="level3">
<h3 class="anchored" data-anchor-id="step-3-create-agent-configuration">Step 3: Create Agent Configuration</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb82"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/agents/enterprise.toml</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"enterprise"</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="dt">display_name</span> <span class="op">=</span> <span class="st">"Enterprise Developer"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="dt">description</span> <span class="op">=</span> <span class="st">"Agent configured for enterprise development standards"</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="dt">safety</span> <span class="op">=</span> <span class="st">"neutral"</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="dt">system_prompt_id</span> <span class="op">=</span> <span class="st">"enterprise-dev"</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tool permissions</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.write_file]</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"ask"</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.search_replace]</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"ask"</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.bash]</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"ask"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-4-update-main-configuration" class="level3">
<h3 class="anchored" data-anchor-id="step-4-update-main-configuration">Step 4: Update Main Configuration</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/config.toml</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb85"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="dt">active_model</span> <span class="op">=</span> <span class="st">"devstral-2"</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="dt">textual_theme</span> <span class="op">=</span> <span class="st">"terminal"</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Project context settings</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="kw">[project_context]</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="dt">max_chars</span> <span class="op">=</span> <span class="dv">30000</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="dt">max_depth</span> <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="dt">max_files</span> <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Include all context</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="dt">include_commit_signature</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="dt">include_model_info</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="dt">include_prompt_detail</span> <span class="op">=</span> <span class="cn">true</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="dt">include_project_context</span> <span class="op">=</span> <span class="cn">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-5-use-your-custom-setup" class="level3">
<h3 class="anchored" data-anchor-id="step-5-use-your-custom-setup">Step 5: Use Your Custom Setup</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb86"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vibe</span> <span class="at">--agent</span> enterprise</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="summary-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-2">Summary</h2>
<p>Mistral Vibe offers extensive prompt customization options:</p>
<ol type="1">
<li><strong>System Prompts</strong> - Customize base behavior (cli, tests, or custom)</li>
<li><strong>Utility Prompts</strong> - Customize contextual information (project_context, dangerous_directory)</li>
<li><strong>Prompt Layers</strong> - Control what context is included (commit signature, model info, etc.)</li>
<li><strong>Project Context</strong> - Configure how project information is presented</li>
<li><strong>Agent-Specific Prompts</strong> - Different prompts for different agents</li>
<li><strong>Tool Prompts</strong> - Custom prompts for custom tools</li>
</ol>
<section id="key-configuration-options" class="level3">
<h3 class="anchored" data-anchor-id="key-configuration-options">Key Configuration Options</h3>
<ul>
<li><code>system_prompt_id</code> - Which system prompt to use</li>
<li><code>include_commit_signature</code> - Include git commit instructions</li>
<li><code>include_model_info</code> - Include model name in prompt</li>
<li><code>include_prompt_detail</code> - Include OS/shell info and tool prompts</li>
<li><code>include_project_context</code> - Include project structure and git status</li>
<li><code>[project_context]</code> - Configure project context settings</li>
</ul>
</section>
<section id="customization-locations" class="level3">
<h3 class="anchored" data-anchor-id="customization-locations">Customization Locations</h3>
<ul>
<li><strong>Global</strong>: <code>~/.vibe/prompts/</code></li>
<li><strong>Project</strong>: <code>.vibe/prompts/</code></li>
<li><strong>Configuration</strong>: <code>~/.vibe/config.toml</code> or <code>.vibe/config.toml</code></li>
<li><strong>Agent Configs</strong>: <code>~/.vibe/agents/*.toml</code> or <code>.vibe/agents/*.toml</code></li>
</ul>
<p>By understanding and leveraging these options, you can fully customize Mistral Vibe’s behavior to match your specific workflow, coding standards, and requirements.</p>
</section>
</section>
<section id="how-the-task-tool-works-in-mistral-vibe" class="level2">
<h2 class="anchored" data-anchor-id="how-the-task-tool-works-in-mistral-vibe">How the Task Tool Works in Mistral Vibe</h2>
<p>I’ve explored the task tool implementation and created a detailed document covering all aspects. Here’s what I found:</p>
<section id="core-functionality" class="level3">
<h3 class="anchored" data-anchor-id="core-functionality"><strong>Core Functionality</strong></h3>
<p>The <code>task</code> tool delegates work to subagents for independent execution, enabling: - Context management (offload work to prevent context overload) - Parallel execution (run multiple tasks independently) - Specialization (use different subagents for different tasks) - Automation (delegate repetitive or complex tasks)</p>
</section>
<section id="how-it-works" class="level3">
<h3 class="anchored" data-anchor-id="how-it-works"><strong>How It Works</strong></h3>
<ol type="1">
<li><strong>Validation</strong>: Checks that the specified agent exists and is a subagent</li>
<li><strong>Isolated Execution</strong>: Creates a new <code>AgentLoop</code> with logging disabled</li>
<li><strong>Conversation Loop</strong>: Runs the subagent with the task description</li>
<li><strong>Event Streaming</strong>: Collects responses and displays tool results</li>
<li><strong>Completion</strong>: Returns accumulated response with turn count</li>
</ol>
</section>
<section id="key-security-mechanisms" class="level3">
<h3 class="anchored" data-anchor-id="key-security-mechanisms"><strong>Key Security Mechanisms</strong></h3>
<ul>
<li><strong>Agent Type Validation</strong>: Only subagents can be spawned (prevents recursion)</li>
<li><strong>Isolated Configuration</strong>: Session logging disabled for privacy</li>
<li><strong>Inherited Approval Callback</strong>: Maintains same permission model</li>
<li><strong>Turn Counting</strong>: Prevents runaway processes</li>
<li><strong>Error Handling</strong>: Graceful degradation on failures</li>
</ul>
</section>
<section id="task-arguments" class="level3">
<h3 class="anchored" data-anchor-id="task-arguments"><strong>Task Arguments</strong></h3>
<ul>
<li><strong>Required</strong>: <code>task</code> (str) - The task description</li>
<li><strong>Optional</strong>: <code>agent</code> (str) - Subagent name (default: “explore”)</li>
</ul>
</section>
<section id="task-results" class="level3">
<h3 class="anchored" data-anchor-id="task-results"><strong>Task Results</strong></h3>
<p>Returns a <code>TaskResult</code> with: - <code>response</code>: Accumulated text response - <code>turns_used</code>: Number of assistant responses - <code>completed</code>: Whether task finished normally</p>
</section>
<section id="best-practices-1" class="level3">
<h3 class="anchored" data-anchor-id="best-practices-1"><strong>Best Practices</strong></h3>
<ul>
<li>Write clear, detailed task descriptions</li>
<li>Choose the right subagent for the task</li>
<li>Use for complex tasks, not simple operations</li>
<li>Trust subagent autonomy</li>
</ul>
<p>The document provides complete implementation details, security analysis, use cases, and a step-by-step example of creating and using custom subagents.</p>
</section>
</section>
<section id="complete-guide-to-the-task-tool" class="level2">
<h2 class="anchored" data-anchor-id="complete-guide-to-the-task-tool">Complete Guide to the Task Tool</h2>
<ol type="1">
<li><a href="#overview-of-the-task-tool">Overview of the Task Tool</a></li>
<li><a href="#how-the-task-tool-works">How the Task Tool Works</a></li>
<li><a href="#task-execution-flow">Task Execution Flow</a></li>
<li><a href="#task-arguments">Task Arguments</a></li>
<li><a href="#task-results">Task Results</a></li>
<li><a href="#security-and-safety-mechanisms">Security and Safety Mechanisms</a></li>
<li><a href="#use-cases-and-best-practices">Use Cases and Best Practices</a></li>
<li><a href="#limitations">Limitations</a></li>
<li><a href="#implementation-details">Implementation Details</a></li>
</ol>
</section>
<section id="overview-of-the-task-tool" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-the-task-tool">Overview of the Task Tool</h2>
<p>The <code>task</code> tool is a powerful feature in Mistral Vibe that allows delegating work to subagents for independent execution. It enables parallel processing and context management by running specialized agents in the background.</p>
<section id="key-characteristics-1" class="level3">
<h3 class="anchored" data-anchor-id="key-characteristics-1">Key Characteristics</h3>
<ul>
<li><strong>Independent Execution</strong>: Subagents run autonomously without user interaction</li>
<li><strong>Context Isolation</strong>: Subagent conversations don’t interfere with the main conversation</li>
<li><strong>Resource Management</strong>: Limits on turns and execution to prevent runaway processes</li>
<li><strong>Security Constraints</strong>: Only subagents can be spawned (not regular agents)</li>
<li><strong>No Logging</strong>: Subagent interactions are not saved to session logs</li>
</ul>
</section>
</section>
<section id="how-the-task-tool-works" class="level2">
<h2 class="anchored" data-anchor-id="how-the-task-tool-works">How the Task Tool Works</h2>
<p>The task tool creates a separate <code>AgentLoop</code> instance for the subagent, runs it with the provided task description, and returns the accumulated results.</p>
<section id="core-process" class="level3">
<h3 class="anchored" data-anchor-id="core-process">Core Process</h3>
<ol type="1">
<li><strong>Validation</strong>: Check that the specified agent exists and is a subagent</li>
<li><strong>Configuration</strong>: Create a new configuration with logging disabled</li>
<li><strong>Execution</strong>: Run the subagent’s conversation loop with the task</li>
<li><strong>Monitoring</strong>: Track turns and collect output</li>
<li><strong>Completion</strong>: Return results when done or interrupted</li>
</ol>
</section>
<section id="code-flow" class="level3">
<h3 class="anchored" data-anchor-id="code-flow">Code Flow</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Get the subagent profile</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>agent_profile <span class="op">=</span> agent_manager.get_agent(args.agent)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Validate it's a subagent</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> agent_profile.agent_type <span class="op">!=</span> AgentType.SUBAGENT:</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> ToolError(<span class="st">"Only subagents can be used"</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create isolated configuration</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>base_config <span class="op">=</span> VibeConfig.load(session_logging<span class="op">=</span>SessionLoggingConfig(enabled<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Create subagent loop</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>subagent_loop <span class="op">=</span> AgentLoop(config<span class="op">=</span>base_config, agent_name<span class="op">=</span>args.agent)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Execute and collect results</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="cf">for</span> event <span class="kw">in</span> subagent_loop.act(args.task):</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(event, AssistantEvent) <span class="kw">and</span> event.content:</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>        accumulated_response.append(event.content)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... handle other events</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Return results</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="cf">yield</span> TaskResult(</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    response<span class="op">=</span><span class="st">""</span>.join(accumulated_response),</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    turns_used<span class="op">=</span>turns_used,</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    completed<span class="op">=</span>completed,</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="task-execution-flow" class="level2">
<h2 class="anchored" data-anchor-id="task-execution-flow">Task Execution Flow</h2>
<section id="step-by-step-execution" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-execution">Step-by-Step Execution</h3>
<ol type="1">
<li><strong>Tool Invocation</strong>
<ul>
<li>User or main agent calls <code>task(task="...", agent="...")</code></li>
<li>Tool is validated and permissions are checked</li>
</ul></li>
<li><strong>Subagent Selection</strong>
<ul>
<li>Agent manager looks up the specified agent</li>
<li>Verifies it’s a subagent (not a regular agent)</li>
<li>Loads the agent’s profile and configuration</li>
</ul></li>
<li><strong>Isolated Execution Environment</strong>
<ul>
<li>Creates new <code>AgentLoop</code> instance for the subagent</li>
<li>Disables session logging (<code>SessionLoggingConfig(enabled=False)</code>)</li>
<li>Inherits approval callback from parent context</li>
</ul></li>
<li><strong>Conversation Loop</strong>
<ul>
<li>Subagent processes the task description</li>
<li>Can use any tools allowed in its profile</li>
<li>Generates responses and tool calls</li>
</ul></li>
<li><strong>Event Streaming</strong>
<ul>
<li>Assistant messages are collected</li>
<li>Tool results are displayed in real-time</li>
<li>Interruptions are detected</li>
</ul></li>
<li><strong>Completion</strong>
<ul>
<li>Counts turns used (number of assistant responses)</li>
<li>Determines if task completed normally</li>
<li>Returns accumulated response</li>
</ul></li>
</ol>
</section>
<section id="event-types-handled" class="level3">
<h3 class="anchored" data-anchor-id="event-types-handled">Event Types Handled</h3>
<p>The task tool processes these event types from the subagent:</p>
<ul>
<li><strong>AssistantEvent</strong>: Collects the subagent’s text responses</li>
<li><strong>ToolResultEvent</strong>: Displays tool execution results</li>
<li><strong>CompactStartEvent/CompactEndEvent</strong>: Handles conversation compaction</li>
<li><strong>Middleware stop events</strong>: Detects interruptions</li>
</ul>
</section>
</section>
<section id="task-arguments-1" class="level2">
<h2 class="anchored" data-anchor-id="task-arguments-1">Task Arguments</h2>
<p>The task tool accepts two parameters:</p>
<section id="required-parameter" class="level3">
<h3 class="anchored" data-anchor-id="required-parameter">Required Parameter</h3>
<ul>
<li><strong><code>task</code></strong> (str): The task description to delegate to the subagent
<ul>
<li>Should be clear and detailed</li>
<li>Provides context for autonomous execution</li>
<li>Examples: “Analyze the project structure”, “Find all TODO comments”</li>
</ul></li>
</ul>
</section>
<section id="optional-parameter" class="level3">
<h3 class="anchored" data-anchor-id="optional-parameter">Optional Parameter</h3>
<ul>
<li><strong><code>agent</code></strong> (str): Name of the subagent to use
<ul>
<li>Default: “explore” (built-in exploration subagent)</li>
<li>Must be a valid subagent profile</li>
<li>Examples: “explore”, “my-custom-subagent”</li>
</ul></li>
</ul>
</section>
<section id="example-invocations" class="level3">
<h3 class="anchored" data-anchor-id="example-invocations">Example Invocations</h3>
<pre><code>task(task="Find all instances of the word TODO in the codebase")
task(task="Analyze the architecture of the backend service", agent="explore")
task(task="Review the test files for missing assertions", agent="reviewer")</code></pre>
</section>
</section>
<section id="task-results-1" class="level2">
<h2 class="anchored" data-anchor-id="task-results-1">Task Results</h2>
<p>The task tool returns a <code>TaskResult</code> object with three fields:</p>
<section id="result-fields" class="level3">
<h3 class="anchored" data-anchor-id="result-fields">Result Fields</h3>
<ol type="1">
<li><strong><code>response</code></strong> (str): Accumulated text response from the subagent
<ul>
<li>Contains all assistant messages concatenated</li>
<li>May include error messages if execution failed</li>
<li>Used as the primary output of the tool</li>
</ul></li>
<li><strong><code>turns_used</code></strong> (int): Number of turns the subagent used
<ul>
<li>Counts assistant responses in the conversation</li>
<li>Helps track resource usage</li>
<li>Used for monitoring and billing</li>
</ul></li>
<li><strong><code>completed</code></strong> (bool): Whether the task completed normally
<ul>
<li><code>True</code> if subagent finished naturally</li>
<li><code>False</code> if interrupted by middleware or error</li>
<li>Helps determine if results are reliable</li>
</ul></li>
</ol>
</section>
<section id="example-results" class="level3">
<h3 class="anchored" data-anchor-id="example-results">Example Results</h3>
<p><strong>Successful completion:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb89"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"response"</span><span class="fu">:</span> <span class="st">"Found 15 TODO comments in the codebase..."</span><span class="fu">,</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"turns_used"</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">,</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"completed"</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Interrupted:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb90"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"response"</span><span class="fu">:</span> <span class="st">"Analyzing project structure... [Subagent error: timeout]"</span><span class="fu">,</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"turns_used"</span><span class="fu">:</span> <span class="dv">5</span><span class="fu">,</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"completed"</span><span class="fu">:</span> <span class="kw">false</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="security-and-safety-mechanisms" class="level2">
<h2 class="anchored" data-anchor-id="security-and-safety-mechanisms">Security and Safety Mechanisms</h2>
<p>The task tool has multiple security layers:</p>
<section id="agent-type-validation" class="level3">
<h3 class="anchored" data-anchor-id="agent-type-validation">1. Agent Type Validation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> agent_profile.agent_type <span class="op">!=</span> AgentType.SUBAGENT:</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> ToolError(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"Agent '</span><span class="sc">{</span>args<span class="sc">.</span>agent<span class="sc">}</span><span class="ss">' is a </span><span class="sc">{</span>agent_profile<span class="sc">.</span>agent_type<span class="sc">.</span>value<span class="sc">}</span><span class="ss"> agent. "</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"Only subagents can be used with the task tool. "</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"This is a security constraint to prevent recursive spawning."</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Purpose</strong>: Prevents infinite recursion by ensuring only subagents can be spawned.</p>
</section>
<section id="isolated-configuration" class="level3">
<h3 class="anchored" data-anchor-id="isolated-configuration">2. Isolated Configuration</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>base_config <span class="op">=</span> VibeConfig.load(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    session_logging<span class="op">=</span>SessionLoggingConfig(enabled<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Purpose</strong>: Subagent interactions are not logged to prevent sensitive data leakage.</p>
</section>
<section id="inherited-approval-callback" class="level3">
<h3 class="anchored" data-anchor-id="inherited-approval-callback">3. Inherited Approval Callback</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ctx <span class="kw">and</span> ctx.approval_callback:</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    subagent_loop.set_approval_callback(ctx.approval_callback)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Purpose</strong>: Maintains the same permission model as the parent agent.</p>
</section>
<section id="turn-counting" class="level3">
<h3 class="anchored" data-anchor-id="turn-counting">4. Turn Counting</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>turns_used <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    msg.role <span class="op">==</span> Role.assistant <span class="cf">for</span> msg <span class="kw">in</span> subagent_loop.messages</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Purpose</strong>: Prevents runaway processes by tracking resource usage.</p>
</section>
<section id="error-handling-1" class="level3">
<h3 class="anchored" data-anchor-id="error-handling-1">5. Error Handling</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="cf">for</span> event <span class="kw">in</span> subagent_loop.act(args.task):</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ... process events</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    completed <span class="op">=</span> <span class="va">False</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    accumulated_response.append(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">[Subagent error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Purpose</strong>: Graceful handling of subagent failures.</p>
</section>
<section id="middleware-integration" class="level3">
<h3 class="anchored" data-anchor-id="middleware-integration">6. Middleware Integration</h3>
<p>The subagent inherits middleware from the main configuration: - <strong>TurnLimitMiddleware</strong>: Limits number of turns - <strong>PriceLimitMiddleware</strong>: Limits cost - <strong>AutoCompactMiddleware</strong>: Compacts long conversations - <strong>PlanAgentMiddleware</strong>: Handles plan agent logic</p>
</section>
</section>
<section id="use-cases-and-best-practices" class="level2">
<h2 class="anchored" data-anchor-id="use-cases-and-best-practices">Use Cases and Best Practices</h2>
<section id="when-to-use-the-task-tool" class="level3">
<h3 class="anchored" data-anchor-id="when-to-use-the-task-tool">When to Use the Task Tool</h3>
<p>✅ <strong>Context management</strong>: Delegate tasks that would consume too much main conversation context ✅ <strong>Specialized work</strong>: Use appropriate subagents for specific task types ✅ <strong>Parallel execution</strong>: Launch multiple subagents for independent tasks ✅ <strong>Autonomous work</strong>: Tasks that don’t require back-and-forth with the user</p>
</section>
<section id="best-practices-2" class="level3">
<h3 class="anchored" data-anchor-id="best-practices-2">Best Practices</h3>
<ol type="1">
<li><strong>Write clear, detailed task descriptions</strong>
<ul>
<li>The subagent works autonomously</li>
<li>Provide enough context for independent success</li>
<li>Example: “Analyze the project structure and architecture” vs “Check stuff”</li>
</ul></li>
<li><strong>Choose the right subagent</strong>
<ul>
<li>Match the subagent to the task type</li>
<li>Use built-in subagents like “explore” for code analysis</li>
<li>Create custom subagents for specialized tasks</li>
</ul></li>
<li><strong>Prefer direct tools for simple operations</strong>
<ul>
<li>If you know exactly which file to read: use <code>read_file</code></li>
<li>If you need to search: use <code>grep</code></li>
<li>Only use task for complex, multi-step work</li>
</ul></li>
<li><strong>Trust the subagent’s judgment</strong>
<ul>
<li>Let it explore without micromanaging</li>
<li>Avoid specifying exact steps</li>
<li>Focus on the goal, not the method</li>
</ul></li>
</ol>
</section>
<section id="example-use-cases" class="level3">
<h3 class="anchored" data-anchor-id="example-use-cases">Example Use Cases</h3>
<p><strong>Codebase Exploration:</strong></p>
<pre><code>task(task="Analyze the project structure and identify key components")</code></pre>
<p><strong>Pattern Searching:</strong></p>
<pre><code>task(task="Find all deprecated API usages in the codebase")</code></pre>
<p><strong>Documentation Review:</strong></p>
<pre><code>task(task="Check if all public functions have proper documentation")</code></pre>
<p><strong>Architecture Analysis:</strong></p>
<pre><code>task(task="Analyze the database schema and identify potential issues")</code></pre>
</section>
</section>
<section id="limitations" class="level2">
<h2 class="anchored" data-anchor-id="limitations">Limitations</h2>
<section id="functional-limitations" class="level3">
<h3 class="anchored" data-anchor-id="functional-limitations">Functional Limitations</h3>
<ul>
<li><strong>No file writing</strong>: Subagents cannot write or modify files</li>
<li><strong>No user interaction</strong>: Subagents cannot ask user questions</li>
<li><strong>No persistent state</strong>: Subagent sessions are not saved</li>
<li><strong>Limited turns</strong>: Controlled by middleware (turn limits)</li>
<li><strong>Cost limits</strong>: Controlled by middleware (price limits)</li>
</ul>
</section>
<section id="technical-limitations" class="level3">
<h3 class="anchored" data-anchor-id="technical-limitations">Technical Limitations</h3>
<ul>
<li><strong>Single subagent at a time</strong>: Only one subagent runs per task call</li>
<li><strong>No nested tasks</strong>: Subagents cannot call the task tool themselves</li>
<li><strong>Resource sharing</strong>: Subagents share the same LLM backend</li>
<li><strong>Context isolation</strong>: Subagent context doesn’t affect main conversation</li>
</ul>
</section>
<section id="error-handling-2" class="level3">
<h3 class="anchored" data-anchor-id="error-handling-2">Error Handling</h3>
<ul>
<li><strong>Timeouts</strong>: Subagents may be interrupted if they take too long</li>
<li><strong>Resource limits</strong>: Subagents are constrained by middleware</li>
<li><strong>Permission errors</strong>: Subagents respect their tool permissions</li>
<li><strong>Execution errors</strong>: Errors are captured and returned in response</li>
</ul>
</section>
</section>
<section id="implementation-details" class="level2">
<h2 class="anchored" data-anchor-id="implementation-details">Implementation Details</h2>
<section id="tool-class-structure" class="level3">
<h3 class="anchored" data-anchor-id="tool-class-structure">Tool Class Structure</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Task(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    BaseTool[TaskArgs, TaskResult, TaskToolConfig, BaseToolState],</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    ToolUIData[TaskArgs, TaskResult],</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>):</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Type Parameters:</strong> - <code>TaskArgs</code>: Input arguments (task description, agent name) - <code>TaskResult</code>: Output results (response, turns, completion status) - <code>TaskToolConfig</code>: Tool configuration (permission level) - <code>BaseToolState</code>: Tool execution state</p>
</section>
<section id="key-methods" class="level3">
<h3 class="anchored" data-anchor-id="key-methods">Key Methods</h3>
<ol type="1">
<li><strong><code>run()</code></strong>: Main execution method (async generator)
<ul>
<li>Creates subagent loop</li>
<li>Executes task</li>
<li>Yields stream events</li>
<li>Returns final result</li>
</ul></li>
<li><strong><code>get_call_display()</code></strong>: UI display for tool call
<ul>
<li>Shows “Running {agent} agent: {task}”</li>
<li>Provides feedback during execution</li>
</ul></li>
<li><strong><code>get_result_display()</code></strong>: UI display for tool result
<ul>
<li>Shows “Agent completed in {turns_used} turns”</li>
<li>Indicates success or interruption</li>
</ul></li>
<li><strong><code>get_status_text()</code></strong>: Status message
<ul>
<li>Returns “Running subagent”</li>
<li>Used during execution</li>
</ul></li>
</ol>
</section>
<section id="permission-model" class="level3">
<h3 class="anchored" data-anchor-id="permission-model">Permission Model</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TaskToolConfig(BaseToolConfig):</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    permission: ToolPermission <span class="op">=</span> ToolPermission.ASK</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Default Permission</strong>: <code>ASK</code> (requires user approval)</p>
<p><strong>Possible Values:</strong> - <code>always</code>: Auto-approve task executions - <code>never</code>: Disable task tool completely - <code>ask</code>: Require user confirmation (default)</p>
</section>
<section id="ui-integration" class="level3">
<h3 class="anchored" data-anchor-id="ui-integration">UI Integration</h3>
<p>The task tool implements <code>ToolUIData</code> for rich UI display:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="at">@classmethod</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_call_display(cls, event: ToolCallEvent) <span class="op">-&gt;</span> ToolCallDisplay:</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> event.args</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(args, TaskArgs):</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ToolCallDisplay(</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>            summary<span class="op">=</span><span class="ss">f"Running </span><span class="sc">{</span>args<span class="sc">.</span>agent<span class="sc">}</span><span class="ss"> agent: </span><span class="sc">{</span>args<span class="sc">.</span>task<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ToolCallDisplay(summary<span class="op">=</span><span class="st">"Running subagent"</span>)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="at">@classmethod</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_result_display(cls, event: ToolResultEvent) <span class="op">-&gt;</span> ToolResultDisplay:</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> event.result</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(result, TaskResult):</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>        turn_word <span class="op">=</span> <span class="st">"turn"</span> <span class="cf">if</span> result.turns_used <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">"turns"</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> result.completed:</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ToolResultDisplay(</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>                success<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>                message<span class="op">=</span><span class="ss">f"Agent interrupted after </span><span class="sc">{</span>result<span class="sc">.</span>turns_used<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>turn_word<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ToolResultDisplay(</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>            success<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>            message<span class="op">=</span><span class="ss">f"Agent completed in </span><span class="sc">{</span>result<span class="sc">.</span>turns_used<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>turn_word<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ToolResultDisplay(success<span class="op">=</span><span class="va">True</span>, message<span class="op">=</span><span class="st">"Agent completed"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="complete-example" class="level2">
<h2 class="anchored" data-anchor-id="complete-example">Complete Example</h2>
<section id="creating-a-custom-subagent" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-custom-subagent">Creating a Custom Subagent</h3>
<p>First, create a custom subagent profile:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb103"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/agents/code-analyzer.toml</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="dt">name</span> <span class="op">=</span> <span class="st">"code-analyzer"</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="dt">display_name</span> <span class="op">=</span> <span class="st">"Code Analyzer"</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="dt">description</span> <span class="op">=</span> <span class="st">"Specialized subagent for code analysis tasks"</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="dt">safety</span> <span class="op">=</span> <span class="st">"safe"</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="dt">agent_type</span> <span class="op">=</span> <span class="st">"subagent"</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow read-only tools</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.read_file]</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.grep]</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.bash]</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"always"</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Disable write tools</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.write_file]</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"never"</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="kw">[tools.search_replace]</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="dt">permission</span> <span class="op">=</span> <span class="st">"never"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="using-the-custom-subagent" class="level3">
<h3 class="anchored" data-anchor-id="using-the-custom-subagent">Using the Custom Subagent</h3>
<pre><code>task(
    task="Analyze the code quality and identify potential issues",
    agent="code-analyzer"
)</code></pre>
</section>
<section id="expected-output" class="level3">
<h3 class="anchored" data-anchor-id="expected-output">Expected Output</h3>
<pre><code>🤖 Running code-analyzer agent: Analyze the code quality and identify potential issues

🔧 code-analyzer: Agent completed in 4 turns

Found the following issues:
1. Missing type hints in 15 functions
2. Unused imports in 3 files
3. Potential security issues in auth module</code></pre>
</section>
</section>
<section id="summary-3" class="level2">
<h2 class="anchored" data-anchor-id="summary-3">Summary</h2>
<p>The <code>task</code> tool is a powerful feature that enables:</p>
<ol type="1">
<li><strong>Context Management</strong>: Offload work to prevent context overload</li>
<li><strong>Parallel Execution</strong>: Run multiple tasks independently</li>
<li><strong>Specialization</strong>: Use different subagents for different tasks</li>
<li><strong>Automation</strong>: Delegate repetitive or complex tasks</li>
</ol>
<section id="key-features" class="level3">
<h3 class="anchored" data-anchor-id="key-features">Key Features</h3>
<ul>
<li><strong>Independent execution</strong> with isolated configuration</li>
<li><strong>Security constraints</strong> preventing recursion</li>
<li><strong>Resource monitoring</strong> with turn counting</li>
<li><strong>Rich UI integration</strong> with progress display</li>
<li><strong>Error handling</strong> with graceful degradation</li>
</ul>
</section>
<section id="best-practices-3" class="level3">
<h3 class="anchored" data-anchor-id="best-practices-3">Best Practices</h3>
<ul>
<li>Write detailed task descriptions</li>
<li>Choose appropriate subagents</li>
<li>Use for complex, multi-step tasks</li>
<li>Trust subagent autonomy</li>
<li>Monitor resource usage</li>
</ul>
<p>By understanding how the task tool works, you can effectively use it to manage complex workflows, delegate specialized tasks, and improve overall productivity in Mistral Vibe.</p>
</section>
</section>
<section id="how-skills-work-in-mistral-vibe" class="level2">
<h2 class="anchored" data-anchor-id="how-skills-work-in-mistral-vibe">How Skills Work in Mistral Vibe</h2>
<p>I’ve explored the skills system implementation and created a detailed document covering all aspects. Here’s what I found:</p>
<section id="core-functionality-1" class="level3">
<h3 class="anchored" data-anchor-id="core-functionality-1"><strong>Core Functionality</strong></h3>
<p>Skills are reusable components that extend Vibe’s functionality through: - Documentation in the system prompt - Slash command integration (when <code>user_invocable=true</code>) - Tool restrictions (experimental feature) - Metadata-driven configuration</p>
</section>
<section id="skill-structure-1" class="level3">
<h3 class="anchored" data-anchor-id="skill-structure-1"><strong>Skill Structure</strong></h3>
<ul>
<li><strong>Location</strong>: Directories with <code>SKILL.md</code> files</li>
<li><strong>Format</strong>: YAML frontmatter + markdown content</li>
<li><strong>Discovery</strong>: Automatic from multiple paths</li>
</ul>
</section>
<section id="skill-metadata-fields-1" class="level3">
<h3 class="anchored" data-anchor-id="skill-metadata-fields-1"><strong>Skill Metadata Fields</strong></h3>
<p><strong>Required:</strong> - <code>name</code> (str): Skill identifier (must match directory name) - <code>description</code> (str): What the skill does</p>
<p><strong>Optional:</strong> - <code>license</code> (str): License information - <code>compatibility</code> (str): Environment requirements - <code>metadata</code> (dict): Arbitrary key-value pairs - <code>allowed-tools</code> (list): Pre-approved tools (experimental) - <code>user-invocable</code> (bool): Appear in slash command menu (default: true)</p>
</section>
<section id="discovery-paths" class="level3">
<h3 class="anchored" data-anchor-id="discovery-paths"><strong>Discovery Paths</strong></h3>
<p>Skills are discovered from: 1. Custom paths (from <code>skill_paths</code> in config) 2. Local project skills (<code>.vibe/skills/</code>) 3. Global skills (<code>~/.vibe/skills/</code>)</p>
</section>
<section id="integration-points-1" class="level3">
<h3 class="anchored" data-anchor-id="integration-points-1"><strong>Integration Points</strong></h3>
<ol type="1">
<li><strong>System Prompt</strong>: Skills section with XML format</li>
<li><strong>Slash Commands</strong>: User-invocable skills appear in menu</li>
<li><strong>Configuration</strong>: Enable/disable via patterns</li>
</ol>
</section>
<section id="management" class="level3">
<h3 class="anchored" data-anchor-id="management"><strong>Management</strong></h3>
<ul>
<li><strong>Enable/Disable</strong>: Using <code>enabled_skills</code> and <code>disabled_skills</code> in config</li>
<li><strong>Pattern Matching</strong>: Exact names, globs, and regex</li>
<li><strong>Duplicate Handling</strong>: First occurrence wins</li>
</ul>
</section>
<section id="security-features" class="level3">
<h3 class="anchored" data-anchor-id="security-features"><strong>Security Features</strong></h3>
<ul>
<li>HTML escaping in system prompt</li>
<li>Tool restrictions (experimental)</li>
<li>Validation of metadata fields</li>
</ul>
<p>The document provides complete implementation details, examples, and best practices for creating and using skills.</p>
</section>
</section>
<section id="complete-guide-to-the-skills-system" class="level2">
<h2 class="anchored" data-anchor-id="complete-guide-to-the-skills-system">Complete Guide to the Skills System</h2>
<ol type="1">
<li><a href="#overview-of-the-skills-system">Overview of the Skills System</a></li>
<li><a href="#skill-structure-and-format">Skill Structure and Format</a></li>
<li><a href="#skill-discovery-and-loading">Skill Discovery and Loading</a></li>
<li><a href="#skill-metadata-fields">Skill Metadata Fields</a></li>
<li><a href="#skill-integration-with-the-system">Skill Integration with the System</a></li>
<li><a href="#skill-discovery-paths">Skill Discovery Paths</a></li>
<li><a href="#skill-management-and-configuration">Skill Management and Configuration</a></li>
<li><a href="#skills-and-slash-commands">Skills and Slash Commands</a></li>
<li><a href="#best-practices-for-creating-skills">Best Practices for Creating Skills</a></li>
<li><a href="#complete-example-creating-a-custom-skill">Complete Example: Creating a Custom Skill</a></li>
</ol>
</section>
<section id="overview-of-the-skills-system" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-the-skills-system">Overview of the Skills System</h2>
<p>The skills system in Mistral Vibe allows extending functionality through reusable components. Skills can add specialized behaviors, documentation, and can appear as slash commands in the UI.</p>
<section id="key-characteristics-2" class="level3">
<h3 class="anchored" data-anchor-id="key-characteristics-2">Key Characteristics</h3>
<ul>
<li><strong>Reusable Components</strong>: Skills are self-contained units of functionality</li>
<li><strong>Metadata-Driven</strong>: Skills use YAML frontmatter for configuration</li>
<li><strong>Discoverable</strong>: Skills are automatically discovered from multiple paths</li>
<li><strong>Configurable</strong>: Skills can be enabled/disabled via patterns</li>
<li><strong>User-Invocable</strong>: Skills can appear in slash command menu</li>
</ul>
</section>
<section id="purpose" class="level3">
<h3 class="anchored" data-anchor-id="purpose">Purpose</h3>
<p>Skills serve several purposes:</p>
<ol type="1">
<li><strong>Documentation</strong>: Provide context about available capabilities</li>
<li><strong>Specialization</strong>: Define specialized behaviors for different domains</li>
<li><strong>Slash Commands</strong>: Appear as user-invocable commands in the UI</li>
<li><strong>Tool Restrictions</strong>: Limit which tools a skill can use (experimental)</li>
</ol>
</section>
</section>
<section id="skill-structure-and-format" class="level2">
<h2 class="anchored" data-anchor-id="skill-structure-and-format">Skill Structure and Format</h2>
<p>Skills are defined in directories with a <code>SKILL.md</code> file containing YAML frontmatter followed by markdown content.</p>
<section id="file-structure" class="level3">
<h3 class="anchored" data-anchor-id="file-structure">File Structure</h3>
<pre><code>~/.vibe/skills/
└── my-skill/
    └── SKILL.md</code></pre>
</section>
<section id="format-specification" class="level3">
<h3 class="anchored" data-anchor-id="format-specification">Format Specification</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb107"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># YAML Frontmatter (Metadata)</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> my-skill</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> What this skill does</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> MIT</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="an">compatibility:</span><span class="co"> Python 3.12+</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="an">user-invocable:</span><span class="co"> true</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="an">allowed-tools:</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - read_file</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - grep</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Markdown Content</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Skill Documentation</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>Detailed description of what the skill does and how to use it.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="frontmatter-requirements" class="level3">
<h3 class="anchored" data-anchor-id="frontmatter-requirements">Frontmatter Requirements</h3>
<ul>
<li>Must start and end with <code>---</code> (at least 3 dashes)</li>
<li>Must be valid YAML</li>
<li>Must contain at least <code>name</code> and <code>description</code></li>
<li>Must be a dictionary/mapping</li>
</ul>
</section>
</section>
<section id="skill-discovery-and-loading" class="level2">
<h2 class="anchored" data-anchor-id="skill-discovery-and-loading">Skill Discovery and Loading</h2>
<p>The skill system uses a multi-stage discovery and loading process:</p>
<section id="discovery-process-1" class="level3">
<h3 class="anchored" data-anchor-id="discovery-process-1">Discovery Process</h3>
<ol type="1">
<li><strong>Find Skill Directories</strong>: Look for directories in search paths</li>
<li><strong>Check for SKILL.md</strong>: Each directory must contain a <code>SKILL.md</code> file</li>
<li><strong>Parse Frontmatter</strong>: Extract YAML metadata from the file</li>
<li><strong>Validate Metadata</strong>: Ensure required fields are present</li>
<li><strong>Create SkillInfo</strong>: Build internal representation</li>
<li><strong>Handle Duplicates</strong>: Skip duplicates (log warning)</li>
</ol>
</section>
<section id="loading-code" class="level3">
<h3 class="anchored" data-anchor-id="loading-code">Loading Code</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _parse_skill_file(<span class="va">self</span>, skill_path: Path) <span class="op">-&gt;</span> SkillInfo:</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> skill_path.read_text(encoding<span class="op">=</span><span class="st">"utf-8"</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">OSError</span> <span class="im">as</span> e:</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> SkillParseError(<span class="ss">f"Cannot read file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>) <span class="im">from</span> e</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    frontmatter, _ <span class="op">=</span> parse_frontmatter(content)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    metadata <span class="op">=</span> SkillMetadata.model_validate(frontmatter)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    skill_name_from_dir <span class="op">=</span> skill_path.parent.name</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> metadata.name <span class="op">!=</span> skill_name_from_dir:</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>        logger.warning(</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Skill name '</span><span class="sc">%s</span><span class="st">' doesn't match directory name '</span><span class="sc">%s</span><span class="st">' at </span><span class="sc">%s</span><span class="st">"</span>,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>            metadata.name,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>            skill_name_from_dir,</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>            skill_path,</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SkillInfo.from_metadata(metadata, skill_path)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="error-handling-3" class="level3">
<h3 class="anchored" data-anchor-id="error-handling-3">Error Handling</h3>
<ul>
<li><strong>Missing SKILL.md</strong>: Directory is skipped</li>
<li><strong>Invalid YAML</strong>: Warning logged, skill not loaded</li>
<li><strong>Missing required fields</strong>: Validation error</li>
<li><strong>Duplicate names</strong>: Later occurrence is skipped with warning</li>
</ul>
</section>
</section>
<section id="skill-metadata-fields-2" class="level2">
<h2 class="anchored" data-anchor-id="skill-metadata-fields-2">Skill Metadata Fields</h2>
<section id="required-fields" class="level3">
<h3 class="anchored" data-anchor-id="required-fields">Required Fields</h3>
<ol type="1">
<li><strong><code>name</code></strong> (str): Skill identifier
<ul>
<li>Must match directory name</li>
<li>Lowercase letters, numbers, and hyphens only</li>
<li>Pattern: <code>^[a-z0-9]+(-[a-z0-9]+)*$</code></li>
<li>Max length: 64 characters</li>
<li>Min length: 1 character</li>
</ul></li>
<li><strong><code>description</code></strong> (str): What the skill does
<ul>
<li>Must be at least 1 character</li>
<li>Max length: 1024 characters</li>
</ul></li>
</ol>
</section>
<section id="optional-fields" class="level3">
<h3 class="anchored" data-anchor-id="optional-fields">Optional Fields</h3>
<ol type="1">
<li><strong><code>license</code></strong> (str | None): License name or reference
<ul>
<li>Can reference bundled license file</li>
<li>No length restrictions</li>
</ul></li>
<li><strong><code>compatibility</code></strong> (str | None): Environment requirements
<ul>
<li>Can specify product, system packages, etc.</li>
<li>Max length: 500 characters</li>
</ul></li>
<li><strong><code>metadata</code></strong> (dict[str, str]): Arbitrary key-value mapping
<ul>
<li>Keys and values are converted to strings</li>
<li>Used for additional metadata</li>
</ul></li>
<li><strong><code>allowed-tools</code></strong> (list[str]): Pre-approved tools (experimental)
<ul>
<li>Space-delimited list in YAML</li>
<li>Can be list in YAML or space-separated string</li>
<li>Limits which tools the skill can use</li>
</ul></li>
<li><strong><code>user-invocable</code></strong> (bool): Controls slash command menu appearance
<ul>
<li>Default: <code>true</code></li>
<li>When <code>true</code>: Skill appears in slash command menu</li>
<li>When <code>false</code>: Skill is documentation-only</li>
</ul></li>
</ol>
</section>
<section id="field-validation" class="level3">
<h3 class="anchored" data-anchor-id="field-validation">Field Validation</h3>
<p>The skill metadata goes through Pydantic validation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SkillMetadata(BaseModel):</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    model_config <span class="op">=</span> {<span class="st">"populate_by_name"</span>: <span class="va">True</span>}</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span> <span class="op">=</span> Field(</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>        ...,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>        min_length<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>        max_length<span class="op">=</span><span class="dv">64</span>,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>        pattern<span class="op">=</span><span class="vs">r"</span><span class="dv">^</span><span class="pp">[a-z0-9]</span><span class="op">+</span><span class="kw">(</span><span class="vs">-</span><span class="pp">[a-z0-9]</span><span class="op">+</span><span class="kw">)</span><span class="op">*</span><span class="dv">$</span><span class="vs">"</span>,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"Skill identifier. Lowercase letters, numbers, and hyphens only."</span>,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    description: <span class="bu">str</span> <span class="op">=</span> Field(</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>        ...,</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>        min_length<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>        max_length<span class="op">=</span><span class="dv">1024</span>,</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"What this skill does and when to use it."</span>,</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... other fields with validation</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="skill-integration-with-the-system" class="level2">
<h2 class="anchored" data-anchor-id="skill-integration-with-the-system">Skill Integration with the System</h2>
<section id="system-prompt-integration" class="level3">
<h3 class="anchored" data-anchor-id="system-prompt-integration">System Prompt Integration</h3>
<p>Skills are included in the system prompt when <code>include_prompt_detail</code> is enabled:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_universal_system_prompt(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    tool_manager: ToolManager,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    config: VibeConfig,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    skill_manager: SkillManager,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    agent_manager: AgentManager,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    sections <span class="op">=</span> [config.system_prompt]</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... other sections</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> config.include_prompt_detail:</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ... tool prompts</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>        skills_section <span class="op">=</span> _get_available_skills_section(skill_manager)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> skills_section:</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>            sections.append(skills_section)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ... other sections</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>.join(sections)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="skill-section-format" class="level3">
<h3 class="anchored" data-anchor-id="skill-section-format">Skill Section Format</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb111"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a># Available Skills</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>You have access to the following skills. When a task matches a skill's description,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>read the full SKILL.md file to load detailed instructions.</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">available_skills</span>&gt;</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">skill</span>&gt;</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">name</span>&gt;skill-name&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">description</span>&gt;Skill description&lt;/<span class="kw">description</span>&gt;</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">path</span>&gt;/path/to/skill/SKILL.md&lt;/<span class="kw">path</span>&gt;</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  &lt;/<span class="kw">skill</span>&gt;</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">available_skills</span>&gt;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="html-escaping" class="level3">
<h3 class="anchored" data-anchor-id="html-escaping">HTML Escaping</h3>
<p>Skill metadata is HTML-escaped before inclusion in the prompt to prevent injection:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>lines.append(<span class="ss">f"    &lt;name&gt;</span><span class="sc">{</span>html<span class="sc">.</span>escape(<span class="bu">str</span>(name))<span class="sc">}</span><span class="ss">&lt;/name&gt;"</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>lines.append(</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"    &lt;description&gt;</span><span class="sc">{</span>html<span class="sc">.</span>escape(<span class="bu">str</span>(info.description))<span class="sc">}</span><span class="ss">&lt;/description&gt;"</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>lines.append(<span class="ss">f"    &lt;path&gt;</span><span class="sc">{</span>html<span class="sc">.</span>escape(<span class="bu">str</span>(info.skill_path))<span class="sc">}</span><span class="ss">&lt;/path&gt;"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="skill-discovery-paths-1" class="level2">
<h2 class="anchored" data-anchor-id="skill-discovery-paths-1">Skill Discovery Paths</h2>
<p>The skill system searches for skills in multiple locations:</p>
<section id="default-search-paths-1" class="level3">
<h3 class="anchored" data-anchor-id="default-search-paths-1">Default Search Paths</h3>
<ol type="1">
<li><strong>Global Skills Directory</strong>: <code>~/.vibe/skills/</code></li>
<li><strong>Local Project Skills</strong>: <code>.vibe/skills/</code> in current working directory</li>
<li><strong>Custom Paths</strong>: Configured in <code>config.toml</code> via <code>skill_paths</code></li>
</ol>
</section>
<section id="discovery-order" class="level3">
<h3 class="anchored" data-anchor-id="discovery-order">Discovery Order</h3>
<p>Skills are discovered in this order (later paths override earlier ones): 1. Custom paths (from <code>skill_paths</code>) 2. Local project skills (<code>.vibe/skills/</code>) 3. Global skills (<code>~/.vibe/skills/</code>)</p>
</section>
<section id="path-resolution" class="level3">
<h3 class="anchored" data-anchor-id="path-resolution">Path Resolution</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="at">@staticmethod</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _compute_search_paths(config: VibeConfig) <span class="op">-&gt;</span> <span class="bu">list</span>[Path]:</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    paths: <span class="bu">list</span>[Path] <span class="op">=</span> []</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> config.skill_paths:</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path.is_dir():</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>            paths.append(path)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (skills_dir <span class="op">:=</span> resolve_local_skills_dir(Path.cwd())) <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>        paths.append(skills_dir)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> GLOBAL_SKILLS_DIR.path.is_dir():</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>        paths.append(GLOBAL_SKILLS_DIR.path)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>    unique: <span class="bu">list</span>[Path] <span class="op">=</span> []</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> paths:</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>        rp <span class="op">=</span> p.resolve()</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rp <span class="kw">not</span> <span class="kw">in</span> unique:</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>            unique.append(rp)</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> unique</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="duplicate-handling" class="level3">
<h3 class="anchored" data-anchor-id="duplicate-handling">Duplicate Handling</h3>
<p>If the same skill is found in multiple locations: - The first occurrence is kept - Later occurrences are skipped - A debug message is logged</p>
</section>
</section>
<section id="skill-management-and-configuration" class="level2">
<h2 class="anchored" data-anchor-id="skill-management-and-configuration">Skill Management and Configuration</h2>
<section id="enabling-and-disabling-skills" class="level3">
<h3 class="anchored" data-anchor-id="enabling-and-disabling-skills">Enabling and Disabling Skills</h3>
<p>Skills can be enabled or disabled using patterns in configuration:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb114"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.vibe/config.toml</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable specific skills</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled_skills</span> <span class="op">=</span> <span class="op">[</span><span class="st">"code-review"</span><span class="op">,</span> <span class="st">"test-*"</span><span class="op">]</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Disable specific skills</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="dt">disabled_skills</span> <span class="op">=</span> <span class="op">[</span><span class="st">"experimental-*"</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pattern-matching-1" class="level3">
<h3 class="anchored" data-anchor-id="pattern-matching-1">Pattern Matching</h3>
<p>Vibe supports three types of patterns:</p>
<ol type="1">
<li><strong>Exact names</strong>: <code>"code-review"</code> matches only “code-review”</li>
<li><strong>Glob patterns</strong>: <code>"test-*"</code> matches “test-1”, “test-2”, etc.</li>
<li><strong>Regex patterns</strong>: <code>"re:^serena_.*$"</code> matches regex pattern</li>
</ol>
</section>
<section id="configuration-logic" class="level3">
<h3 class="anchored" data-anchor-id="configuration-logic">Configuration Logic</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="at">@property</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> available_skills(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">str</span>, SkillInfo]:</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>._config.enabled_skills:</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>            name: info</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> name, info <span class="kw">in</span> <span class="va">self</span>._available.items()</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> name_matches(name, <span class="va">self</span>._config.enabled_skills)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>._config.disabled_skills:</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>            name: info</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> name, info <span class="kw">in</span> <span class="va">self</span>._available.items()</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> name_matches(name, <span class="va">self</span>._config.disabled_skills)</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">dict</span>(<span class="va">self</span>._available)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="priority-rules" class="level3">
<h3 class="anchored" data-anchor-id="priority-rules">Priority Rules</h3>
<ul>
<li>If <code>enabled_skills</code> is set: Only those skills are available</li>
<li>If <code>disabled_skills</code> is set (and <code>enabled_skills</code> not set): All skills except disabled ones</li>
<li>If neither is set: All discovered skills are available</li>
</ul>
</section>
</section>
<section id="skills-and-slash-commands" class="level2">
<h2 class="anchored" data-anchor-id="skills-and-slash-commands">Skills and Slash Commands</h2>
<p>Skills can appear as slash commands in the UI when <code>user_invocable</code> is <code>true</code>.</p>
<section id="user-invocable-skills" class="level3">
<h3 class="anchored" data-anchor-id="user-invocable-skills">User-Invocable Skills</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb116"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> code-review</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> Perform automated code reviews</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">license</span><span class="kw">:</span><span class="at"> MIT</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">compatibility</span><span class="kw">:</span><span class="at"> Python 3.12+</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="fu">user-invocable</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="co">  # This makes it appear in slash command menu</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="fu">allowed-tools</span><span class="kw">:</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> read_file</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> grep</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> ask_user_question</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="slash-command-format" class="level3">
<h3 class="anchored" data-anchor-id="slash-command-format">Slash Command Format</h3>
<p>When a skill is user-invocable, it appears in the slash command menu as: <code>/skill-name</code> or <code>/skill name</code> (spaces replaced with hyphens)</p>
</section>
<section id="invocation-behavior" class="level3">
<h3 class="anchored" data-anchor-id="invocation-behavior">Invocation Behavior</h3>
<p>When a user invokes a skill via slash command: 1. The skill’s <code>SKILL.md</code> file is read 2. The description and instructions are displayed 3. The agent can use the skill’s allowed tools 4. The skill’s context is included in the conversation</p>
</section>
</section>
<section id="best-practices-for-creating-skills" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-for-creating-skills">Best Practices for Creating Skills</h2>
<section id="clear-and-descriptive-names" class="level3">
<h3 class="anchored" data-anchor-id="clear-and-descriptive-names">1. Clear and Descriptive Names</h3>
<ul>
<li>Use lowercase with hyphens: <code>code-review</code>, <code>test-generator</code></li>
<li>Be specific about the skill’s purpose</li>
<li>Avoid generic names like <code>helper</code> or <code>assistant</code></li>
</ul>
</section>
<section id="comprehensive-descriptions" class="level3">
<h3 class="anchored" data-anchor-id="comprehensive-descriptions">2. Comprehensive Descriptions</h3>
<ul>
<li>Explain what the skill does</li>
<li>Include when to use it</li>
<li>Mention any prerequisites or requirements</li>
</ul>
</section>
<section id="detailed-documentation" class="level3">
<h3 class="anchored" data-anchor-id="detailed-documentation">3. Detailed Documentation</h3>
<ul>
<li>Provide clear instructions in the markdown body</li>
<li>Include examples of usage</li>
<li>Document any limitations or constraints</li>
</ul>
</section>
<section id="appropriate-tool-restrictions" class="level3">
<h3 class="anchored" data-anchor-id="appropriate-tool-restrictions">4. Appropriate Tool Restrictions</h3>
<ul>
<li>List only the tools needed for the skill</li>
<li>Avoid giving unnecessary permissions</li>
<li>Consider security implications</li>
</ul>
</section>
<section id="versioning-and-compatibility" class="level3">
<h3 class="anchored" data-anchor-id="versioning-and-compatibility">5. Versioning and Compatibility</h3>
<ul>
<li>Specify compatibility requirements</li>
<li>Document breaking changes</li>
<li>Consider versioning your skills</li>
</ul>
</section>
<section id="testing" class="level3">
<h3 class="anchored" data-anchor-id="testing">6. Testing</h3>
<ul>
<li>Test your skill in different scenarios</li>
<li>Verify it works with the allowed tools</li>
<li>Check that the documentation is clear</li>
</ul>
</section>
</section>
<section id="complete-example-creating-a-custom-skill" class="level2">
<h2 class="anchored" data-anchor-id="complete-example-creating-a-custom-skill">Complete Example: Creating a Custom Skill</h2>
<section id="step-1-create-skill-directory" class="level3">
<h3 class="anchored" data-anchor-id="step-1-create-skill-directory">Step 1: Create Skill Directory</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb117"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.vibe/skills/code-review</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-2-create-skill.md-file" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-skill.md-file">Step 2: Create SKILL.md File</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb118"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.vibe/skills/code-review/SKILL.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="step-3-define-skill-metadata-and-documentation" class="level3">
<h3 class="anchored" data-anchor-id="step-3-define-skill-metadata-and-documentation">Step 3: Define Skill Metadata and Documentation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb119"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> code-review</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> Perform automated code reviews to identify issues and suggest improvements</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> MIT</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="an">compatibility:</span><span class="co"> Python 3.12+</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="an">user-invocable:</span><span class="co"> true</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="an">allowed-tools:</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - read_file</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - grep</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - ask_user_question</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code Review Skill</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>This skill helps analyze code quality and suggest improvements.</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Features</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Identifies common code smells</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Checks for missing documentation</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Suggests refactoring opportunities</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Verifies coding standards compliance</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Usage</span></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>When performing a code review, this skill will:</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Analyze the code structure</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Check for common issues</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Suggest improvements</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Provide detailed feedback</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Limitations</span></span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Only analyzes Python code</span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Requires proper file permissions</span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>May miss context-specific issues</span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examples</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<blockquote class="blockquote">
<p>/code-review</p>
</blockquote>
<p>🤖 I’ll perform a code review of the current project.</p>
<blockquote class="blockquote">
<p>read_file(path=“src/main.py”) grep(pattern=“TODO”, path=“src/”) ask_user_question(questions=[{ “question”: “What coding standards should I check?”, “options”: [ {“label”: “PEP 8”, “description”: “Python style guide”}, {“label”: “Custom”, “description”: “Project-specific rules”}] }])</p>
</blockquote>
<pre><code></code></pre>
</section>
<section id="step-4-verify-skill-discovery" class="level3">
<h3 class="anchored" data-anchor-id="step-4-verify-skill-discovery">Step 4: Verify Skill Discovery</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb121"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="ex">vibe</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Check that the skill appears in the system prompt or slash command menu.</p>
</section>
<section id="step-5-test-the-skill" class="level3">
<h3 class="anchored" data-anchor-id="step-5-test-the-skill">Step 5: Test the Skill</h3>
<pre><code>&gt; /code-review</code></pre>
<p>Or let the agent use it automatically when appropriate.</p>
</section>
</section>
<section id="advanced-project-specific-skills" class="level2">
<h2 class="anchored" data-anchor-id="advanced-project-specific-skills">Advanced: Project-Specific Skills</h2>
<p>You can also create skills specific to a project:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb123"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In your project directory</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> .vibe/skills/project-docs</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> .vibe/skills/project-docs/SKILL.md</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb124"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> project-docs</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> Generate and maintain project-specific documentation</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> MIT</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="an">compatibility:</span><span class="co"> Python 3.12+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="an">user-invocable:</span><span class="co"> true</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="an">allowed-tools:</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - read_file</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - grep</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - write_file</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Project Documentation Skill</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>This skill helps generate documentation specific to this project.</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Features</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analyzes project structure</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generates API documentation</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Creates README files</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Updates documentation based on code changes</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Project-Specific Rules</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Follow the project's documentation style</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Include project-specific examples</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reference project-specific components</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-4" class="level2">
<h2 class="anchored" data-anchor-id="summary-4">Summary</h2>
<p>The skills system in Mistral Vibe provides a powerful way to extend functionality:</p>
<ol type="1">
<li><strong>Skill Structure</strong>: Directories with <code>SKILL.md</code> files containing YAML frontmatter</li>
<li><strong>Discovery</strong>: Automatic discovery from multiple paths</li>
<li><strong>Metadata</strong>: Comprehensive metadata with validation</li>
<li><strong>Integration</strong>: System prompt and slash command integration</li>
<li><strong>Configuration</strong>: Enable/disable via patterns</li>
<li><strong>Security</strong>: Tool restrictions and HTML escaping</li>
</ol>
<section id="key-benefits" class="level3">
<h3 class="anchored" data-anchor-id="key-benefits">Key Benefits</h3>
<ul>
<li><strong>Reusability</strong>: Skills can be shared across projects</li>
<li><strong>Documentation</strong>: Built-in documentation system</li>
<li><strong>Extensibility</strong>: Easy to add new skills</li>
<li><strong>Control</strong>: Fine-grained enable/disable patterns</li>
<li><strong>User-Friendly</strong>: Slash command integration</li>
</ul>
<p>By understanding how skills work, you can create custom skills to extend Mistral Vibe’s capabilities for your specific needs and workflows.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/wordslab-org\.github\.io\/wordslab-notebooks-lib");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/wordslab-org/wordslab-notebooks-lib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>