<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Answerai tools study – wordslab-notebooks-lib</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Answerai tools study – wordslab-notebooks-lib">
<meta property="og:description" content="Python library to help with AI usage in wordslab-notebooks">
<meta property="og:site_name" content="wordslab-notebooks-lib">
<meta name="twitter:title" content="Answerai tools study – wordslab-notebooks-lib">
<meta name="twitter:description" content="Python library to help with AI usage in wordslab-notebooks">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">wordslab-notebooks-lib</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tools_study_answerai.html">Answerai tools study</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.core</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.env</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.chat</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_answerai.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Answerai tools study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_anthropic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anthropic tools study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_mistral-vibe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mistral vibe 2.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.notebook</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary-answerai-tools-signatures" id="toc-summary-answerai-tools-signatures" class="nav-link active" data-scroll-target="#summary-answerai-tools-signatures">Summary: answerai tools signatures</a></li>
  <li><a href="#solveit-tool-exploration" id="toc-solveit-tool-exploration" class="nav-link" data-scroll-target="#solveit-tool-exploration">Solveit tool exploration</a>
  <ul class="collapse">
  <li><a href="#librairies-providing-tools" id="toc-librairies-providing-tools" class="nav-link" data-scroll-target="#librairies-providing-tools">Librairies providing tools</a></li>
  <li><a href="#summary-answer.ai-tools-for-llm-development" id="toc-summary-answer.ai-tools-for-llm-development" class="nav-link" data-scroll-target="#summary-answer.ai-tools-for-llm-development">Summary: Answer.AI Tools for LLM Development</a></li>
  <li><a href="#details-of-the-tools-available-in-these-libraries" id="toc-details-of-the-tools-available-in-these-libraries" class="nav-link" data-scroll-target="#details-of-the-tools-available-in-these-libraries">Details of the tools available in these libraries</a></li>
  <li><a href="#fastcore" id="toc-fastcore" class="nav-link" data-scroll-target="#fastcore">fastcore</a></li>
  <li><a href="#librairies-using-tools" id="toc-librairies-using-tools" class="nav-link" data-scroll-target="#librairies-using-tools">Librairies using tools</a></li>
  <li><a href="#development-tools" id="toc-development-tools" class="nav-link" data-scroll-target="#development-tools">Development tools</a></li>
  </ul></li>
  <li><a href="#tools-catalog" id="toc-tools-catalog" class="nav-link" data-scroll-target="#tools-catalog">Tools catalog</a>
  <ul class="collapse">
  <li><a href="#enhance-ipython-kernel" id="toc-enhance-ipython-kernel" class="nav-link" data-scroll-target="#enhance-ipython-kernel">Enhance IPython kernel</a></li>
  <li><a href="#web-access" id="toc-web-access" class="nav-link" data-scroll-target="#web-access">Web access</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/wordslab-org/wordslab-notebooks-lib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="tools_study_answerai.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Answerai tools study</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="summary-answerai-tools-signatures" class="level2">
<h2 class="anchored" data-anchor-id="summary-answerai-tools-signatures">Summary: answerai tools signatures</h2>
<div id="9b23b994-27e3-4bad-8651-b31f3ad0f44f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- fastcore.tools --</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of Anthropic file and text editor tools</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rg(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    argstr:<span class="bu">str</span>, <span class="co"># All args to the command, will be split with shlex</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    disallow_re:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># optional regex which, if matched on argstr, will disallow the command</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    allow_re:<span class="bu">str</span><span class="op">=</span><span class="va">None</span> <span class="co"># optional regex which, if not matched on argstr, will disallow the command</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Run the `rg` command with the args in `argstr`"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sed(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    argstr:<span class="bu">str</span>, <span class="co"># All args to the command, will be split with shlex</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    disallow_re:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># optional regex which, if matched on argstr, will disallow the command</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    allow_re:<span class="bu">str</span><span class="op">=</span><span class="va">None</span> <span class="co"># optional regex which, if not matched on argstr, will disallow the command</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Run the `sed` command with the args in `argstr` (e.g for reading a section of a file)"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> view(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    path:<span class="bu">str</span>, <span class="co"># Path to directory or file to view</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    view_range:<span class="bu">tuple</span>[<span class="bu">int</span>,<span class="bu">int</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Optional 1-indexed (start, end) line range for files, end=-1 for EOF. Do NOT use unless it's known that the file is too big to keep in context—simply view the WHOLE file when possible</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Whether to show line numbers</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    skip_folders:<span class="bu">tuple</span>[<span class="bu">str</span>,...]<span class="op">=</span>(<span class="st">'_proc'</span>,<span class="st">'__pycache__'</span>) <span class="co"># Folder names to skip when listing directories</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">'View directory or file contents with optional line range and numbers'</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span>, <span class="co"># Path where the new file should be created</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    file_text: <span class="bu">str</span>, <span class="co"># Content to write to the file</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    overwrite:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># Whether to overwrite existing files</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Creates a new file with the given content at the specified path'</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert(</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span>, <span class="co"># Path to the file to modify</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    insert_line: <span class="bu">int</span>, <span class="co"># Line number where to insert (0-based indexing)</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    new_str: <span class="bu">str</span> <span class="co"># Text to insert at the specified line</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Insert new_str at specified line number'</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> str_replace(</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span>, <span class="co"># Path to the file to modify</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    old_str: <span class="bu">str</span>, <span class="co"># Text to find and replace</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    new_str: <span class="bu">str</span> <span class="co"># Text to replace with</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Replace first occurrence of old_str with new_str in file'</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> strs_replace(</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    path:<span class="bu">str</span>, <span class="co"># Path to the file to modify</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    old_strs:<span class="bu">list</span>[<span class="bu">str</span>], <span class="co"># List of strings to find and replace</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    new_strs:<span class="bu">list</span>[<span class="bu">str</span>], <span class="co"># List of replacement strings (must match length of old_strs)</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Replace for each str pair in old_strs,new_strs"</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> [str_replace(path, old, new) <span class="cf">for</span> (old,new) <span class="kw">in</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> replace_lines(</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    path:<span class="bu">str</span>, <span class="co"># Path to the file to modify</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    start_line:<span class="bu">int</span>, <span class="co"># Starting line number to replace (1-based indexing)</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    end_line:<span class="bu">int</span>, <span class="co"># Ending line number to replace (1-based indexing, inclusive)</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    new_content:<span class="bu">str</span>, <span class="co"># New content to replace the specified lines</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Replace lines in file using start and end line-numbers (index starting at 1)"</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> move_lines(</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    path: <span class="bu">str</span>,  <span class="co"># Path to the file to modify</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    start_line: <span class="bu">int</span>,  <span class="co"># Starting line number to move (1-based)</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    end_line: <span class="bu">int</span>,  <span class="co"># Ending line number to move (1-based, inclusive)</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    dest_line: <span class="bu">int</span>,  <span class="co"># Destination line number (1-based, where lines will be inserted before)</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Move lines from start_line:end_line to before dest_line"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7647f40e-19ba-4f44-96b8-2f6229ebb5c9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- claudette.text_editor --</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Other implementation of Anthropic text editor tools</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> view(path:<span class="bu">str</span>,  <span class="co"># The path to the file or directory to view</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         view_range:<span class="bu">tuple</span>[<span class="bu">int</span>,<span class="bu">int</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Optional array of two integers specifying the start and end line numbers to view. Line numbers are 1-indexed, and -1 for the end line means read to the end of the file. This parameter only applies when viewing files, not directories.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># Optionally prefix all lines of the file with a line number</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Examine the contents of a file or list the contents of a directory. It can read the entire file or a specific range of lines. With or without line numbers.'</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create(path: <span class="bu">str</span>, <span class="co"># The path where the new file should be created</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>           file_text: <span class="bu">str</span>, <span class="co"># The text content to write to the new file</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>           overwrite:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># Allows overwriting an existing file</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>          ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Creates a new file with the given text content at the specified path'</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert(path: <span class="bu">str</span>,  <span class="co"># The path to the file to modify</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>           insert_line: <span class="bu">int</span>, <span class="co"># The line number after which to insert the text (0 for beginning of file)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>           new_str: <span class="bu">str</span> <span class="co"># The text to insert</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>          ) <span class="op">-&gt;</span> <span class="bu">str</span>: </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Insert text at a specific line number in a file.'</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> str_replace(path: <span class="bu">str</span>, <span class="co"># The path to the file to modify</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                old_str: <span class="bu">str</span>, <span class="co"># The text to replace (must match exactly, including whitespace and indentation)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                new_str: <span class="bu">str</span> <span class="co"># The new text to insert in place of the old text</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>               ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Replace a specific string in a file with a new string. This is used for making precise edits.'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2ae7ea5a-988f-4993-af94-429a6dc4f485" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- ipykernelhelper --</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the html content of a web page using the cloudscraper library to bypass Cloudflare's anti-bot page</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and convert it to markdown prepared for insertion in the LLM context</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_url(url: <span class="bu">str</span>, as_md: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>             extract_section: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, selector: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>             math_mode: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""This functions extracts a web page information for LLM ingestion</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Downloads a web page</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Parses HTML</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    3. Optionally extracts a specific section (fragment or CSS selector)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">    4. Converts MathML → LaTeX</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    5. Optionally converts HTML → Markdown</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">    6. Convert code sections to fenced markdown blocks</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">    7. Makes image URLs absolute</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">    8. Returns the processed text</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="3c2e7738-a4fe-4893-ba88-aa5ccfe50e21" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- dialoghelper.core --</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tools to edit the Jupyter notebook</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dialoghelper_explain_dialog_editing(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">str</span>: <span class="co"># Detailed documention on dialoghelper dialog editing</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Call this to get a detailed explanation of how dialog editing is done in dialoghelper. Always use if doing anything non-trivial, or if dialog editing has not previously occured in this session"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"""# dialoghelper dialog editing functionality</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">This guide consolidates understanding of how dialoghelper tools work together. Individual tool schemas are already in context—this adds architectural insight and usage patterns.</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">## Core Concepts</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="st">- **Dialog addressing**: All functions accepting `dname` resolve paths relative to current dialog (no leading `/`) or absolute from Solveit's runtime data path (with leading `/`). The `.ipynb` extension is never included.</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="st">- **Message addressing**: Messages have stable `id` strings (e.g., `_a9cb5512`). The current executing message's id is in `__msg_id`. Tools use `id` for targeting; `find_msg_id()` retrieves current.</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">- **Implicit state**: After `add_msg`/`update_msg`, `__msg_id` is updated to the new/modified message. This enables chaining: successive `add_msg` calls create messages in sequence.</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="st">## Tool Workflow Patterns</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="st">### Reading dialog state</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="st">- `view_dlg` — fastest way to see entire dialog structure with line numbers for editing</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="st">- `find_msgs` — search with regex, filter by type/errors/changes</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="st">- `read_msg` — navigate relative to current message</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="st">- `read_msgid` — direct access when you have the id</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="st">**Key insight**: Messages above the current prompt are already in LLM context. Use read tools only for: (1) getting line numbers for edits, (2) accessing messages below current prompt, (3) accessing other dialogs.</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="st">### Modifying dialogs</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="st">- `add_msg` — placement can be `add_after`/`add_before` (relative to current) or `at_start`/`at_end` (absolute)</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="st">  - **NB** When not passing a message id, it defaults to the *current* message. So if you call it multiple times with no message id, the messages will be added in REVERSE! Instead, get the return value of `add_msg` after each call, and use that for the next call</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="st">- `update_msg` — partial updates; only pass fields to change</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="st">- `del_msg` — use sparingly, only when explicitly requested</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="st">`copy_msg` → `paste_msg` — for moving/duplicating messages within running dialogs.</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="st">## Non-decorated Functions Worth Knowing</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="st">There are additional functions available that can be added to fenced blocks, or the user may add as tools; they are not included in schemas by default.</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="st">**Browser integration:**</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="st">- `add_html(content)` — inject HTML with `hx-swap-oob` into live browser DOM</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="st">- `iife(code)` — execute JavaScript immediately in browser</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="st">- `fire_event(evt, data)` / `event_get(evt)` — trigger/await browser events</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="st">**Content helpers:**</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="st">- `url2note(url, ...)` — fetch URL as markdown, add as note message</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="st">- `mermaid(code)` / `enable_mermaid()` — render mermaid diagrams</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="st">- `add_styles(s)` — apply solveit's MonsterUI styling to HTML</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="st">**Dangerous (not exposed by default):**</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="st">- `_add_msg_unsafe(content, run=True, ...)` — add AND execute message (code or prompt)</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="st">- `run_msg(ids)` — queue messages for execution</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="st">- `rm_dialog(name)` — delete entire dialog</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="st">## Important Patterns</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="st">### Key Principles</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="st">1. **Always re-read before editing.** Past tool call results in chat history are TRUNCATED. Never rely on line numbers from earlier in the conversation—call `read_msgid(id, nums=True)` immediately before any edit operation.</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="st">2. **Work backwards.** When making multiple edits to a message, start from the end and work towards the beginning. This prevents line number shifts from invalidating your planned edits.</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="st">3. **Don't guess when tools fail.** If a tool call returns an error, STOP and ask for clarification. Do not retry with guessed parameters.</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="st">4. **Verify after complex edits.** After significant changes, re-read the affected region to confirm the edit worked as expected before proceeding.</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="st">### Typical Workflow</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a><span class="st">1. read_msgid(id, nums=True)           # Get current state with line numbers</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a><span class="st">2. Identify lines to change</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="st">3. msg_replace_lines(...) or msg_str_replace(...)  # Make edit</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="st">4. If more edits needed: re-read, then repeat from step 2</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="st">### Tool Selection</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="st">- **`msg_replace_lines`**: Best for replacing/inserting contiguous blocks. Use `view_range` on read to focus on the area.</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="st">- **`msg_str_replace`**: Best for targeted single small string replacements when you know the exact text.</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="st">- **`msg_strs_replace`**: Best for multiple small independent replacements in one call.</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="st">- **`msg_insert_line`**: Best for adding new content without replacing existing lines.</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="st">- **`msg_del_lines`**: Best for removing content.</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a><span class="st">**Rough rule of thumb:** Prefer `msg_replace_lines` over `msg_str(s)_replace` unless there's &gt;1 match to change or it's just a word or two. Use the insert/delete functions for inserting/deleting; don't use `msg_str(s)_replace` for that.</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="st">### Common Mistakes to Avoid</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a><span class="st">- Using line numbers from a truncated earlier result</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="st">- Making multiple edits without re-reading between them</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="st">- Guessing line numbers when a view_range was truncated</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a><span class="st">- Always call `read_msgid(id, nums=True)` first to get accurate line numbers</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a><span class="st">- String-based tools (`msg_str_replace`, `msg_strs_replace`) fail if the search string appears zero or multiple times—use exact unique substrings."""</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> curr_dialog(</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    with_messages:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>,  <span class="co"># Include messages as well?</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Dialog to get info for; defaults to current dialog</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get the current dialog info."</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> view_dlg(</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Dialog to get info for; defaults to current dialog</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    msg_type:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># optional limit by message type ('code', 'note', or 'prompt')</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>    nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Whether to show line numbers</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>    include_output:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Include output in returned dict?</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>    trunc_out:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Middle-out truncate code output to 100 characters (only applies if `include_output`)?</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>    trunc_in:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Middle-out truncate cell content to 80 characters?</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Concise XML view of all messages (optionally filtered by type), not including metadata. Often it is more efficient to call this to see the whole dialog at once (including line numbers if needed), instead of running `find_msgs` or `read_msg` multiple times."</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> find_msgs(msg_type<span class="op">=</span>msg_type, dname<span class="op">=</span>dname, as_xml<span class="op">=</span><span class="va">True</span>, nums<span class="op">=</span>nums,</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>        include_meta<span class="op">=</span><span class="va">False</span>, include_output<span class="op">=</span>include_output, trunc_out<span class="op">=</span>trunc_out, trunc_in<span class="op">=</span>trunc_in)</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msg_idx(</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Message id to find (defaults to current message)</span></span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Dialog to get message index from; defaults to current dialog</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get absolute index of message in dialog."</span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_msgs(</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>    re_pattern:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Optional regex to search for (re.DOTALL+re.MULTILINE is used)</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>    msg_type:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># optional limit by message type ('code', 'note', or 'prompt')</span></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>    use_case:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Use case-sensitive matching?</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>    use_regex:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Use regex matching?</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>    only_err:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Only return messages that have errors?</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>    only_exp:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Only return messages that are exported?</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>    only_chg:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Only return messages that have changed vs git HEAD?</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>    ids:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Optionally filter by comma-separated list of message ids</span></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>    limit:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Optionally limit number of returned items</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>    include_output:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Include output in returned dict?</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>    include_meta:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Include all additional message metadata</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>    as_xml:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Use concise unescaped XML output format</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>    nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Show line numbers?</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    trunc_out:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Middle-out truncate code output to 100 characters?</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    trunc_in:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Middle-out truncate cell content to 80 characters?</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>    headers_only:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Only return note messages that are headers (first line only); cannot be used together with `header_section`</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>    header_section:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Find section starting with this header; returns it plus all children (i.e until next header of equal or more significant level)</span></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Dialog to get info for; defaults to current dialog</span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">list</span>[<span class="bu">dict</span>]: <span class="co"># Messages in requested dialog that contain the given information</span></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Often it is more efficient to call `view_dlg` to see the whole dialog at once, so you can use it all from then on, instead of using `find_msgs`.</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a><span class="co">    {dname}</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a><span class="co">    Message ids are identical to those in LLM chat history, so do NOT call this to view a specific message if it's in the chat history--instead use `read_msgid`.</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a><span class="co">    Do NOT use find_msgs to view message content in the current dialog above the current prompt -- these are *already* provided in LLM context, so just read the content there directly. (NB: LLM context only includes messages *above* the current prompt, whereas `find_msgs` can access *all* messages.)</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a><span class="co">    To refer to a found message from code or tools, use its `id` field."""</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_msg(</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>    n:<span class="bu">int</span><span class="op">=-</span><span class="dv">1</span>,      <span class="co"># Message index (if relative, +ve is downwards)</span></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>    relative:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,  <span class="co"># Is `n` relative to current message (True) or absolute (False)?</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Message id to find (defaults to current message)</span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>    view_range:<span class="bu">list</span>[<span class="bu">int</span>,<span class="bu">int</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Optional 1-indexed (start, end) line range for files, end=-1 for EOF</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>    nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Whether to show line numbers</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Dialog to get info for; defaults to current dialog</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get the message indexed in the current dialog.</span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a><span class="co">    NB: Messages in the current dialog above the current message are *already* visible; use this only when you need line numbers for editing operations, or for messages not in the current dialog or below the current message.</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a><span class="co">    - To get the exact message use `n=0` and `relative=True` together with `id`.</span></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a><span class="co">    - To get a relative message use `n` (relative position index).</span></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a><span class="co">    - To get the nth message use `n` with `relative=False`, e.g `n=0` first message, `n=-1` last message.</span></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a><span class="co">    {dname}"""</span></span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_msgid(</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span>,  <span class="co"># Message id to find</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>    view_range:<span class="bu">list</span>[<span class="bu">int</span>,<span class="bu">int</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Optional 1-indexed (start, end) line range for files, end=-1 for EOF</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>    nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Whether to show line numbers</span></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Dialog to get message from; defaults to current dialog</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get message `id`. Message IDs can be view directly in LLM chat history/context, or found in `find_msgs` results."""</span></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_msg(</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>    content:<span class="bu">str</span>, <span class="co"># Content of the message (i.e the message prompt, code, or note text)</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>    placement:<span class="bu">str</span><span class="op">=</span><span class="st">'add_after'</span>, <span class="co"># Can be 'at_start' or 'at_end', and for default dname can also be 'add_after' or 'add_before'</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of message that placement is relative to (if None, uses current message; note: each add_msg updates "current" to the newly created message)</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    msg_type: <span class="bu">str</span><span class="op">=</span><span class="st">'note'</span>, <span class="co"># Message type, can be 'code', 'note', or 'prompt'</span></span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    output:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Prompt/code output; Code outputs must be .ipynb-compatible JSON array</span></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>    time_run: <span class="bu">str</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="st">''</span>, <span class="co"># When was message executed</span></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>    is_exported: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="dv">0</span>, <span class="co"># Export message to a module?</span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>    skipped: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="dv">0</span>, <span class="co"># Hide message from prompt?</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>    i_collapsed: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="dv">0</span>, <span class="co"># Collapse input?</span></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>    o_collapsed: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="dv">0</span>, <span class="co"># Collapse output?</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>    heading_collapsed: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="dv">0</span>, <span class="co"># Collapse heading section?</span></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>    pinned: <span class="bu">int</span> <span class="op">|</span> <span class="va">None</span> <span class="op">=</span> <span class="dv">0</span>, <span class="co"># Pin to context?</span></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Dialog to get info for; defaults to current dialog. If passed, provide `id` or use `placement='at_start'`/`'at_end'`</span></span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">str</span>: <span class="co"># Message ID of newly created message</span></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Add/update a message to the queue to show after code execution completes.</span></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a><span class="co">    **NB**: when creating multiple messages in a row, after the 1st message set `id` to the result of the last `add_msg` call,</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a><span class="co">    otherwise messages will appear in the dialog in REVERSE order.</span></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a><span class="co">    {dname}"""</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> del_msg(</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of message to delete</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Dialog to get info for; defaults to current dialog</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>    log_changed:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># Add a note showing the deleted content?</span></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Delete a message from the dialog. DO NOT USE THIS unless you have been explicitly instructed to delete messages."</span></span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_msg(</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of message to update (if None, uses current message)</span></span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>    msg:Optional[Dict]<span class="op">=</span><span class="va">None</span>, <span class="co"># Dictionary of field keys/values to update</span></span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Dialog to get info for; defaults to current dialog</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>    log_changed:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Add a note showing the diff?</span></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs):</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Update an existing message. Provide either `msg` OR field key/values to update.</span></span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a><span class="co">    - Use `content` param to update contents.</span></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a><span class="co">    - Only include parameters to update--missing ones will be left unchanged.</span></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a><span class="co">    {dname}"""</span></span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_msg(</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>    ids:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Comma-separated ids of message(s) to execute</span></span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Running dialog to get info for; defaults to current dialog. (Note dialog *must* be running for this function)</span></span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Adds a message to the run queue. Use read_msg to see the output once it runs."</span></span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> copy_msg(</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>    ids:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Comma-separated ids of message(s) to copy</span></span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>    cut:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Cut message(s)? (If not, copies)</span></span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Running dialog to copy messages from; defaults to current dialog. (Note dialog *must* be running for this function)</span></span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add `ids` to clipboard."</span></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> paste_msg(</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Message id to paste next to</span></span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>    after:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Paste after id? (If not, pastes before)</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>    dname:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Running dialog to copy messages from; defaults to current dialog. (Note dialog *must* be running for this function)</span></span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Paste clipboard msg(s) after/before the current selected msg (id)."</span></span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_code_interactive(</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>    code:<span class="bu">str</span> <span class="co"># Code to have user run</span></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Insert code into user's dialog and request for the user to run it. Use other tools where possible, </span></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a><span class="co">    but if they can not find needed information, *ALWAYS* use this instead of guessing or giving up.</span></span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a><span class="co">    IMPORTANT: This tool is TERMINAL - after calling it, you MUST stop all tool usage </span></span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a><span class="co">    and wait for user response. Never call additional tools after this one."""</span></span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msg_insert_line(text, insert_line:<span class="bu">int</span>, new_str:<span class="bu">str</span>):</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert text at specific line num in message. {besure}</span><span class="ch">\n</span><span class="co">{dname}"</span></span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msg_str_replace(text, old_str:<span class="bu">str</span>, new_str:<span class="bu">str</span>):</span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Replace first occurrence of old_str with new_str in a message.</span><span class="ch">\n</span><span class="co">{dname}"</span></span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msg_strs_replace(text, old_strs:<span class="bu">list</span>[<span class="bu">str</span>], new_strs:<span class="bu">list</span>[<span class="bu">str</span>]):</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Replace multiple strings simultaneously in a message.</span><span class="ch">\n</span><span class="co">{dname}"</span></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msg_replace_lines(text, start_line:<span class="bu">int</span>, end_line:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>, new_content:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>):</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Replace line range in msg with new content. {besure}</span><span class="ch">\n</span><span class="co">{dname}"</span></span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msg_del_lines(text, start_line:<span class="bu">int</span>, end_line:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>):</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Delete line range from a message. {besure}</span><span class="ch">\n</span><span class="co">{dname}"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a3de465c-e148-42e4-867a-791066cca5c2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- dialoghelper.core --</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Import context and code</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> url2note(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    url:<span class="bu">str</span>, <span class="co"># URL to read</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    extract_section:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># If url has an anchor, return only that section</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    selector:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Select section(s) using BeautifulSoup.select (overrides extract_section)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    ai_img:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Make images visible to the AI</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    split_re:<span class="bu">str</span><span class="op">=</span><span class="st">''</span> <span class="co"># Regex to split content into multiple notes, set to '' for single note</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Read URL as markdown, and add note(s) below current message with the result"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ctx_folder(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    path:Path<span class="op">=</span><span class="st">'.'</span>,  <span class="co"># Path to collect</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    types:<span class="bu">str</span><span class="op">|</span><span class="bu">list</span><span class="op">=</span><span class="st">'py,doc'</span>,  <span class="co"># list or comma-separated str of ext types from: py, js, java, c, cpp, rb, r, ex, sh, web, doc, cfg</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    out<span class="op">=</span><span class="va">False</span>, <span class="co"># Include notebook cell outputs?</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    raw<span class="op">=</span><span class="va">True</span>, <span class="co"># Add raw message, or note?</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    exts:<span class="bu">str</span><span class="op">|</span><span class="bu">list</span><span class="op">=</span><span class="va">None</span>, <span class="co"># list or comma-separated str of exts to include (overrides `types`)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert folder to XML context and place in a new message"</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ctx_repo(</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    owner:<span class="bu">str</span>,  <span class="co"># GitHub repo owner</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    repo:<span class="bu">str</span>,   <span class="co"># GitHub repo name</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    types:<span class="bu">str</span><span class="op">|</span><span class="bu">list</span><span class="op">=</span><span class="st">'py,doc'</span>,  <span class="co"># list or comma-separated str of ext types from: py, js, java, c, cpp, rb, r, ex, sh, web, doc, cfg</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    exts:<span class="bu">str</span><span class="op">|</span><span class="bu">list</span><span class="op">=</span><span class="va">None</span>, <span class="co"># list or comma-separated str of exts to include (overrides `types`)</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    out<span class="op">=</span><span class="va">False</span>, <span class="co"># Include notebook cell outputs?</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    raw<span class="op">=</span><span class="va">True</span>, <span class="co"># Add raw message, or note?</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert GitHub repo to XML context and place in a new message"</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ctx_symfile(sym):</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add note with filepath and contents for a symbol's source file"</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ctx_symfile(sym):</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add note with filepath and contents for a symbol's source file"</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ctx_symfolder(</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    sym, <span class="co"># Symbol to get folder context from</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs):</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add raw message with folder context for a symbol's source file location"</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ctx_sympkg(</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    sym, <span class="co"># Symbol to get folder context from</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs):</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add raw message with repo context for a symbol's root package"</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gist_file(gist_id:<span class="bu">str</span>):</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get the first file from a gist"</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ast_grep(</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    pattern:<span class="bu">str</span>, <span class="co"># ast-grep pattern to search, e.g "post($A, data=$B, $$$)"</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    path:<span class="bu">str</span><span class="op">=</span><span class="st">"."</span>, <span class="co"># path to recursively search for files</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    lang:<span class="bu">str</span><span class="op">=</span><span class="st">"python"</span> <span class="co"># language to search/scan</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>): <span class="co"># json format from calling `ast-grep --json=compact</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Use `ast-grep` to find code patterns by AST structure (not text).</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co">    Pattern syntax:</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">    - $VAR captures single nodes, $$$ captures multiple</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co">    - Match structure directly: `def $FUNC($$$)` finds any function; `class $CLASS` finds classes regardless of inheritance</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="co">    - DON'T include `:` - it's concrete syntax, not AST structure</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="co">    - Whitespace/formatting ignored - matches structural equivalence</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples: `import $MODULE` (find imports); `$OBJ.$METHOD($$$)` (find method calls); `await $EXPR` (find await expressions)</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co">    Useful for: Refactoring—find all uses of deprecated APIs or changed signatures; Security review—locate SQL queries, file operations, eval calls; Code exploration—understand how libraries are used across codebase; Pattern analysis—find async functions, error handlers, decorators; Better than regex—handles multi-line code, nested structures, respects syntax"""</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> import_string(</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    code:<span class="bu">str</span>, <span class="co"># Code to import as a module</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    name:<span class="bu">str</span>  <span class="co"># Name of module to create</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> import_gist(</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>    gist_id:<span class="bu">str</span>, <span class="co"># user/id or just id of gist to import as a module</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    mod_name:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># module name to create (taken from gist filename if not passed)</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    add_global:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># add module to caller's globals?</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    import_wildcard:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># import all exported symbols to caller's globals</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    create_msg:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># Add a message that lists usable tools</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Import gist directly from string without saving to disk"</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_gist(gist_id:<span class="bu">str</span>, content:<span class="bu">str</span>):</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Update the first file in a gist with new content"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>tracetool is an LLM tool that traces function execution and captures variable snapshots after each line runs, using Python 3.12’s sys.monitoring for low-overhead tracing.</p>
<p>For each call to the target function (including recursive calls), the LLM receives a stack trace showing how that call was reached, plus a per-line trace dict mapping each executed source line to its hit count and variable snapshots. Variables that don’t change are shown as a single (type, repr) tuple, while those that evolve across iterations appear as a list of snapshots.</p>
<p>This is particularly useful when the LLM needs to understand unfamiliar code by seeing exactly what happens step-by-step, debug issues by watching how variables change, verify loop behavior by confirming iteration counts and accumulator values, or explore recursive functions where each call gets its own trace entry</p>
<div id="2d79decb-7760-4a6a-b5b0-72c2e8ac1c70" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- dialoghelper.capture --</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Screen capture</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> capture_tool(timeout:<span class="bu">int</span><span class="op">=</span><span class="dv">15</span>):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Capture the screen. Re-call this function to get the most recent screenshot, as needed. Use default timeout where possible"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5a199dd5-33d3-4553-888b-4211ac0bb044" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- dialoghelper.tracetools --</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace function execution</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tracetool(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    sym: <span class="bu">str</span>,  <span class="co"># Dotted symbol path of callable to run</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    args: <span class="bu">list</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Positional args for callable (JSON values passed directly)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    kwargs: <span class="bu">dict</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Keyword args for callable (JSON values passed directly)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    target_func: <span class="bu">str</span><span class="op">=</span><span class="va">None</span>  <span class="co"># Dotted symbol path of function to trace (defaults to sym)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">list</span>[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">tuple</span>[<span class="bu">int</span>, <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">tuple</span><span class="op">|</span><span class="bu">list</span>]]]]]:  <span class="co"># List of (stack_str,trace_dict); trace_dict maps source snippets to (hit_count, variables), unchanged vars collapsed to single tuple</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Trace execution using sys.monitoring (Python 3.12+), returning a list of per-call traces.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Return:</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">    - list of length &lt;= 10</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">    - one element per call to `target_func` (including recursion)</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">    - each element is: (stack_str, trace_dict)</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">        stack_str: call stack string (filtered so `fn` is the shallowest frame shown)</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">        trace_dict: {</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">        "&lt;source snippet for AST-line&gt;": ( hit_count, { "var": [ (type_name, truncated_repr), ... up to 10 ], ... } ),</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">        ...}</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">    Semantics:</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">    - "Line" means an AST-level line: separate statements (even if on one physical line via `;`).</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">    - Compound statements are keyed by their header only.</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">    - Unchanged variables → `('type', 'repr')` tuple, changed variables → `[('type', 'repr'), ...]` list.</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">    - Comprehensions are treated as a line node and are monitored, including inside the comprehension frame, with per-iteration snapshots.</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">    - Snapshots are recorded after each line finishes, so assignments show updated values.</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6b60d807-5872-4c81-908e-8c9aa817b1b2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- dialoghelper.tmux --</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Terminal : view tmux buffers</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pane(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    n:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Number of scrollback lines to capture, in addition to visible area (None uses default_tmux_lines, which is 500 if not otherwise set)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    pane:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,     <span class="co"># Pane number to capture from</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    session:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Session name to target</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    window:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,   <span class="co"># Window number to target</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Grab the tmux history in plain text'</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> list_panes(</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    session:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Session name to list panes from</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    window:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,   <span class="co"># Window number to list panes from</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">'List panes for a session/window (or current if none specified)'</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> panes(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    session:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Session name to target</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    window:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,   <span class="co"># Window number to target</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    n:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,        <span class="co"># Number of scrollback lines to capture</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Grab history from all panes in a session/window'</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> list_windows(</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    session:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Session name to list windows from</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">'List all windows in a session'</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> windows(</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    session:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Session name to target</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    n:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,        <span class="co"># Number of scrollback lines to capture</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Grab history from all panes in all windows of a session'</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> list_sessions(<span class="op">**</span>kwargs):</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">'List all tmux sessions'</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sessions(</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    n:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>,        <span class="co"># Number of scrollback lines to capture</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Grab history from all panes in all windows of all sessions'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b3dd6401-2e38-4c03-a100-7b8a3f728288" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- contextkit.read --</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_text(url, <span class="co"># URL to read</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>             ): <span class="co"># Text from page</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get text from `url`"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_link(url: <span class="bu">str</span>,   <span class="co"># URL to read</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>             heavy: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>,   <span class="co"># Use headless browser (requires extra setup steps before use)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>             sel: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span>,  <span class="co"># Css selector to pull content from</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>             useJina: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, <span class="co"># Use Jina for the markdown conversion</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>             ignore_links: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, <span class="co"># Whether to keep links or not</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>             ): </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Reads a url and converts to markdown"</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_gist(url:<span class="bu">str</span>  <span class="co"># gist URL, of gist to read</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>             ):</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Returns raw gist content, or None"</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_gh_file(url:<span class="bu">str</span> <span class="co"># GitHub URL of the file to read</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                ):</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Reads the contents of a file from its GitHub URL"</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_file(path:<span class="bu">str</span>):</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"returns file contents"</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_dir(path: <span class="bu">str</span>,                          <span class="co"># path to read</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>             unicode_only: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>,             <span class="co"># ignore non-unicode files</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>             included_patterns: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"*"</span>],       <span class="co"># glob pattern of files to include</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>             excluded_patterns: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">".git/**"</span>], <span class="co"># glob pattern of files to exclude</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>             verbose: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>,                <span class="co"># log paths of files being read</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>             as_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>                  <span class="co"># returns dict of {path,content}</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">-&gt;</span> Union[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">str</span>]]:            <span class="co"># returns string with contents of files read</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Reads files in path, returning a dict with the filenames and contents if as_dict=True, otherwise concatenating file contents into a single string. Takes optional glob patterns for files to include or exclude."""</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_pdf(file_path: <span class="bu">str</span> <span class="co"># path of PDF file to read</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Reads the text of a PDF with PdfReader"</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_google_sheet(url: <span class="bu">str</span> <span class="co"># URL of a Google Sheet to read</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>                     ):</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Reads the contents of a Google Sheet into text"</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_gdoc(url: <span class="bu">str</span>  <span class="co"># URL of Google Doc to read</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>             ):</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Gets the text content of a Google Doc using html2text"</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_arxiv(url:<span class="bu">str</span>, <span class="co"># arxiv PDF URL, or arxiv abstract URL, or arxiv ID</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>               save_pdf:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># True, will save the downloaded PDF</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>               save_dir:<span class="bu">str</span><span class="op">=</span><span class="st">'.'</span> <span class="co"># directory in which to save the PDF</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>              ):</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get paper information from arxiv URL or ID, optionally saving PDF to disk"</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_gh_repo(path_or_url:<span class="bu">str</span>,    <span class="co"># Repo's GitHub URL, or GH SSH address, or file path</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>                 as_dict:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,  <span class="co"># if True, will return repo contents {path,content} dict</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                 verbose:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>  <span class="co"># if True, will log paths of files being read</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                ):</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Repo contents from path, GH URL, or GH SSH address"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="1457f4da-2d03-4bd0-9d99-95d250c6dcb0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- llms-txt --</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_llms_file(txt):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Parse llms.txt file contents in `txt` to an `AttrDict`"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> llms_txt2ctx(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    fname:<span class="bu">str</span>, <span class="co"># File name to read</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    optional:bool_arg<span class="op">=</span><span class="va">False</span>, <span class="co"># Include 'optional' section?</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    n_workers:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Number of threads to use for parallel downloading</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    save_nbdev_fname:<span class="bu">str</span><span class="op">=</span><span class="va">None</span> <span class="co">#save output to nbdev `{docs_path}` instead of emitting to stdout</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Print a `Project` with a `Section` for each H2 part in file read from `fname`, optionally skipping the 'optional' section."</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4cd3289b-aba9-4c98-b4fc-264798a107b0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- playwrightnb --</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_page(url, pause<span class="op">=</span><span class="dv">50</span>, timeout<span class="op">=</span><span class="dv">5000</span>, stealth<span class="op">=</span><span class="va">False</span>, page<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return contents of `url` and its iframes using Playwright"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> url2md(url, sel<span class="op">=</span><span class="va">None</span>, pause<span class="op">=</span><span class="dv">50</span>, timeout<span class="op">=</span><span class="dv">5000</span>, stealth<span class="op">=</span><span class="va">False</span>, page<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Read `url` with `read_page`"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get2md(url, sel<span class="op">=</span><span class="va">None</span>, <span class="op">**</span>kwargs):</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Read `url` with `httpx.get`"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="dbb77bbb-f3b5-44b1-a036-109ea9b60ddc" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- toolslm.xml --</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_file(fname, max_size<span class="op">=</span><span class="va">None</span>, sigs_only<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kwargs):</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Read file content, converting notebooks to XML if needed"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> files2ctx(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    fnames:<span class="bu">list</span>[Union[<span class="bu">str</span>,Path]], <span class="co"># List of file names to add to context</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    srcs:Optional[<span class="bu">list</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Use the labels instead of `fnames`</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    max_size:<span class="bu">int</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Skip files larger than this (bytes)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    out:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Include notebook cell outputs?</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    ids:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,  <span class="co"># Include cell ids in notebooks?</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    nums:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Include line numbers in notebook cell source?</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    sigs_only:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Only include signatures and docstrings (where supported by `codesigs` lib)</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">str</span>: <span class="co"># XML for LM context</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert files to XML context, handling notebooks"</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> folder2ctx(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    path:Union[<span class="bu">str</span>,Path], <span class="co"># Folder to read</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    prefix:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># Include Anthropic's suggested prose intro?</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    out:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Include notebook cell outputs?</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    include_base:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Include full path in src?</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    title:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Optional title attr for Documents element</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    max_size:<span class="bu">int</span><span class="op">=</span><span class="dv">100_000</span>, <span class="co"># Skip files larger than this (bytes)</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    max_total:<span class="bu">int</span><span class="op">=</span><span class="dv">10_000_000</span>,  <span class="co"># Max total output size in bytes</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    readme_first:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>,  <span class="co"># Prioritize README files at start of context?</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    files_only:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>,  <span class="co"># Return dict of {filename: size} instead of context?</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    sigs_only:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>,  <span class="co"># Return signatures instead of full text? (where supported by `codesigs` lib)</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    ids:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,  <span class="co"># Include cell ids in notebooks?</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span>Union[<span class="bu">str</span>,<span class="bu">dict</span>]:</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert folder contents to XML context, handling notebooks"</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sym2file(sym):</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return md string with filepath and contents for a symbol's source file"</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sym2folderctx(</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    sym,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    types:<span class="bu">str</span><span class="op">|</span><span class="bu">list</span><span class="op">=</span><span class="st">'py'</span>,  <span class="co"># List or comma-separated str of ext types from: py, js, java, c, cpp, rb, r, ex, sh, web, doc, cfg</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    skip_file_re:<span class="bu">str</span><span class="op">=</span><span class="vs">r'</span><span class="dv">^</span><span class="vs">_mod'</span>, <span class="co"># Skip files matching regex</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return folder context for a symbol's source file location"</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sym2pkgpath(sym):</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get root package path for a symbol"</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sym2pkgctx(</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    sym,</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    types:<span class="bu">str</span><span class="op">|</span><span class="bu">list</span><span class="op">=</span><span class="st">'py'</span>, <span class="co"># List or comma-separated str of ext types from: py, js, java, c, cpp, rb, r, ex, sh, web, doc, cfg</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    skip_file_re:<span class="bu">str</span><span class="op">=</span><span class="vs">r'</span><span class="dv">^</span><span class="vs">_mod'</span>, <span class="co"># Skip files matching regex</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    skip_folder_re:<span class="bu">str</span><span class="op">=</span><span class="vs">r'</span><span class="dv">^</span><span class="kw">(</span><span class="ch">\.</span><span class="cf">|</span><span class="vs">__</span><span class="kw">)</span><span class="vs">'</span>, <span class="co"># Skip folders matching regex</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return contents of files in a symbol's root package"</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> repo2ctx(</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    owner:<span class="bu">str</span>,  <span class="co"># GitHub repo owner or "owner/repo" or a full github URL</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    repo:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,   <span class="co"># GitHub repo name (leave empty if using "owner/repo" or URL format for owner param)</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    ref:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Git ref (branch/tag/sha) (get from URL not provided); defaults to repo's default branch</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    folder:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># Only include files under this path (get from URL not provided)</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    show_filters:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,  <span class="co"># Include filter info in title?</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    token:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>,  <span class="co"># GitHub token (uses GITHUB_TOKEN env var if None)</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs  <span class="co"># Passed to `folder2ctx`</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span>Union[<span class="bu">str</span>,<span class="bu">dict</span>]:  <span class="co"># XML for LM context, or dict of file sizes</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert GitHub repo to XML context without cloning"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c5dd3ff0-1723-47e7-8e87-dfc31bf27ecc" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- toolslm.inspecttools --</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> importmodule(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    mod: <span class="bu">str</span>, <span class="co"># The module to import (e.g. 'torch.nn.functional')</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    caller_symbol:<span class="bu">str</span> <span class="op">=</span> <span class="st">'__msg_id'</span>  <span class="co"># The name of the special variable to find the correct caller namespace</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Import a module into the caller's global namespace so it's available for `symsrc`, `symval`, `symdir`, etc.</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Use this before inspecting or using symbols from modules not yet imported."""</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symsrc(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    sym: <span class="bu">str</span>  <span class="co"># Dotted symbol path (e.g `Interval` or `sympy.sets.sets.Interval`) or "_last" for previous result</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get the source code for a symbol.</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples:</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symsrc("Interval")` -&gt; source code of Interval class if it's already imported</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symsrc("sympy.sets.sets.Interval")` -&gt; source code of Interval class</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symsrc("_last")` -&gt; source of object from previous tool call</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">    - For dispatchers or registries of callables: `symnth("module.dispatcher.funcs", n) then symsrc("_last")`"""</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symtype(</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    syms: <span class="bu">str</span>  <span class="co"># Comma separated str list of dotted symbol paths (e.g `'Interval,a'` or `'sympy.sets.sets.Interval'`); "_last" for prev result</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get the type of a symbol and set `_last`.</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples:</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symtype("sympy.sets.sets.Interval")` -&gt; `&lt;class 'type'&gt;`</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symtype("doesnotexist")` -&gt; `'SymbolNotFound`</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symtype("_last")` -&gt; type of previous result"""</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symval(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    syms: <span class="bu">str</span>  <span class="co"># Comma separated str list of dotted symbol paths (e.g `Interval` or `sympy.sets.sets.Interval`); "_last" for prev result</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""List of repr of symbols' values.</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples:</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symval("sympy.sets.sets.Interval")` -&gt; `[&lt;class 'sympy.sets.sets.Interval'&gt;]`</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symval("some_dict.keys")` -&gt; `[dict_keys([...])]`</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symval("a,notexist")` -&gt; `['foo','SymbolNotFound']`"""</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symdir(</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    sym: <span class="bu">str</span>,  <span class="co"># Dotted symbol path (e.g `Interval` or `sympy.sets.sets.Interval`) or "_last" for previous result</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    exclude_private: <span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># Filter out attrs starting with "_"</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get dir() listing of a symbol's attributes and set `_last`. E.g: `symdir("sympy.Interval")` -&gt; `['__add__', '__and__', ...]`"""</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> symnth(</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    sym: <span class="bu">str</span>,  <span class="co"># Dotted symbol path to a dict or object with .values()</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    n: <span class="bu">int</span>     <span class="co"># Index into the values (0-based)</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get the nth value from a dict (or any object with .values()). Sets `_last` so you can chain with `symsrc("_last")` etc.</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co">    Examples:</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symnth("dispatcher.funcs", 12)` -&gt; 13th registered function</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="co">    - `symnth("dispatcher.funcs", 0); symsrc("_last")` -&gt; source of first handler"""</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symlen(</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    sym: <span class="bu">str</span>  <span class="co"># Dotted symbol path or "_last" for previous result</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Returns the length of the given symbol"</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symslice(</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>    sym: <span class="bu">str</span>,   <span class="co"># Dotted symbol path or "_last" for previous result</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>    start: <span class="bu">int</span>, <span class="co"># Starting index for slice</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    end: <span class="bu">int</span>    <span class="co"># Ending index for slice</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Returns the contents of the symbol from the given start to the end."</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symsearch(</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    sym:<span class="bu">str</span>,      <span class="co"># Dotted symbol path or "_last" for previous result</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>    term:<span class="bu">str</span>,     <span class="co"># Search term (exact string or regex pattern)</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>    regex:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,  <span class="co"># If True, regex search; if False, exact match</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    flags:<span class="bu">int</span><span class="op">=</span><span class="dv">0</span>   <span class="co"># Regex flags (e.g., re.IGNORECASE)</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Search contents of symbol, which is assumed to be str for regex, or iterable for non-regex.</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co">    Regex mode returns (match, start, end) tuples; otherwise returns (item, index) tuples"""</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symset(</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    val: <span class="bu">str</span>  <span class="co"># Value to assign to _ai_sym</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Set _ai_sym to the given value"</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symfiles_folder(</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>    sym:<span class="bu">str</span>,      <span class="co"># Dotted symbol path or "_last" for previous result</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return XML context of files in the folder containing `sym`'s definition"</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> symfiles_package(</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>    sym:<span class="bu">str</span>,      <span class="co"># Dotted symbol path or "_last" for previous result</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return XML context of all files in `sym`'s top-level package"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="10325eac-9f74-4186-b26f-ee818e092025" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- toolslm.funccall --</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_schema(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    f:Union[<span class="bu">callable</span>,<span class="bu">dict</span>], <span class="co"># Function to get schema for</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    pname<span class="op">=</span><span class="st">'input_schema'</span>,   <span class="co"># Key name for parameters</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    evalable<span class="op">=</span><span class="va">False</span>,  <span class="co"># stringify defaults that can't be literal_eval'd?</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    skip_hidden<span class="op">=</span><span class="va">False</span> <span class="co"># skip parameters starting with '_'?</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)<span class="op">-&gt;</span><span class="bu">dict</span>: <span class="co"># {'name':..., 'description':..., pname:...}</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Generate JSON schema for a class, function, or method"</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mk_tool(dispfn, tool):</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Create a callable function from a JSON schema tool definition"</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> call_func(fc_name, fc_inputs, ns, raise_on_err<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Call the function `fc_name` with the given `fc_inputs` using namespace `ns`."</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> call_func_async(fc_name, fc_inputs, ns, raise_on_err<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Awaits the function `fc_name` with the given `fc_inputs` using namespace `ns`."</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d182ca74-1550-41a6-a4d3-6d9000d388fa" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- toolslm.funccall --</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> python(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    code:<span class="bu">str</span>, <span class="co"># Code to execute</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    glb:Optional[<span class="bu">dict</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Globals namespace</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    loc:Optional[<span class="bu">dict</span>]<span class="op">=</span><span class="va">None</span>, <span class="co"># Locals namespace</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    timeout:<span class="bu">int</span><span class="op">=</span><span class="dv">3600</span> <span class="co"># Maximum run time in seconds</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Executes python `code` with `timeout` and returning final expression (similar to IPython)."</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="82035bf0-725a-432f-8f94-d053e78a7a0c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- toolslm.download --</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch web content for LLMs    </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_md(url, rm_comments<span class="op">=</span><span class="va">True</span>, rm_details<span class="op">=</span><span class="va">True</span>, <span class="op">**</span>kwargs):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Read text from `url` and clean with `clean_docs`"</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> html2md(s:<span class="bu">str</span>, ignore_links<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Convert `s` from HTML to markdown"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_html(url, <span class="co"># URL to read</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>              sel<span class="op">=</span><span class="va">None</span>, <span class="co"># Read only outerHTML of CSS selector `sel`</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>              rm_comments<span class="op">=</span><span class="va">True</span>, <span class="co"># Removes HTML comments</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>              rm_details<span class="op">=</span><span class="va">True</span>, <span class="co"># Removes `&lt;details&gt;` tags</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>              multi<span class="op">=</span><span class="va">False</span>, <span class="co"># Get all matches to `sel` or first one  </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>              wrap_tag<span class="op">=</span><span class="va">None</span>, <span class="co">#If multi, each selection wrapped with &lt;wrap_tag&gt;content&lt;/wrap_tag&gt;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>              ignore_links<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>             ): <span class="co"># Cleaned markdown</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get `url`, optionally selecting CSS selector `sel`, and convert to clean markdown"</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_llmstxt(url, optional<span class="op">=</span><span class="va">False</span>, n_workers<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get llms.txt file from and expand it with `llms_txt.create_ctx()`"</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_docs(url):</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"If available, return LLM-friendly llms.txt context or markdown file location from `url`"</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_docs(url, optional<span class="op">=</span><span class="va">False</span>, n_workers<span class="op">=</span><span class="va">None</span>, rm_comments<span class="op">=</span><span class="va">True</span>, rm_details<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">"If available, return LLM-friendly llms.txt context or markdown file response for `url`"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fe72f310-ab28-4834-926c-c479036fb463" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- toolslm.shell --</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># toolslm.shell Minimal IPython shell for code execution    get_shell, run_cell</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_shell()<span class="op">-&gt;</span>TerminalInteractiveShell:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get a `TerminalInteractiveShell` with minimal functionality"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_cell(<span class="va">self</span>:TerminalInteractiveShell, cell, timeout<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Wrapper for original `run_cell` which adds timeout and output capture"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2a147a29-753a-4048-a0ae-a818ef628b79" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- ipykernel --</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scrape_url(url):</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get the html content of a web page using the cloudscraper library to bypass Cloudflare's anti-bot page."</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> create_scraper().get(url)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_url(url: <span class="bu">str</span>, as_md: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, extract_section: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, selector: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>, math_mode: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""This functions extracts a web page information for LLM ingestion</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Downloads a web page</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Parses HTML</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">    3. Optionally extracts a specific section (fragment or CSS selector)</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">    4. Converts MathML → LaTeX</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">    5. Optionally converts HTML → Markdown</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">    6. Convert code sections to fenced markdown blocks</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">    7. Makes image URLs absolute</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">    8. Returns the processed text</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    o <span class="op">=</span> scrape_url(url)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    res, ctype <span class="op">=</span> o.text, o.headers.get(<span class="st">'content-type'</span>).split(<span class="st">';'</span>)[<span class="dv">0</span>]</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(res, <span class="st">'lxml'</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> selector:</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="st">'</span><span class="ch">\n\n</span><span class="st">'</span>.join(<span class="bu">str</span>(s) <span class="cf">for</span> s <span class="kw">in</span> soup.select(selector))</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> extract_section:</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        parsed <span class="op">=</span> urlparse(url)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parsed.fragment:</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>            section <span class="op">=</span> soup.find(<span class="bu">id</span><span class="op">=</span>parsed.fragment)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> section:</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                elements <span class="op">=</span> [section]</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                current <span class="op">=</span> section.next_sibling</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> current:</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">hasattr</span>(current, <span class="st">'name'</span>) <span class="kw">and</span> current.name <span class="op">==</span> section.name: <span class="cf">break</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                    elements.append(current)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                    current <span class="op">=</span> current.next_sibling</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                res <span class="op">=</span> <span class="st">''</span>.join(<span class="bu">str</span>(el) <span class="cf">for</span> el <span class="kw">in</span> elements)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                res <span class="op">=</span> <span class="st">''</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="bu">str</span>(soup)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> math_mode:</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>        res_soup <span class="op">=</span> BeautifulSoup(res, <span class="st">'lxml'</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>        _convert_math(res_soup, math_mode)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="bu">str</span>(res_soup)</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> as_md <span class="kw">and</span> ctype <span class="op">==</span> <span class="st">'text/html'</span>:</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>        h <span class="op">=</span> HTML2Text()</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>        h.body_width <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle code blocks</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>        h.mark_code <span class="op">=</span> <span class="va">True</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> h.handle(res)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> _f(m): <span class="cf">return</span> <span class="ss">f'```</span><span class="ch">\n</span><span class="sc">{</span>dedent(m.group(<span class="dv">1</span>))<span class="sc">}</span><span class="ch">\n</span><span class="ss">```'</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="ch">\[</span><span class="vs">code]</span><span class="dv">\s</span><span class="op">*</span><span class="ch">\n</span><span class="kw">(</span><span class="dv">.</span><span class="op">*?</span><span class="kw">)</span><span class="ch">\n\[</span><span class="vs">/code]'</span>, _f, res <span class="kw">or</span> <span class="st">''</span>, flags<span class="op">=</span>re.DOTALL).strip()</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle image urls</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> _absolutify_imgs(res, urljoin(url, s[<span class="st">'href'</span>] <span class="cf">if</span> (s <span class="op">:=</span> soup.find(<span class="st">'base'</span>)) <span class="cf">else</span> <span class="st">''</span>))</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle math blocks</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> math_mode <span class="op">==</span> <span class="st">'safe'</span>:</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> res.replace(<span class="st">'</span><span class="ch">\\\\</span><span class="st">('</span>, <span class="st">'</span><span class="ch">\\</span><span class="st">('</span>).replace(<span class="st">'</span><span class="ch">\\\\</span><span class="st">)'</span>, <span class="st">'</span><span class="ch">\\</span><span class="st">)'</span>)</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="solveit-tool-exploration" class="level2">
<h2 class="anchored" data-anchor-id="solveit-tool-exploration">Solveit tool exploration</h2>
<p>Here is the list of unique Answerai library names sorted in alphabetical order:</p>
<section id="librairies-providing-tools" class="level3">
<h3 class="anchored" data-anchor-id="librairies-providing-tools">Librairies providing tools</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Library</th>
<th>GitHub Repo URL</th>
<th>Library Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>contextkit</strong></td>
<td><a href="https://github.com/AnswerDotAI/ContextKit" title="GitHub - AnswerDotAI/ContextKit: Useful LLM contexts ready to be used in AIMagic">*</a> https://github.com/AnswerDotAI/ContextKit</td>
<td><a href="https://github.com/AnswerDotAI/ContextKit" title="GitHub - AnswerDotAI/ContextKit: Useful LLM contexts ready to be used in AIMagic">*</a> Useful LLM contexts ready to be used in AIMagic. Library for gathering context from various sources (URLs, GitHub repos, Google Docs, PDFs, arXiv) for feeding to LLMs.</td>
</tr>
<tr class="even">
<td><strong>dialoghelper</strong></td>
<td><a href="https://github.com/AnswerDotAI/dialoghelper" title="GitHub - AnswerDotAI/dialoghelper: Helper functions for solveit dialogs">*</a> https://github.com/AnswerDotAI/dialoghelper</td>
<td><a href="https://github.com/AnswerDotAI/dialoghelper" title="GitHub - AnswerDotAI/dialoghelper: Helper functions for solveit dialogs">*</a> Helper functions for solveit dialogs. Provides functions for message manipulation, gist management, screen capture, and tool integration in the solveit environment.</td>
</tr>
<tr class="odd">
<td><strong>execnb</strong></td>
<td><a href="https://github.com/AnswerDotAI/execnb" title="GitHub - AnswerDotAI/execnb: Execute a jupyter notebook, fast, without needing jupyter">*</a> https://github.com/AnswerDotAI/execnb</td>
<td><a href="https://github.com/AnswerDotAI/execnb" title="GitHub - AnswerDotAI/execnb: Execute a jupyter notebook, fast, without needing jupyter">*</a> Execute a jupyter notebook, fast, without needing jupyter. Provides CaptureShell for running code and capturing outputs without a Jupyter server.</td>
</tr>
<tr class="even">
<td><strong>fastcore</strong></td>
<td><a href="https://github.com/AnswerDotAI" title="Answer.AI · GitHub">*</a> https://github.com/AnswerDotAI/fastcore</td>
<td>Python utilities and enhancements used across fast.ai projects. Includes foundational tools like <code>@patch</code>, <code>@delegates</code>, type dispatch, and LLM file/bash tools.</td>
</tr>
<tr class="odd">
<td><strong>ipykernel_helper</strong></td>
<td>PRIVATE REPO</td>
<td>Helper utilities for IPython/Jupyter kernels, providing <code>read_url</code>, <code>transient</code> display, enhanced completion, and namespace inspection for dialog environments.</td>
</tr>
<tr class="even">
<td><strong>llms_txt</strong></td>
<td><a href="https://github.com/AnswerDotAI/llms-txt/blob/main/nbs/index.qmd" title="llms-txt/nbs/index.qmd at main · AnswerDotAI/llms-txt">*</a> https://github.com/AnswerDotAI/llms-txt</td>
<td><a href="https://github.com/AnswerDotAI/llms-txt/blob/main/nbs/index.qmd" title="llms-txt/nbs/index.qmd at main · AnswerDotAI/llms-txt">*</a> The <code>llms.txt</code> specification is open for community input. A GitHub repository hosts this informal overview. Tools for the /llms.txt standard helping language models use websites.</td>
</tr>
<tr class="odd">
<td><strong>playwrightnb</strong></td>
<td>https://github.com/AnswerDotAI/playwrightnb</td>
<td>Playwright browser automation integration for Jupyter notebooks, enabling headless browser control and web scraping.</td>
</tr>
<tr class="even">
<td><strong>toolslm</strong></td>
<td><a href="https://github.com/AnswerDotAI/toolslm" title="GitHub - AnswerDotAI/toolslm: Tools to make language models a bit easier to use">*</a> https://github.com/AnswerDotAI/toolslm</td>
<td><a href="https://github.com/AnswerDotAI/toolslm" title="GitHub - AnswerDotAI/toolslm: Tools to make language models a bit easier to use">*</a> Tools to make language models a bit easier to use. Provides XML context creation, function schema generation, shell execution, and web content downloading for LLMs.</td>
</tr>
</tbody>
</table>
</section>
<section id="summary-answer.ai-tools-for-llm-development" class="level3">
<h3 class="anchored" data-anchor-id="summary-answer.ai-tools-for-llm-development">Summary: Answer.AI Tools for LLM Development</h3>
<p><strong>LLM Tool Utilities</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Library</th>
<th>Purpose</th>
<th>Key Functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>fastcore.tools</strong></td>
<td>File/bash operations designed for LLM tool loops</td>
<td><code>view</code>, <code>create</code>, <code>insert</code>, <code>str_replace</code>, <code>strs_replace</code>, <code>replace_lines</code>, <code>run_cmd</code>, <code>rg</code>, <code>sed</code></td>
</tr>
<tr class="even">
<td><strong>toolslm.funccall</strong></td>
<td>Function calling / tool use</td>
<td><code>get_schema</code>, <code>call_func</code>, <code>call_func_async</code>, <code>python</code>, <code>mk_ns</code></td>
</tr>
</tbody>
</table>
<p><strong>Context Preparation</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Library</th>
<th>Purpose</th>
<th>Key Functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>contextkit</strong></td>
<td>Gather context from various sources</td>
<td><code>read_link</code>, <code>read_gh_repo</code>, <code>read_gh_file</code>, <code>read_gist</code>, <code>read_google_sheet</code>, <code>read_gdoc</code>, <code>read_dir</code>, <code>read_pdf</code>, <code>read_arxiv</code></td>
</tr>
<tr class="even">
<td><strong>toolslm.xml</strong></td>
<td>Convert files/folders to XML for LLMs</td>
<td><code>folder2ctx</code>, <code>files2ctx</code>, <code>json_to_xml</code>, <code>docs_xml</code>, <code>nb2xml</code></td>
</tr>
<tr class="odd">
<td><strong>toolslm.download</strong></td>
<td>Fetch web content for LLMs</td>
<td><code>read_html</code>, <code>read_md</code>, <code>html2md</code>, <code>get_llmstxt</code>, <code>find_docs</code>, <code>read_docs</code></td>
</tr>
<tr class="even">
<td><strong>toolslm.md_hier</strong></td>
<td>Parse markdown hierarchically</td>
<td><code>create_heading_dict</code>, <code>HeadingDict</code></td>
</tr>
</tbody>
</table>
<p><strong>Message Formatting</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Library</th>
<th>Purpose</th>
<th>Key Functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>msglm</strong></td>
<td>Create properly formatted messages for LLM APIs</td>
<td><code>mk_msg</code>, <code>mk_msgs</code>, <code>mk_msg_anthropic</code>, <code>mk_msg_openai</code>, <code>mk_ant_doc</code> (supports text, images, PDFs, caching)</td>
</tr>
</tbody>
</table>
<p><strong>Code Execution</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Library</th>
<th>Purpose</th>
<th>Key Functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>execnb</strong></td>
<td>Execute Jupyter notebooks without Jupyter</td>
<td><code>CaptureShell</code>, <code>CaptureShell.run()</code>, <code>CaptureShell.execute()</code>, <code>read_nb</code>, <code>write_nb</code>, <code>new_nb</code></td>
</tr>
<tr class="even">
<td><strong>nbformat</strong></td>
<td>Notebook format handling &amp; validation</td>
<td><code>read</code>, <code>write</code>, <code>validate</code>, format conversion</td>
</tr>
<tr class="odd">
<td><strong>toolslm.shell</strong></td>
<td>Minimal IPython shell for code execution</td>
<td><code>get_shell</code>, <code>run_cell</code></td>
</tr>
</tbody>
</table>
<p><strong>Dialog/Session Management</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Library</th>
<th>Purpose</th>
<th>Key Functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>dialoghelper.core</strong></td>
<td>Interact with solveit dialogs</td>
<td><code>read_msg</code>, <code>add_msg</code>, <code>update_msg</code>, <code>del_msg</code>, <code>run_msg</code>, <code>find_msgs</code>, <code>import_gist</code>, <code>url2note</code>, <code>ast_grep</code></td>
</tr>
<tr class="even">
<td><strong>dialoghelper.capture</strong></td>
<td>Screen sharing with AI</td>
<td><code>setup_share</code>, <code>start_share</code>, <code>capture_screen</code>, <code>capture_tool</code></td>
</tr>
</tbody>
</table>
<p><strong>Visual Overview</strong></p>
<pre><code>┌─────────────────────────────────────────────────────────────────┐
│                    LLM Application Stack                        │
├─────────────────────────────────────────────────────────────────┤
│  USER INTERFACE                                                 │
│    dialoghelper (dialog management, screen capture)             │
├─────────────────────────────────────────────────────────────────┤
│  MESSAGE LAYER                                                  │
│    msglm (format messages for Claude/OpenAI/etc)                │
├─────────────────────────────────────────────────────────────────┤
│  CONTEXT LAYER                                                  │
│    contextkit (read from URLs, GitHub, Google, PDFs, arXiv)     │
│    toolslm.xml (convert files/folders to XML)                   │
│    toolslm.download (fetch &amp; clean web content)                 │
│    toolslm.md_hier (parse markdown structure)                   │
├─────────────────────────────────────────────────────────────────┤
│  TOOL EXECUTION LAYER                                           │
│    fastcore.tools (file editing, bash commands)                 │
│    toolslm.funccall (function schemas, safe execution)          │
│    toolslm.shell (IPython execution)                            │
│    execnb (notebook execution)                                  │
├─────────────────────────────────────────────────────────────────┤
│  FORMAT LAYER                                                   │
│    nbformat (notebook format handling)                          │
└─────────────────────────────────────────────────────────────────┘</code></pre>
<p>Key Themes</p>
<ol type="1">
<li><strong>Safety</strong>: Tools return errors as strings for LLMs to debug; file operations have safeguards</li>
<li><strong>LLM-Optimized Formats</strong>: XML for Claude, proper message structures for each API</li>
<li><strong>Single-Function Access</strong>: Most operations are one function call (e.g., <code>read_gh_repo</code>, <code>folder2ctx</code>)</li>
<li><strong>Composability</strong>: Libraries work together - contextkit gathers content, toolslm formats it, msglm packages it for APIs</li>
</ol>
</section>
<section id="details-of-the-tools-available-in-these-libraries" class="level3">
<h3 class="anchored" data-anchor-id="details-of-the-tools-available-in-these-libraries">Details of the tools available in these libraries</h3>
<section id="contextkit" class="level4">
<h4 class="anchored" data-anchor-id="contextkit">contextkit</h4>
<p>All functions follow th same design pattern: single required argument (location), optional parameters for customization, and return text or dict suitable for LLM consumption.</p>
<p>Web Content Functions</p>
<p><strong><code>read_link(url, heavy=False, sel=None, useJina=False, ignore_links=False)</code></strong> - Reads a URL and converts to markdown - The heavy argument allows you to do a heavy scrape with a contactless browser using playwrightnb - <code>sel</code> - CSS selector to extract specific content - <code>useJina=True</code> - uses Jina.ai service for markdown conversion - <code>ignore_links</code> - whether to strip out links</p>
<p><strong><code>read_url(...)</code></strong> - Deprecated alias for <code>read_link()</code></p>
<p><strong><code>read_text(url)</code></strong> - Get raw text from a URL (no markdown conversion)</p>
<p><strong><code>read_html(url, sel=None, ...)</code></strong> - Fetch URL, optionally select CSS elements, convert to clean markdown</p>
<p>GitHub Functions</p>
<p><strong><code>read_gist(url)</code></strong> - Returns raw gist content from a GitHub gist URL</p>
<p><strong><code>read_gh_file(url)</code></strong> - Reads contents of a single file from its GitHub URL</p>
<p><strong><code>read_gh_repo(path_or_url, as_dict=False, verbose=False)</code></strong> - Reads entire repo contents from GitHub URL, SSH address, or local path - Clones/caches repos automatically - Returns dict of <code>{filepath: content}</code> if <code>as_dict=True</code>, otherwise concatenated string</p>
<p>Google Services Functions</p>
<p><strong><code>read_google_sheet(url)</code></strong> - Reads a Google Sheet into CSV text</p>
<p><strong><code>read_gdoc(url)</code></strong> - Gets text content of a Google Doc converted to markdown</p>
<p>File System Functions</p>
<p><strong><code>read_file(path)</code></strong> - Returns file contents as string</p>
<p><strong><code>read_dir(path, unicode_only=True, included_patterns=["*"], excluded_patterns=[".git/**"], verbose=False, as_dict=False)</code></strong> - Reads files in a directory with glob pattern filtering - <code>unicode_only=True</code> - skip binary files - <code>included_patterns</code> - glob patterns to include - <code>excluded_patterns</code> - glob patterns to exclude - Returns dict or concatenated string with file markers</p>
<p><strong><code>read_pdf(file_path)</code></strong> - Extracts text from PDF using pypdf</p>
<p>Academic Functions</p>
<p><strong><code>read_arxiv(url, save_pdf=False, save_dir='.')</code></strong> - Get paper info from arXiv URL or ID - Returns dict with title, authors, summary, published date, links - Optionally downloads PDF and extracts LaTeX source - Returns structured metadata perfect for LLM context</p>
</section>
<section id="dialoghelper" class="level4">
<h4 class="anchored" data-anchor-id="dialoghelper">dialoghelper</h4>
<p>dialoghelper is a library from Answer.AI providing helper functions for the solveit dialog environment. It enables programmatic interaction with dialog cells, message editing, gist management, and screen capture.</p>
<p>Module 1: <strong>core</strong> (<code>dialoghelper.core</code>)</p>
<p>The main module with functions for interacting with solveit dialogs:</p>
<p>Basics - Variable/Context Management</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>find_var(var)</code></td>
<td>Search for variable in all frames of the call stack</td>
</tr>
<tr class="even">
<td><code>set_var(var, val)</code></td>
<td>Set variable value after finding it in call stack frames</td>
</tr>
<tr class="odd">
<td><code>find_msg_id()</code></td>
<td>Get current message ID from call stack (<code>__msg_id</code>)</td>
</tr>
<tr class="even">
<td><code>find_dname()</code></td>
<td>Get current dialog name from call stack (<code>__dialog_id</code>)</td>
</tr>
<tr class="odd">
<td><code>call_endp(path, ...)</code></td>
<td>Call a solveit API endpoint</td>
</tr>
<tr class="even">
<td><code>curr_dialog(with_messages, dname)</code></td>
<td>Get current dialog info</td>
</tr>
<tr class="odd">
<td><code>msg_idx(msgid, dname)</code></td>
<td>Get absolute index of message in dialog</td>
</tr>
</tbody>
</table>
<p>JavaScript/HTML Injection</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>add_scr(scr, oob)</code></td>
<td>Swap a script element into the DOM</td>
</tr>
<tr class="even">
<td><code>iife(code)</code></td>
<td>Wrap JavaScript code in IIFE and execute via <code>add_html</code></td>
</tr>
<tr class="odd">
<td><code>add_html(content, dname)</code></td>
<td>Send HTML to browser to be swapped into DOM (uses hx-swap-oob)</td>
</tr>
</tbody>
</table>
<p>Event System</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pop_data(idx, timeout)</code></td>
<td>Pop data from a queue</td>
</tr>
<tr class="even">
<td><code>fire_event(evt, data)</code></td>
<td>Fire a browser event</td>
</tr>
<tr class="odd">
<td><code>event_get(evt, timeout, data)</code></td>
<td>Fire event and wait for response data</td>
</tr>
</tbody>
</table>
<p>View/Edit Dialog Messages</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>find_msgs(re_pattern, msg_type, limit, ...)</code></td>
<td>Find messages matching regex/type in current dialog</td>
</tr>
<tr class="even">
<td><code>read_msg(n, relative, msgid, view_range, nums, ...)</code></td>
<td>Get message by index (absolute or relative) with optional line range</td>
</tr>
<tr class="odd">
<td><code>add_msg(content, placement, msgid, msg_type, ...)</code></td>
<td>Add a new message (note/code/prompt) at specified position</td>
</tr>
<tr class="even">
<td><code>del_msg(msgid, dname)</code></td>
<td>Delete a message</td>
</tr>
<tr class="odd">
<td><code>update_msg(msgid, msg, content, ...)</code></td>
<td>Update an existing message’s content/properties</td>
</tr>
<tr class="even">
<td><code>run_msg(msgid, dname)</code></td>
<td>Queue a message for execution</td>
</tr>
<tr class="odd">
<td><code>url2note(url, ...)</code></td>
<td>Read URL as markdown and add as note(s) below current message</td>
</tr>
</tbody>
</table>
<p>AST/Code Search</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ast_py(code)</code></td>
<td>Get an ast-grep SgRoot node for Python code</td>
</tr>
<tr class="even">
<td><code>ast_grep(pattern, path, lang)</code></td>
<td>Use ast-grep to find pattern in files</td>
</tr>
</tbody>
</table>
<p>Text Edit Functions (for editing message content)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>msg_insert_line(msgid, insert_line, new_str, ...)</code></td>
<td>Insert text at specific line number</td>
</tr>
<tr class="even">
<td><code>msg_str_replace(msgid, old_str, new_str, ...)</code></td>
<td>Replace first occurrence of string</td>
</tr>
<tr class="odd">
<td><code>msg_strs_replace(msgid, old_strs, new_strs, ...)</code></td>
<td>Replace multiple strings simultaneously</td>
</tr>
<tr class="even">
<td><code>msg_replace_lines(msgid, start_line, end_line, new_content, ...)</code></td>
<td>Replace a range of lines</td>
</tr>
</tbody>
</table>
<p>Gist Management</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>load_gist(gist_id)</code></td>
<td>Retrieve a GitHub gist</td>
</tr>
<tr class="even">
<td><code>gist_file(gist_id)</code></td>
<td>Get the first file from a gist</td>
</tr>
<tr class="odd">
<td><code>import_string(code, name)</code></td>
<td>Import code string as a module</td>
</tr>
<tr class="even">
<td><code>is_usable_tool(func)</code></td>
<td>Check if function can be used as LLM tool (has docstring + typed params)</td>
</tr>
<tr class="odd">
<td><code>mk_toollist(syms)</code></td>
<td>Create markdown list of tools with <code>&amp;</code> notation</td>
</tr>
<tr class="even">
<td><code>import_gist(gist_id, mod_name, ...)</code></td>
<td>Import gist directly as module, optionally wildcard import</td>
</tr>
</tbody>
</table>
<p>Tool Info</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>tool_info()</code></td>
<td>Get information about available tools</td>
</tr>
<tr class="even">
<td><code>fc_tool_info()</code></td>
<td>Get function-calling tool information</td>
</tr>
</tbody>
</table>
<p>Module 2: <strong>capture</strong> (<code>dialoghelper.capture</code>)</p>
<p>Screen capture functionality for sharing screens with the AI:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>setup_share()</code></td>
<td>Setup screen sharing (initializes the capture system)</td>
</tr>
<tr class="even">
<td><code>start_share()</code></td>
<td>Start screen sharing session</td>
</tr>
<tr class="odd">
<td><code>capture_screen(timeout=15)</code></td>
<td>Capture the screen as a PIL image</td>
</tr>
<tr class="even">
<td><code>capture_tool(timeout=15)</code></td>
<td>Capture screen for LLM tool use - returns image data suitable for vision models</td>
</tr>
</tbody>
</table>
<p>dialoghelper is the infrastructure that powers the solveit interactive environment, enabling: - <strong>Dialog manipulation</strong>: Add, edit, delete, search messages programmatically - <strong>Code execution</strong>: Queue and run code cells - <strong>Text editing</strong>: Line-based editing operations on message content - <strong>Gist integration</strong>: Import tools/modules directly from GitHub gists - <strong>Screen capture</strong>: Share your screen with the AI for visual understanding - <strong>AST search</strong>: Search code using ast-grep patterns</p>
</section>
<section id="execnb" class="level4">
<h4 class="anchored" data-anchor-id="execnb">execnb</h4>
<p>execnb is a fast.ai library for * * executing Jupyter notebooks without needing a Jupyter server or even having Jupyter installed.</p>
<p>Core execution:</p>
<ul>
<li><ul>
<li>CaptureShell - runs Jupyter code and captures notebook outputs</li>
</ul></li>
<li><ul>
<li>CaptureShell.run() - executes code strings and returns outputs</li>
</ul></li>
<li><ul>
<li>CaptureShell.execute() - executes a notebook and saves it with outputs filled in</li>
</ul></li>
</ul>
</section>
</section>
<section id="fastcore" class="level3">
<h3 class="anchored" data-anchor-id="fastcore">fastcore</h3>
<p>fastcore provides helpful tools for running CLI commands and reading, modifying, and creating files in Python, primarily for AI’s in tool loops for automating tasks involving the filesystem.</p>
<p>Bash Tools</p>
<p><strong><code>run_cmd(cmd, argstr='', disallow_re=None, allow_re=None)</code></strong> - Run cmd passing split argstr, optionally checking for allowed argstr - Can include regex patterns to allow/disallow certain argument patterns (e.g., blocking parent directories)</p>
<p><strong><code>rg(argstr, disallow_re=None, allow_re=None)</code></strong> - Runs the ripgrep command for fast text searching across files - Supports regex-based argument filtering for safety</p>
<p><strong><code>sed(argstr, disallow_re=None, allow_re=None)</code></strong> - Runs sed command for reading sections of files - Useful for viewing specific line ranges with or without line numbers</p>
<p>Text Edit Tools</p>
<p>Python implementations of the text editor tools from Anthropic. These tools are especially useful in an AI’s tool loop.</p>
<p><strong><code>view(path, view_range=None, nums=False)</code></strong> - View directory or file contents with optional line range and numbers - Can specify 1-indexed line ranges and toggle line numbers</p>
<p><strong><code>create(path, file_text, overwrite=False)</code></strong> - Creates a new file with the given content at the specified path - Safety feature: won’t overwrite by default</p>
<p><strong><code>insert(path, insert_line, new_str)</code></strong> - Insert new_str at specified line number - Uses 0-based indexing</p>
<p><strong><code>str_replace(path, old_str, new_str)</code></strong> - Replace first occurrence of old_str with new_str in file</p>
<p><strong><code>strs_replace(path, old_strs, new_strs)</code></strong> - Replace for each str pair in old_strs, new_strs - Batch replacement of multiple string pairs</p>
<p><strong><code>replace_lines(path, start_line, end_line, new_content)</code></strong> - Replace lines in file using start and end line-numbers (index starting at 1)</p>
<p>Special LLM-Friendly Features</p>
<p>These tools have special behavior around errors. Since these have been specifically designed for work with LLMs, any exceptions created from their use is returned as a string to help them debug their work. These tools are designed to be safe, predictable, and easy for LLMs to use in agentic workflows.</p>
<section id="llms_txt" class="level4">
<h4 class="anchored" data-anchor-id="llms_txt">llms_txt</h4>
<p>The llms-txt library provides a CLI and Python API to parse llms.txt files and create XML context files from them.</p>
<p><a href="https://www.analyticsvidhya.com/blog/2025/03/llms-txt/" title="LLMs.txt Explained: The Web's New LLM-Ready Content Standard">*</a> <a href="https://www.analyticsvidhya.com/blog/2025/03/llms-txt/" title="LLMs.txt Explained: The Web's New LLM-Ready Content Standard">*</a> The llms_txt Python module provides the source code and helpers needed to create and use llms.txt files.</p>
<p>The llms-txt library provides: 1. <strong>Parsing</strong> - Convert llms.txt markdown files into structured Python data 2. <strong>XML Generation</strong> - Transform parsed data into LLM-friendly XML context (especially for Claude) 3. <strong>CLI Tool</strong> - Command-line utility for batch processing 4. <strong>URL Fetching</strong> - Automatically fetch and include content from linked URLs Core Parsing Functions</p>
<p><strong><code>parse_llms_file(txt, optional=True)</code></strong> - <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> Parse llms.txt file contents to create a data structure with the sections of an llms.txt file - <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> Returns an AttrDict with keys: <code>title</code>, <code>summary</code>, <code>info</code>, <code>sections</code> - <code>optional=True</code> - includes the optional section in the parsed output - Example: <code>parsed.sections.Examples</code> returns list of links in the Examples section</p>
<p><strong><code>parse_link(txt)</code></strong> - <a href="https://www.analyticsvidhya.com/blog/2025/03/llms-txt/" title="LLMs.txt Explained: The Web's New LLM-Ready Content Standard">*</a> Extracts the title, URL, and optional description from a markdown link - Returns dict with <code>title</code>, <code>url</code>, and <code>desc</code> keys</p>
<p><strong>Internal: <code>_parse_llms(txt)</code></strong> - Lower-level parser that splits the file into start section and sectioned links - Returns tuple of (start_text, sections_dict)</p>
<p>XML Context Generation</p>
<p><strong><code>mk_ctx(d, optional=True, n_workers=None)</code></strong> - <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> Create a Project with a Section for each H2 part in the parsed data, optionally skipping the ‘optional’ section - <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> For LLMs such as Claude, XML format is preferred - Takes parsed llms.txt data structure and converts to XML - <code>n_workers</code> - parallel workers for fetching URLs</p>
<p><strong><code>create_ctx(txt, optional=True, n_workers=None)</code></strong> - <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> Create an LLM context file with XML sections, suitable for systems such as Claude (this is what the CLI calls behind the scenes) - High-level function that parses and converts in one step</p>
<p><strong><code>get_doc_content(url)</code></strong> - <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> Fetch content from local file if in nbdev repo - Helper for retrieving document content from URLs or local paths</p>
<p>Command-Line Interface</p>
<p><strong><code>llms_txt2ctx</code> (CLI command)</strong> - <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> After installation, llms_txt2ctx is available in your terminal - Usage: <code>llms_txt2ctx llms.txt &gt; llms.md</code> - <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> <a href="https://llmstxt.org/intro.html" title="Python module &amp; CLI – llms-txt">*</a> Pass –optional True to add the ‘optional’ section of the input file - <a href="https://www.analyticsvidhya.com/blog/2025/03/llms-txt/" title="LLMs.txt Explained: The Web's New LLM-Ready Content Standard">*</a> Uses the parsing helpers to process an llms.txt file and output an XML context file</p>
<p>File Format Specification</p>
<p><a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> <a href="https://llmstxt.org/core.html" title="Python source – llms-txt">*</a> The llms.txt file spec contains: an H1 with the name of the project (the only required section), a blockquote with a short summary, zero or more markdown sections containing detailed information, and zero or more H2-delimited sections containing “file lists” of URLs</p>
</section>
<section id="playwrightnb" class="level4">
<h4 class="anchored" data-anchor-id="playwrightnb">playwrightnb</h4>
<p><a href="https://github.com/AnswerDotAI/playwrightnb" title="GitHub - AnswerDotAI/playwrightnb: Use sync mode Playwright interactively, inside a Jupyter notebook">*</a> <a href="https://github.com/AnswerDotAI/playwrightnb" title="GitHub - AnswerDotAI/playwrightnb: Use sync mode Playwright interactively, inside a Jupyter notebook">*</a> playwrightnb provides quality-of-life helpers for interactive use of Playwright, particularly useful in Jupyter notebooks. It handles JavaScript rendering and other web complexities automatically.</p>
<p>Key Features</p>
<ol type="1">
<li><strong>Sync mode in Jupyter</strong> - Use Playwright synchronously for interactive exploration</li>
<li><strong>Automatic iframe handling</strong> - Returns both main content and iframe contents in a dict</li>
<li><strong>JavaScript support</strong> - Handles dynamically loaded content automatically</li>
<li><strong>Stealth mode</strong> - Optional bot detection avoidance</li>
<li><strong>CSS selectors</strong> - Extract specific page sections easily</li>
<li><strong>Markdown conversion</strong> - Built-in HTML to markdown conversion</li>
<li><strong>Flexible timeouts</strong> - Configurable pause and timeout parameters</li>
</ol>
<p><strong>Use cases:</strong> - Scraping JavaScript-heavy sites (Discord docs, dynamic help pages) - Extracting content from iframes - Interactive web exploration in notebooks - Quick conversion of web pages to markdown for LLM context</p>
<p>Core Page Functions</p>
<p><strong><code>get_page(*args, stealth=False, **kwargs)</code></strong> - Get a Playwright page object - <code>stealth=True</code> - uses playwright-stealth to avoid bot detection - Returns an async page that can navigate to URLs</p>
<p><strong><code>page_ready(page, pause=50, timeout=5000)</code></strong> - Wait until main content of page is ready - <code>pause</code> - milliseconds to wait (default: 50ms) - <code>timeout</code> - maximum wait time in milliseconds (default: 5000ms)</p>
<p><strong><code>frames_ready(page, pause=50, timeout=5000)</code></strong> - Wait until all visible frames (if any) on page are ready - Handles dynamically loaded iframes</p>
<p><strong><code>wait_page(page, pause=50, timeout=5000)</code></strong> - Wait until page and visible frames (if any) are ready - Combines <code>page_ready</code> and <code>frames_ready</code></p>
<p><strong><code>get_full_content(page)</code></strong> - Returns tuple of (page_content, iframes_dict) - <code>iframes_dict</code> maps iframe IDs to their HTML contents</p>
<p>High-Level Reading Functions</p>
<p><strong><code>read_page_async(url, pause=50, timeout=5000, stealth=False, page=None)</code></strong> - <a href="https://github.com/AnswerDotAI/playwrightnb" title="GitHub - AnswerDotAI/playwrightnb: Use sync mode Playwright interactively, inside a Jupyter notebook">*</a> Return contents of url and its iframes using Playwright async - Handles JavaScript and dynamic content automatically - Returns tuple of (main_content, iframes_dict)</p>
<p><strong><code>read_page(url, pause=50, timeout=5000, stealth=False, page=None)</code></strong> - <a href="https://github.com/AnswerDotAI/playwrightnb" title="GitHub - AnswerDotAI/playwrightnb: Use sync mode Playwright interactively, inside a Jupyter notebook">*</a> Return contents of url and its iframes using Playwright (sync version) - Same as <code>read_page_async</code> but synchronous for easier interactive use - Perfect for Jupyter notebooks</p>
<p>HTML to Markdown Conversion</p>
<p><strong><code>h2md(h)</code></strong> - Convert HTML string to markdown using HTML2Text - Simple utility for converting any HTML to markdown</p>
<p><strong><code>url2md_async(url, sel=None, pause=50, timeout=5000, stealth=False, page=None)</code></strong> - Read URL with <code>read_page_async</code>, optionally selecting CSS selector - Converts result to markdown - <code>sel</code> - CSS selector to extract specific content</p>
<p><strong><code>url2md(url, sel=None, pause=50, timeout=5000, stealth=False, page=None)</code></strong> - Read URL with <code>read_page</code> (sync version) - Optionally select CSS selector and convert to markdown - <a href="https://github.com/AnswerDotAI/playwrightnb" title="GitHub - AnswerDotAI/playwrightnb: Use sync mode Playwright interactively, inside a Jupyter notebook">*</a> Great for accessing Discord’s JS-rendered docs or other dynamic content</p>
<p><strong><code>get2md(url, sel=None, params=None, headers=None, cookies=None, auth=None, proxy=None, follow_redirects=False, verify=True, timeout=5.0, trust_env=True)</code></strong> - <a href="https://github.com/AnswerDotAI/playwrightnb" title="GitHub - AnswerDotAI/playwrightnb: Use sync mode Playwright interactively, inside a Jupyter notebook">*</a> Read URL with httpx.get (no JavaScript rendering) - Faster alternative when you don’t need JS rendering - Supports all standard HTTP options (headers, auth, proxies, etc.) - Optionally select CSS content with <code>sel</code></p>
</section>
<section id="toolslm" class="level4">
<h4 class="anchored" data-anchor-id="toolslm">toolslm</h4>
<p>toolslm provides tools to make language models easier to use, focused on context creation and XML handling:</p>
<p><strong>Context Creation Functions:</strong> - <code>folder2ctx</code> - generates XML context from files, useful for providing file contents to LLMs - <code>json_to_xml</code> - converts JSON/dict structures to XML format</p>
<p><strong>Key modules</strong> (based on the repo structure): - <code>xml</code> - XML handling utilities - <code>funccall</code> - Function calling support - <code>shell</code> - Shell command integration - <code>download</code> - Download utilities - <code>md_hier</code> - Markdown hierarchy handling</p>
<p>The library is designed to help structure information (especially from codebases and files) into XML format that works well with Claude and other LLMs.</p>
<ol type="1">
<li><strong>xml</strong> (<code>toolslm.xml</code>)</li>
</ol>
<p>Provides functions for converting content to XML format optimized for LLMs (especially Claude/Anthropic):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>json_to_xml(d, rnm)</code></td>
<td>Convert a JSON/dict to XML with a root name</td>
</tr>
<tr class="even">
<td><code>mk_doctype(content, src)</code></td>
<td>Create a named tuple with source and content</td>
</tr>
<tr class="odd">
<td><code>mk_doc(index, content, src)</code></td>
<td>Create a single document in Anthropic’s recommended XML format</td>
</tr>
<tr class="even">
<td><code>docs_xml(docs, srcs, prefix, details)</code></td>
<td>Create XML string with multiple documents in Anthropic’s format</td>
</tr>
<tr class="odd">
<td><code>read_file(fname)</code></td>
<td>Read file content, converting notebooks to XML if needed</td>
</tr>
<tr class="even">
<td><code>files2ctx(fnames, prefix)</code></td>
<td>Convert multiple files to XML context</td>
</tr>
<tr class="odd">
<td><code>folder2ctx(folder, prefix, **kwargs)</code></td>
<td>Generate XML context from all files in a folder</td>
</tr>
<tr class="even">
<td><code>folder2ctx_cli</code></td>
<td>Command-line interface for <code>folder2ctx</code></td>
</tr>
<tr class="odd">
<td><code>nb2xml(fname)</code></td>
<td>Convert a Jupyter notebook to XML</td>
</tr>
<tr class="even">
<td><code>cell2xml(cell)</code></td>
<td>Convert a notebook cell to XML format</td>
</tr>
<tr class="odd">
<td><code>cell2out(o)</code></td>
<td>Convert notebook output to XML format</td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li><strong>funccall</strong> (<code>toolslm.funccall</code>)</li>
</ol>
<p>Tools for function calling / tool use with LLMs:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>get_schema(f)</code></td>
<td>Generate JSON schema for a class, function, or method (for tool definitions)</td>
</tr>
<tr class="even">
<td><code>call_func(fc_name, fc_inputs, ns)</code></td>
<td>Call a function by name with inputs using a namespace</td>
</tr>
<tr class="odd">
<td><code>call_func_async(fc_name, fc_inputs, ns)</code></td>
<td>Async version of <code>call_func</code></td>
</tr>
<tr class="even">
<td><code>python(code, glb, loc, timeout)</code></td>
<td>Execute Python code with timeout, returning final expression (like IPython)</td>
</tr>
<tr class="odd">
<td><code>mk_ns(fs)</code></td>
<td>Create a namespace dict from functions or dicts</td>
</tr>
<tr class="even">
<td><code>PathArg(path)</code></td>
<td>Helper for filesystem path arguments</td>
</tr>
</tbody>
</table>
<ol start="3" type="1">
<li><strong>shell</strong> (<code>toolslm.shell</code>)</li>
</ol>
<p>Provides a minimal IPython shell for code execution:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>get_shell()</code></td>
<td>Get a <code>TerminalInteractiveShell</code> with minimal functionality (no logging, history, automagic)</td>
</tr>
<tr class="even">
<td><code>run_cell(cell, timeout)</code></td>
<td>Patched method to run cells with timeout and output capture</td>
</tr>
</tbody>
</table>
<ol start="4" type="1">
<li><strong>download</strong> (<code>toolslm.download</code>)</li>
</ol>
<p>Functions for fetching and processing web content for LLM consumption:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>clean_md(text, rm_comments, rm_details)</code></td>
<td>Remove HTML comments and <code>&lt;details&gt;</code> sections from markdown</td>
</tr>
<tr class="even">
<td><code>read_md(url, ...)</code></td>
<td>Read markdown from URL and clean it</td>
</tr>
<tr class="odd">
<td><code>html2md(s, ignore_links)</code></td>
<td>Convert HTML string to markdown</td>
</tr>
<tr class="even">
<td><code>read_html(url, sel, multi, wrap_tag, ...)</code></td>
<td>Fetch URL, optionally select CSS elements, convert to clean markdown</td>
</tr>
<tr class="odd">
<td><code>get_llmstxt(url, optional, n_workers)</code></td>
<td>Get and expand an <code>llms.txt</code> file (LLM-friendly site documentation)</td>
</tr>
<tr class="even">
<td><code>split_url(url)</code></td>
<td>Split URL into base, path, and filename</td>
</tr>
<tr class="odd">
<td><code>find_docs(url)</code></td>
<td>Find LLM-friendly docs (llms.txt or markdown) from a URL</td>
</tr>
<tr class="even">
<td><code>read_docs(url, ...)</code></td>
<td>Read and return LLM-friendly documentation for a URL</td>
</tr>
</tbody>
</table>
<ol start="5" type="1">
<li><strong>md_hier</strong> (<code>toolslm.md_hier</code>)</li>
</ol>
<p>Parse markdown into a hierarchical dictionary structure:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 55%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Function/Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>HeadingDict</code></td>
<td>A dict subclass that also stores the original markdown text in <code>.text</code></td>
</tr>
<tr class="even">
<td><code>create_heading_dict(text, rm_fenced)</code></td>
<td>Parse markdown into nested dict based on heading hierarchy (e.g., <code>result['Section']['Subsection'].text</code>)</td>
</tr>
</tbody>
</table>
<p>This is useful for navigating and extracting specific sections from markdown documents programmatically.</p>
<p><strong>Summary</strong>: toolslm provides a complete toolkit for preparing context for LLMs - converting files/folders to XML, generating function schemas for tool calling, executing code safely, fetching web documentation, and parsing markdown hierarchically.</p>
</section>
<section id="msglm---message-creation-for-llms" class="level4">
<h4 class="anchored" data-anchor-id="msglm---message-creation-for-llms">msglm - Message Creation for LLMs</h4>
<p>msglm makes it easier to create messages for language models like Claude and OpenAI GPTs.</p>
<p><strong>Text messages:</strong> - <code>mk_msgs</code> - takes a list of strings and an api format (e.g.&nbsp;“openai”) and generates the correct format - <code>mk_msg</code> - creates a single message</p>
<p><strong>API-specific wrappers:</strong> - <code>mk_msg_anthropic</code> / <code>mk_msgs_anthropic</code> - for Anthropic - <code>mk_msg_openai</code> / <code>mk_msgs_openai</code> - for OpenAI</p>
<p><strong>Advanced features:</strong> - Image chats - pass raw image bytes in a list with your question - Prompt caching - pass cache=True to mk_msg or mk_msgs (Anthropic) - PDF support - pass raw pdf bytes just like image chats (Anthropic beta) - <code>mk_ant_doc</code> - creates document objects for Anthropic citations feature</p>
<p><strong>Summary:</strong> toolslm helps structure context (files, XML), while msglm helps format the actual message payloads for different LLM APIs, handling text, images, PDFs, and advanced features like caching and citations.</p>
</section>
</section>
<section id="librairies-using-tools" class="level3">
<h3 class="anchored" data-anchor-id="librairies-using-tools">Librairies using tools</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Library</th>
<th>GitHub Repo URL</th>
<th>Library Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>claudette</strong></td>
<td><a href="https://github.com/AnswerDotAI/claudette" title="GitHub - AnswerDotAI/claudette: Claudette is Claude's friend">*</a> <a href="https://github.com/AnswerDotAI/claudette" title="GitHub - AnswerDotAI/claudette: Claudette is Claude's friend">*</a> <a href="https://github.com/AnswerDotAI/claudette" title="GitHub - AnswerDotAI/claudette: Claudette is Claude's friend">*</a> https://github.com/AnswerDotAI/claudette</td>
<td><a href="https://github.com/AnswerDotAI/claudette" title="GitHub - AnswerDotAI/claudette: Claudette is Claude's friend">*</a> Wrapper for Anthropic’s Python SDK. The SDK works well, but is quite low level. Claudette automates pretty much everything that can be automated, whilst providing full control.</td>
</tr>
<tr class="even">
<td><strong>cosette</strong></td>
<td><a href="https://github.com/AnswerDotAI/cosette" title="GitHub - AnswerDotAI/cosette: Claudette's sister, a helper for OpenAI GPT">*</a> https://github.com/AnswerDotAI/cosette</td>
<td><a href="https://github.com/AnswerDotAI/cosette" title="GitHub - AnswerDotAI/cosette: Claudette's sister, a helper for OpenAI GPT">*</a> Claudette’s sister, a helper for OpenAI GPT. High-level wrapper for OpenAI’s SDK with stateful chat, tool calling, and streaming support.</td>
</tr>
<tr class="odd">
<td><strong>lisette</strong></td>
<td>https://github.com/AnswerDotAI/lisette</td>
<td>LiteLLM helper providing unified access to 100+ LLM providers using the OpenAI API format, with stateful chat, tools, web search, and reasoning support.</td>
</tr>
<tr class="even">
<td><strong>msglm</strong></td>
<td>https://github.com/AnswerDotAI/msglm</td>
<td>Makes it easier to create messages for LLMs (Claude, OpenAI). Handles text, images, PDFs, prompt caching, and API-specific formatting.</td>
</tr>
</tbody>
</table>
</section>
<section id="development-tools" class="level3">
<h3 class="anchored" data-anchor-id="development-tools">Development tools</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Library</th>
<th>GitHub Repo URL</th>
<th>Library Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>fastcaddy</strong></td>
<td>https://github.com/AnswerDotAI/fastcaddy</td>
<td>Python wrapper for Caddy web server integration, simplifying HTTPS setup and reverse proxy configuration for FastHTML apps.</td>
</tr>
<tr class="even">
<td><strong>fastlite</strong></td>
<td><a href="https://github.com/AnswerDotAI" title="Answer.AI · GitHub">*</a> https://github.com/AnswerDotAI/fastlite</td>
<td>A thin, expressive wrapper around SQLite for Python, providing easy database operations with minimal boilerplate.</td>
</tr>
<tr class="odd">
<td><strong>fastlucide</strong></td>
<td>https://github.com/AnswerDotAI/fastlucide</td>
<td>Lucide icons integration for FastHTML applications, providing SVG icons as Python components.</td>
</tr>
<tr class="even">
<td><strong>fasthtml</strong></td>
<td>https://github.com/AnswerDotAI/fasthtml</td>
<td>Modern Python web framework for building HTML applications with HTMX and Starlette, using pure Python for HTML generation.</td>
</tr>
<tr class="odd">
<td><strong>ghapi</strong></td>
<td>https://github.com/AnswerDotAI/ghapi</td>
<td><a href="https://github.com/orgs/AnswerDotAI/repositories" title="AnswerDotAI repositories · GitHub">*</a> A delightful and complete interface to GitHub’s amazing API. Auto-generated Python client covering all GitHub API endpoints.</td>
</tr>
<tr class="even">
<td><strong>monsterui</strong></td>
<td><a href="https://github.com/AnswerDotAI" title="Answer.AI · GitHub">*</a> https://github.com/AnswerDotAI/MonsterUI</td>
<td><a href="https://github.com/AnswerDotAI" title="Answer.AI · GitHub">*</a> MonsterUI is a FastHTML Tailwind-powered UI framework for building beautiful web interfaces with minimal code.</td>
</tr>
<tr class="odd">
<td><strong>nbdev</strong></td>
<td><a href="https://github.com/AnswerDotAI" title="Answer.AI · GitHub">*</a> https://github.com/AnswerDotAI/nbdev</td>
<td>Literate programming framework that allows writing library code, tests, and documentation in Jupyter Notebooks, then exporting to Python modules.</td>
</tr>
<tr class="even">
<td><strong>shell_sage</strong></td>
<td>https://github.com/AnswerDotAI/shell_sage</td>
<td><a href="https://github.com/orgs/AnswerDotAI/repositories" title="AnswerDotAI repositories · GitHub">*</a> ShellSage saves sysadmins’ sanity by solving shell script snafus super swiftly. AI-powered shell command helper.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tools-catalog" class="level2">
<h2 class="anchored" data-anchor-id="tools-catalog">Tools catalog</h2>
<p>Here is the list of tools we want to develop.</p>
<section id="enhance-ipython-kernel" class="level3">
<h3 class="anchored" data-anchor-id="enhance-ipython-kernel">Enhance IPython kernel</h3>
<section id="ipykernel_helper" class="level4">
<h4 class="anchored" data-anchor-id="ipykernel_helper">ipykernel_helper</h4>
<p>ipykernel_helper is a library that provides helper utilities for working with IPython/Jupyter kernels.</p>
<p>It appears to be part of the infrastructure that makes the Dialog Engineering environment work smoothly, providing convenient functions that are useful in an interactive coding environment.</p>
<p><strong>IPython InteractiveShell - Complete Feature Summary</strong></p>
<p><code>InteractiveShell</code> is the core class of IPython, providing an enhanced, interactive Python environment. It’s a singleton class that manages everything from code execution to history, completion, and output formatting.</p>
<ol type="1">
<li><strong>Code Execution</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>run_cell(raw_cell, store_history, silent, shell_futures, cell_id)</code></td>
<td>Run a complete IPython cell including magics</td>
</tr>
<tr class="even">
<td><code>run_cell_async(...)</code></td>
<td>Async version of <code>run_cell</code></td>
</tr>
<tr class="odd">
<td><code>run_code(code_obj, result, async_)</code></td>
<td>Execute a compiled code object</td>
</tr>
<tr class="even">
<td><code>run_ast_nodes(nodelist, cell_name, interactivity, compiler, result)</code></td>
<td>Run a sequence of AST nodes</td>
</tr>
<tr class="odd">
<td><code>run_line_magic(magic_name, line)</code></td>
<td>Execute a line magic like <code>%timeit</code></td>
</tr>
<tr class="even">
<td><code>run_cell_magic(magic_name, line, cell)</code></td>
<td>Execute a cell magic like <code>%%bash</code></td>
</tr>
<tr class="odd">
<td><code>safe_execfile(fname, *where, ...)</code></td>
<td>Safely execute a .py file</td>
</tr>
<tr class="even">
<td><code>safe_execfile_ipy(fname, ...)</code></td>
<td>Execute .ipy or .ipynb files with IPython syntax</td>
</tr>
<tr class="odd">
<td><code>safe_run_module(mod_name, where)</code></td>
<td>Safe version of <code>runpy.run_module()</code></td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li><strong>Namespace Management</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Method/Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>user_ns</code></td>
<td>The user’s namespace dictionary</td>
</tr>
<tr class="even">
<td><code>user_ns_hidden</code></td>
<td>Hidden namespace items (not shown to user)</td>
</tr>
<tr class="odd">
<td><code>all_ns_refs</code></td>
<td>List of all namespace dictionaries where objects may be stored</td>
</tr>
<tr class="even">
<td><code>push(variables, interactive)</code></td>
<td>Inject variables into user namespace</td>
</tr>
<tr class="odd">
<td><code>del_var(varname, by_name)</code></td>
<td>Delete a variable from namespaces</td>
</tr>
<tr class="even">
<td><code>drop_by_id(variables)</code></td>
<td>Remove variables if they match given values</td>
</tr>
<tr class="odd">
<td><code>ev(expr)</code></td>
<td>Evaluate Python expression in user namespace</td>
</tr>
<tr class="even">
<td><code>ex(cmd)</code></td>
<td>Execute Python statement in user namespace</td>
</tr>
<tr class="odd">
<td><code>init_user_ns()</code></td>
<td>Initialize user-visible namespaces to defaults</td>
</tr>
<tr class="even">
<td><code>reset(new_session, aggressive)</code></td>
<td>Clear all internal namespaces</td>
</tr>
<tr class="odd">
<td><code>reset_selective(regex)</code></td>
<td>Clear variables matching a regex pattern</td>
</tr>
</tbody>
</table>
<ol start="3" type="1">
<li><strong>Code Completion</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>init_completer()</code></td>
<td>Initialize completion machinery</td>
</tr>
<tr class="even">
<td><code>complete(text, line, cursor_pos)</code></td>
<td>Return completed text and list of completions</td>
</tr>
<tr class="odd">
<td><code>set_completer_frame(frame)</code></td>
<td>Set the frame for completion context</td>
</tr>
<tr class="even">
<td><code>set_custom_completer(completer, pos)</code></td>
<td>Add a custom completer function</td>
</tr>
</tbody>
</table>
<ol start="4" type="1">
<li><strong>Code Transformation</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Method/Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>transform_cell(raw_cell)</code></td>
<td>Transform input cell before parsing (handles <code>%magic</code>, <code>!system</code>, etc.)</td>
</tr>
<tr class="even">
<td><code>transform_ast(node)</code></td>
<td>Apply AST transformations from <code>ast_transformers</code></td>
</tr>
<tr class="odd">
<td><code>input_transformers_post</code></td>
<td>List of string transformers applied after IPython’s own</td>
</tr>
<tr class="even">
<td><code>ast_transformers</code></td>
<td>List of <code>ast.NodeTransformer</code> instances for code modification</td>
</tr>
<tr class="odd">
<td><code>check_complete(code)</code></td>
<td>Check if code is ready to execute or needs continuation</td>
</tr>
</tbody>
</table>
<ol start="5" type="1">
<li><strong>History Management</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Method/Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>init_history()</code></td>
<td>Setup command history and autosaves</td>
</tr>
<tr class="even">
<td><code>extract_input_lines(range_str, raw)</code></td>
<td>Return input history slices as string</td>
</tr>
<tr class="odd">
<td><code>history_length</code></td>
<td>Total length of command history</td>
</tr>
<tr class="even">
<td><code>history_load_length</code></td>
<td>Number of entries loaded at startup</td>
</tr>
</tbody>
</table>
<ol start="6" type="1">
<li><strong>Magic System</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>find_magic(magic_name, magic_kind)</code></td>
<td>Find and return a magic by name</td>
</tr>
<tr class="even">
<td><code>find_line_magic(magic_name)</code></td>
<td>Find a line magic</td>
</tr>
<tr class="odd">
<td><code>find_cell_magic(magic_name)</code></td>
<td>Find a cell magic</td>
</tr>
<tr class="even">
<td><code>register_magic_function(func, magic_kind, magic_name)</code></td>
<td>Expose a function as a magic</td>
</tr>
<tr class="odd">
<td><code>define_macro(name, themacro)</code></td>
<td>Define a new macro</td>
</tr>
</tbody>
</table>
<ol start="7" type="1">
<li><strong>Object Inspection</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>object_inspect(oname, detail_level)</code></td>
<td>Get object info</td>
</tr>
<tr class="even">
<td><code>object_inspect_mime(oname, detail_level, omit_sections)</code></td>
<td>Get object info as mimebundle</td>
</tr>
<tr class="odd">
<td><code>object_inspect_text(oname, detail_level)</code></td>
<td>Get object info as formatted text</td>
</tr>
<tr class="even">
<td><code>find_user_code(target, raw, py_only, ...)</code></td>
<td>Get code from history, file, URL, or string</td>
</tr>
</tbody>
</table>
<ol start="8" type="1">
<li><strong>Error Handling &amp; Debugging</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Method/Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>showtraceback(exc_tuple, filename, tb_offset, ...)</code></td>
<td>Display exception that just occurred</td>
</tr>
<tr class="even">
<td><code>showsyntaxerror(filename, running_compiled_code)</code></td>
<td>Display syntax error</td>
</tr>
<tr class="odd">
<td><code>showindentationerror()</code></td>
<td>Handle IndentationError</td>
</tr>
<tr class="even">
<td><code>get_exception_only(exc_tuple)</code></td>
<td>Get exception string without traceback</td>
</tr>
<tr class="odd">
<td><code>set_custom_exc(exc_tuple, handler)</code></td>
<td>Set custom exception handler</td>
</tr>
<tr class="even">
<td><code>excepthook(etype, value, tb)</code></td>
<td>Custom sys.excepthook</td>
</tr>
<tr class="odd">
<td><code>debugger(force)</code></td>
<td>Call pdb debugger</td>
</tr>
<tr class="even">
<td><code>call_pdb</code></td>
<td>Control auto-activation of pdb at exceptions</td>
</tr>
<tr class="odd">
<td><code>pdb</code></td>
<td>Automatically call pdb after every exception</td>
</tr>
<tr class="even">
<td><code>xmode</code></td>
<td>Switch modes for exception handlers</td>
</tr>
</tbody>
</table>
<ol start="9" type="1">
<li><strong>System Interaction</strong></li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>system(cmd)</code></td>
<td>Call cmd in subprocess, piping stdout/err</td>
</tr>
<tr class="even">
<td><code>system_piped(cmd)</code></td>
<td>Call cmd with piped output</td>
</tr>
<tr class="odd">
<td><code>system_raw(cmd)</code></td>
<td>Call cmd using os.system or subprocess</td>
</tr>
<tr class="even">
<td><code>getoutput(cmd, split, depth)</code></td>
<td>Get output from subprocess</td>
</tr>
</tbody>
</table>
<ol start="10" type="1">
<li><strong>Expression Evaluation</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>user_expressions(expressions)</code></td>
<td>Evaluate dict of expressions, return rich mime-typed display_data</td>
</tr>
<tr class="even">
<td><code>var_expand(cmd, depth, formatter)</code></td>
<td>Expand Python variables in a string</td>
</tr>
</tbody>
</table>
<ol start="11" type="1">
<li><strong>Async Support</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Property/Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>autoawait</code></td>
<td>Automatically run await in top-level REPL</td>
</tr>
<tr class="even">
<td><code>should_run_async(raw_cell, ...)</code></td>
<td>Determine if cell should run via coroutine runner</td>
</tr>
<tr class="odd">
<td><code>loop_runner</code></td>
<td>Select the loop runner for async code</td>
</tr>
</tbody>
</table>
<ol start="12" type="1">
<li><strong>Configuration Properties</strong></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>autocall</code></td>
<td>Auto-call callable objects (0=off, 1=smart, 2=full)</td>
</tr>
<tr class="even">
<td><code>autoindent</code></td>
<td>Auto-indent code</td>
</tr>
<tr class="odd">
<td><code>automagic</code></td>
<td>Call magics without leading <code>%</code></td>
</tr>
<tr class="even">
<td><code>colors</code></td>
<td>Color scheme (nocolor, neutral, linux, lightbg)</td>
</tr>
<tr class="odd">
<td><code>cache_size</code></td>
<td>Output cache size (default 1000)</td>
</tr>
<tr class="even">
<td><code>ast_node_interactivity</code></td>
<td>Which nodes display output (‘all’, ‘last’, ‘last_expr’, ‘none’, ‘last_expr_or_assign’)</td>
</tr>
<tr class="odd">
<td><code>banner1</code> / <code>banner2</code></td>
<td>Banner text before/after profile</td>
</tr>
<tr class="even">
<td><code>display_page</code></td>
<td>Show pager content as regular output</td>
</tr>
<tr class="odd">
<td><code>enable_html_pager</code></td>
<td>Enable HTML in pagers</td>
</tr>
<tr class="even">
<td><code>enable_tip</code></td>
<td>Show tip on IPython start</td>
</tr>
<tr class="odd">
<td><code>show_rewritten_input</code></td>
<td>Show rewritten input for autocall</td>
</tr>
<tr class="even">
<td><code>sphinxify_docstring</code></td>
<td>Enable rich HTML docstrings</td>
</tr>
<tr class="odd">
<td><code>warn_venv</code></td>
<td>Warn if running in venv without IPython installed</td>
</tr>
</tbody>
</table>
<p><strong>Architecture Summary</strong></p>
<pre><code>┌─────────────────────────────────────────────────────────────────────┐
│                    InteractiveShell (Singleton)                     │
├─────────────────────────────────────────────────────────────────────┤
│  NAMESPACES                                                         │
│    user_ns, user_ns_hidden, all_ns_refs                            │
├─────────────────────────────────────────────────────────────────────┤
│  CODE EXECUTION PIPELINE                                            │
│    raw_cell → transform_cell → parse → transform_ast → run_code    │
├─────────────────────────────────────────────────────────────────────┤
│  SUBSYSTEMS                                                         │
│    • Completer (tab completion)                                     │
│    • History Manager                                                │
│    • Magic System (line/cell magics)                               │
│    • Display Publisher                                              │
│    • Exception Handler / Debugger                                   │
│    • Input Transformers (magics, shell commands)                   │
│    • AST Transformers                                               │
├─────────────────────────────────────────────────────────────────────┤
│  EXTENSIONS                                                         │
│    • Hooks (set_hook)                                               │
│    • Custom completers (set_custom_completer)                      │
│    • Custom exception handlers (set_custom_exc)                    │
│    • Magic functions (register_magic_function)                     │
└─────────────────────────────────────────────────────────────────────┘</code></pre>
<p><strong>How ipykernel_helper Extends InteractiveShell</strong></p>
<p>The <code>ipykernel_helper</code> library uses fastcore’s <code>@patch</code> to add methods to <code>InteractiveShell</code>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Added Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>user_items()</code></td>
<td>Get user-defined vars &amp; functions (filtered)</td>
</tr>
<tr class="even">
<td><code>get_vars(vs)</code></td>
<td>Get specific variable values</td>
</tr>
<tr class="odd">
<td><code>get_schemas(fs)</code></td>
<td>Get JSON schemas for functions (tool calling)</td>
</tr>
<tr class="even">
<td><code>ranked_complete(code, ...)</code></td>
<td>Enhanced completion with ranking</td>
</tr>
<tr class="odd">
<td><code>sig_help(code, ...)</code></td>
<td>Signature help using Jedi</td>
</tr>
<tr class="even">
<td><code>xpush(**kw)</code></td>
<td>Push with kwargs</td>
</tr>
<tr class="odd">
<td><code>publish(data, ...)</code></td>
<td>Enhanced display publishing</td>
</tr>
</tbody>
</table>
<p>This is how solveit extends IPython’s core to support AI-assisted coding!</p>
</section>
<section id="extract-information-from-the-users-namespace" class="level4">
<h4 class="anchored" data-anchor-id="extract-information-from-the-users-namespace">Extract information from the user’s namespace</h4>
<p>These are methods patched onto IPython’s InteractiveShell by ipykernel_helper.</p>
<p>Getting an InteractiveShell instance from a notebook code cell is straightforward.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython <span class="im">import</span> get_ipython</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>shell <span class="op">=</span> get_ipython()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>They help extract information from the user’s namespace for use in dialog/AI contexts.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.user_items(<span class="va">self</span>, max_len<span class="op">=</span><span class="dv">200</span>, xtra_skip<span class="op">=</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: Get user-defined variables and functions from the IPython namespace, filtering out system/internal items.</p>
<p>Returns: Tuple of (user_vars, user_fns) - user_vars: Dict of {var_name: repr_string} - variable names and their string representations (truncated to max_len) - user_fns: Dict of {func_name: signature_string} - user-defined function names and their signatures</p>
<p>What it filters out: - Hidden namespace items (user_ns_hidden) - Items starting with _ - Types, modules, methods, builtins, typing constructs - Specific names like nbmeta, receive_nbmeta</p>
<p>Use case: Let the AI know what variables and functions the user has defined in their session.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.get_vars(<span class="va">self</span>:InteractiveShell, vs:<span class="bu">list</span>, literal<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: Retrieve specific variable values from the namespace</p>
<p>Parameters: - vs: List of variable names to retrieve - literal: If True, try to return actual Python literals; if False, return string representation</p>
<p>Returns: - Dict of {var_name: value} for variables that exist in the namespace</p>
<p>The literal=True behavior: - Tries to repr() the value, then literal_eval() it back - If that succeeds, returns the actual value (works for dicts, lists, strings, numbers, etc.) - If it fails (complex objects), returns the string representation instead</p>
<p>Use case: When the user shares specific variables with the AI using <code>$varname</code> notation, this function retrieves their current values.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.get_schemas(<span class="va">self</span>:InteractiveShell, fs:<span class="bu">list</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: Get JSON schemas for functions (for LLM tool calling).</p>
<p>Parameters: - fs: List of function names to get schemas for</p>
<p>Returns: Dict of {func_name: schema_or_error} - If successful: {‘type’: ‘function’, ‘function’: {JSON schema}} - If not found: “funcname not found. Did you run it?” - If schema error: “funcname: error message”</p>
<p>The schema format (via <a href="https://AnswerDotAI.github.io/toolslm/funccall.html#get_schema"><code>toolslm.funccall.get_schema</code></a>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="er">'type'</span><span class="fu">:</span> <span class="er">'function'</span><span class="fu">,</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="er">'function'</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="er">'name'</span><span class="fu">:</span> <span class="er">'my_func'</span><span class="fu">,</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="er">'description'</span><span class="fu">:</span> <span class="er">'Docstring</span> <span class="er">here'</span><span class="fu">,</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="er">'parameters'</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>            <span class="er">'type'</span><span class="fu">:</span> <span class="er">'object'</span><span class="fu">,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            <span class="er">'properties'</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                <span class="er">'param1'</span><span class="fu">:</span> <span class="fu">{</span><span class="er">'type'</span><span class="fu">:</span> <span class="er">'string'</span><span class="fu">,</span> <span class="er">'descmription'</span><span class="fu">:</span> <span class="er">'...'</span><span class="fu">},</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                <span class="er">'param2'</span><span class="fu">:</span> <span class="fu">{</span><span class="er">'type'</span><span class="fu">:</span> <span class="er">'integer'</span><span class="fu">,</span> <span class="er">'description'</span><span class="fu">:</span> <span class="er">'...'</span><span class="fu">}</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">},</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>            <span class="er">'required'</span><span class="fu">:</span> <span class="ot">[</span><span class="er">'param1'</span><span class="ot">]</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use case: When the user shares tools with the AI using <code>&amp;toolname</code> notation, this function generates the JSON schemas that tell the AI how to call those functions.</p>
</section>
<section id="solveit-use-of-get_vars-and-get_schema" class="level4">
<h4 class="anchored" data-anchor-id="solveit-use-of-get_vars-and-get_schema">Solveit use of get_vars() and get_schema()</h4>
<p>The <code>$varname</code> and <code>&amp;toolname</code> Notation System</p>
<p>Overview</p>
<p>When you write a prompt in solveit containing <code>$myvar</code> or <code>&amp;mytool</code>, the system: 1. <strong>Parses</strong> your prompt for these special notations 2. <strong>Extracts</strong> the referenced names 3. <strong>Retrieves</strong> their values/schemas from the Python namespace 4. <strong>Injects</strong> this information into the context sent to the AI</p>
<p><strong>Variable Sharing: <code>$varname</code></strong></p>
<p>What Happens</p>
<pre><code>User writes prompt:
┌─────────────────────────────────────────────┐
│ "Analyze the data in `$df` and tell me     │
│  the average of the 'sales' column"         │
└─────────────────────────────────────────────┘
                    │
                    ▼
            Parse for $-prefixed names
                    │
                    ▼
            Found: ['df']
                    │
                    ▼
            Call: shell.get_vars(['df'])
                    │
                    ▼
            Retrieve current value of df
                    │
                    ▼
┌─────────────────────────────────────────────┐
│ Context sent to AI includes:                │
│                                             │
│ &lt;variables&gt;                                 │
│   df = DataFrame with 100 rows, columns:    │
│        ['date', 'sales', 'region', ...]     │
│ &lt;/variables&gt;                                │
│                                             │
│ User prompt: "Analyze the data in df..."    │
└─────────────────────────────────────────────┘</code></pre>
<p>Key Behavior</p>
<ol type="1">
<li>Current value: The variable’s value at the time the prompt is sent (not when it was first defined)</li>
<li>Retroactive updates: If you change the variable and re-run, the context updates</li>
<li>Safe representation: Uses <code>_safe_repr()</code> to truncate large values (default 200 chars)</li>
<li>Literal conversion: Tries to preserve actual Python types when possible via <code>literal_eval</code></li>
</ol>
<p>Example Flow</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cell 1: Define data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'a'</span>: [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], <span class="st">'b'</span>: [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]})</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cell 2: Prompt with $df</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># "What's the sum of column 'a' in `$df`?"</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Behind the scenes:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>shell.get_vars([<span class="st">'df'</span>])</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns: {'df': "   a  b\n0  1  4\n1  2  5\n2  3  6"}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Tool Sharing: <code>&amp;toolname</code></strong></p>
<p>What Happens</p>
<pre><code>User writes prompt:
┌─────────────────────────────────────────────┐
│ "Use `&amp;calculate` to add 15 and 27"         │
└─────────────────────────────────────────────┘
                    │
                    ▼
            Parse for &amp;-prefixed names
                    │
                    ▼
            Found: ['calculate']
                    │
                    ▼
            Call: shell.get_schemas(['calculate'])
                    │
                    ▼
            Generate JSON schema from function
                    │
                    ▼
┌─────────────────────────────────────────────┐
│ AI receives tool definition:                │
│                                             │
│ {                                           │
│   "type": "function",                       │
│   "function": {                             │
│     "name": "calculate",                    │
│     "description": "Add two numbers",       │
│     "parameters": {                         │
│       "type": "object",                     │
│       "properties": {                       │
│         "a": {"type": "integer"},           │
│         "b": {"type": "integer"}            │
│       },                                    │
│       "required": ["a", "b"]                │
│     }                                       │
│   }                                         │
│ }                                           │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>Requirements for Tools</strong></p>
<p>From <code>dialoghelper.core.is_usable_tool()</code>, a function must have: 1. Type annotations for all parameters 2. A docstring (becomes the tool description)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ✅ Valid tool</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate(a: <span class="bu">int</span>, b: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add two numbers together"</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ❌ Not usable - no docstring</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bad_tool(a: <span class="bu">int</span>, b: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ❌ Not usable - missing type hints</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> another_bad(a, b):</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add numbers"</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Tool Execution Flow</strong></p>
<p>When the AI decides to use a tool:</p>
<pre><code>┌─────────────────────────────────────────────┐
│ AI Response:                                │
│ "I'll use calculate to add those numbers"   │
│                                             │
│ Tool Call:                                  │
│   name: "calculate"                         │
│   arguments: {"a": 15, "b": 27}             │
└─────────────────────────────────────────────┘
                    │
                    ▼
            solveit receives tool call
                    │
                    ▼
            Look up 'calculate' in namespace
                    │
                    ▼
            Execute: calculate(a=15, b=27)
                    │
                    ▼
            Result: 42
                    │
                    ▼
┌─────────────────────────────────────────────┐
│ Tool result sent back to AI                 │
│                                             │
│ AI continues: "The sum of 15 and 27 is 42"  │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>The Parsing Mechanism</strong></p>
<p>The parsing likely uses regex to find these patterns:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_prompt(prompt):</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find $varname in backticks</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    var_pattern <span class="op">=</span> <span class="vs">r'`</span><span class="ch">\$</span><span class="kw">(</span><span class="dv">\w</span><span class="op">+</span><span class="kw">)</span><span class="vs">`'</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    vars_found <span class="op">=</span> re.findall(var_pattern, prompt)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find &amp;toolname in backticks</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    tool_pattern <span class="op">=</span> <span class="vs">r'`&amp;</span><span class="kw">(</span><span class="dv">\w</span><span class="op">+</span><span class="kw">)</span><span class="vs">`'</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    tools_found <span class="op">=</span> re.findall(tool_pattern, prompt)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vars_found, tools_found</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>prompt <span class="op">=</span> <span class="st">"Use `&amp;calculate` on `$x` and `$y`"</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>parse_prompt(prompt)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns: (['x', 'y'], ['calculate'])</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Complete Architecture</strong></p>
<pre><code>┌─────────────────────────────────────────────────────────────────────┐
│                      USER WRITES PROMPT                             │
│  "Use `&amp;my_tool` to process `$my_data` and return the result"      │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      SOLVEIT FRONTEND                               │
│  1. Parse prompt for `$name` and `&amp;name` patterns                  │
│  2. Extract: vars=['my_data'], tools=['my_tool']                   │
│  3. Request from kernel: get_vars(), get_schemas()                 │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      IPYKERNEL (Python)                             │
│  shell.get_vars(['my_data'])                                       │
│    → {'my_data': [1, 2, 3, 4, 5]}                                  │
│                                                                     │
│  shell.get_schemas(['my_tool'])                                    │
│    → {'my_tool': {'type': 'function', 'function': {...}}}          │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      CONTEXT ASSEMBLY                               │
│  &lt;variables&gt;                                                        │
│    my_data = [1, 2, 3, 4, 5]                                       │
│  &lt;/variables&gt;                                                       │
│                                                                     │
│  Tools: [my_tool schema]                                           │
│                                                                     │
│  Prompt: "Use my_tool to process my_data..."                       │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      AI (Claude/etc)                                │
│  - Sees variable values in context                                 │
│  - Has tool schemas available                                      │
│  - Can call tools, results executed in user's kernel               │
└─────────────────────────────────────────────────────────────────────┘</code></pre>
<p><strong>Key Points</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th><code>$varname</code></th>
<th><code>&amp;toolname</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Purpose</td>
<td>Share variable value</td>
<td>Share function as callable tool</td>
</tr>
<tr class="even">
<td>Retrieval</td>
<td><code>get_vars()</code></td>
<td><code>get_schemas()</code></td>
</tr>
<tr class="odd">
<td>What AI sees</td>
<td>Current value (as string/literal)</td>
<td>JSON schema for tool calling</td>
</tr>
<tr class="even">
<td>Requirements</td>
<td>Variable must exist</td>
<td>Function needs types + docstring</td>
</tr>
<tr class="odd">
<td>AI can modify?</td>
<td>No (read-only snapshot)</td>
<td>Yes (can call the function)</td>
</tr>
</tbody>
</table>
<p><strong>Practical Tips</strong></p>
<ol type="1">
<li>Variables are snapshots: The AI sees the value when you send the prompt</li>
<li>Tools execute in your kernel: Side effects happen in your session</li>
<li>Use backticks: The notation is <code>`$var`</code> and <code>`&amp;tool`</code>, not bare <code>$var</code></li>
<li>Check tool validity: Use <code>is_usable_tool(func)</code> to verify a function can be used as a tool</li>
<li>List tools: Use <code>mk_toollist(symbols)</code> from dialoghelper to see available tools formatted for prompts</li>
</ol>
</section>
<section id="customize-jupyterlab-default-behavior-to-enhance-variables-display" class="level4">
<h4 class="anchored" data-anchor-id="customize-jupyterlab-default-behavior-to-enhance-variables-display">Customize Jupyterlab default behavior to enhance variables display</h4>
<p>Let me explain how JupyterLab’s Debugger panel works and whether you could hook into it.</p>
<p><strong>How JupyterLab’s Debugger Panel Gets Variables</strong></p>
<p>The Debugger panel in JupyterLab uses a completely different mechanism than these ipykernel_helper functions: 1. Debug Adapter Protocol (DAP) - JupyterLab’s debugger communicates via the DAP standard 2. debugpy - The Python debugger backend 3. Kernel debug messages - Special debug_request/debug_reply messages over ZMQ The flow looks like:</p>
<pre><code>JupyterLab Debugger UI
        │
        ▼ (DAP protocol)
    debugpy 
        │
        ▼ (inspects frames)
    Python runtime</code></pre>
<p><strong>The Challenge</strong></p>
<p>The user_items(), get_vars(), get_schemas() functions are: - Pull-based: Called on demand by the solveit frontend - Custom protocol: Use transient display messages or custom endpoints - Namespace-focused: Look at InteractiveShell.user_ns</p>
<p>JupyterLab’s Debugger is: - DAP-based: Uses standardized debug adapter protocol - Frame-focused: Inspects stack frames, not just the namespace - debugpy-controlled: The variable inspection happens inside debugpy</p>
<p><strong>Option: Custom Variable Inspector Extension</strong></p>
<p>Instead of modifying the Debugger, create a JupyterLab extension that: - Sends custom comm messages to the kernel - Calls user_items() or similar - Displays results in a custom panel</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kernel side</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipykernel.comm <span class="im">import</span> Comm</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> send_variables():</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    shell <span class="op">=</span> get_ipython()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    user_vars, user_fns <span class="op">=</span> shell.user_items()</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    comm <span class="op">=</span> Comm(target_name<span class="op">=</span><span class="st">'variable_inspector'</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    comm.send({<span class="st">'vars'</span>: user_vars, <span class="st">'fns'</span>: user_fns})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Practical Recommendation</strong></p>
<p>The easiest approach that gives you similar functionality to solveit’s variable display in standard JupyterLab:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In your notebook or startup file</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython <span class="im">import</span> get_ipython</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_user_items(max_len<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Display user variables and functions like solveit does"""</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    shell <span class="op">=</span> get_ipython()</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    user_vars, user_fns <span class="op">=</span> shell.user_items(max_len<span class="op">=</span>max_len)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    html <span class="op">=</span> <span class="st">"&lt;details open&gt;&lt;summary&gt;&lt;b&gt;Variables&lt;/b&gt;&lt;/summary&gt;&lt;ul&gt;"</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> user_vars.items():</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        html <span class="op">+=</span> <span class="ss">f"&lt;li&gt;&lt;code&gt;</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">&lt;/code&gt;: </span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">&lt;/li&gt;"</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    html <span class="op">+=</span> <span class="st">"&lt;/ul&gt;&lt;/details&gt;"</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    html <span class="op">+=</span> <span class="st">"&lt;details open&gt;&lt;summary&gt;&lt;b&gt;Functions&lt;/b&gt;&lt;/summary&gt;&lt;ul&gt;"</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> user_fns.items():</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        html <span class="op">+=</span> <span class="ss">f"&lt;li&gt;&lt;code&gt;</span><span class="sc">{</span>k<span class="sc">}{</span>v<span class="sc">}</span><span class="ss">&lt;/code&gt;&lt;/li&gt;"</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    html <span class="op">+=</span> <span class="st">"&lt;/ul&gt;&lt;/details&gt;"</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    display(HTML(html))</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Auto-show after each cell (optional)</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co"># get_ipython().events.register('post_run_cell', lambda r: show_user_items())</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="provide-smarter-code-completion-and-signature-help" class="level4">
<h4 class="anchored" data-anchor-id="provide-smarter-code-completion-and-signature-help">Provide smarter code completion and signature help</h4>
<p>Why These Are Better Than Default IPython</p>
<p>Default IPython completion: - No custom ranking (alphabetical or frequency-based) - Includes all <strong>dunder</strong> methods always - Doesn’t prioritize user code</p>
<p>These custom versions: - Smart ranking: user code &gt; builtins &gt; everything else - Filters <strong>dunder</strong> unless explicitly requested - Context-aware (knows about your namespace) - Provides structured data for rich UI display</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.ranked_complete(<span class="va">self</span>:InteractiveShell, code, line_no<span class="op">=</span><span class="va">None</span>, col_no<span class="op">=</span><span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: Provide intelligent, ranked code completions using Jedi, with custom ranking logic.</p>
<p>Parameters: - code: The code string to complete - line_no: Optional line number (1-indexed) - col_no: Optional column number (1-indexed)</p>
<p>Returns: List of completion objects with these attributes: - text - The completion text - type - Type of completion (param, function, module, etc.) - mod - Module where the item is defined - rank - Numeric rank (lower = higher priority)</p>
<p>Ranking logic (lower is better): - Rank 1: Parameters (function arguments being filled) - Rank 2: Local variables/functions (from <strong>main</strong>) - Rank 3: Module members (when completing module.something) - Rank 4: Builtins (like print, len, etc.) - Rank 5: Everything else (imported modules, third-party) - Rank +0.1: Private items (starting with _) - slightly lower priority</p>
<p>Special handling: - Filters out <strong>dunder</strong> methods unless the user explicitly types __ (so they’re not cluttering normal completion) - Deprioritizes private _methods slightly but doesn’t remove them</p>
<p>Use case: Provide better autocomplete suggestions in the solveit dialog environment, prioritizing user-defined items and parameters over stdlib/third-party items.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.sig_help(<span class="va">self</span>:InteractiveShell, code, line_no<span class="op">=</span><span class="va">None</span>, col_no<span class="op">=</span><span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: Get function signature information at the cursor position (like when you type func( and want to see the parameters).</p>
<p>Parameters: - code The code string - line_no Line number where cursor is (1-indexed) - col_no Column number where cursor is (1-indexed)</p>
<p>Returns: List of signature objects, each containing: - label - Full signature description (e.g., “print(value, …, sep=’ ‘, end=’’)”) - typ - Type of callable (function, method, class, etc.) - mod - Module name where it’s defined d- oc - Full docstring - idx - Current parameter index (which parameter the cursor is on) - params - List of parameter dicts with name and desc</p>
<p>How it works: - Uses Jedi’s Interpreter with the current namespace to get context-aware signatures - Falls back to Script (static analysis) if Interpreter doesn’t find anything - Extracts detailed information about each signature - Returns structured data about parameters and documentation</p>
<p>Use case: Power the signature help tooltip in the solveit editor, showing: - What parameters a function takes - Which parameter you’re currently typing - Documentation for each parameter - Full docstring</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Inspector._get_info(<span class="va">self</span>:Inspector, obj, oname<span class="op">=</span><span class="st">''</span>, formatter<span class="op">=</span><span class="va">None</span>, info<span class="op">=</span><span class="va">None</span>, detail_level<span class="op">=</span><span class="dv">0</span>, omit_sections<span class="op">=</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: Customizes the ?? (double question mark) output to display source code as formatted Markdown.</p>
<p>Note: This is patched onto Inspector, not InteractiveShell.</p>
<p>Parameters: - obj: The object being inspected - oname Object name (string) - formatter: Optional formatter - info: Pre-computed info dict - detail_level: 0 = basic (?), 1 = detailed (??) - omit_sections: Sections to skip</p>
<p>How it works: - Calls the original _get_info method first (stored as _orig__get_info) - If detail_level == 0 (single ?), returns original output unchanged - If detail_level == 1 (double ??), creates enhanced Markdown output: - Source code in a Python fenced code block - File path in bold with backticks</p>
<p>Use case: Makes the ?? inspection output much more readable in environments that support Markdown rendering</p>
</section>
<section id="override-ipythons-default-behavior-to-enhance-completions" class="level4">
<h4 class="anchored" data-anchor-id="override-ipythons-default-behavior-to-enhance-completions">Override IPython’s default behavior to enhance completions</h4>
<p>JupyterLab communicates with the kernel via the Jupyter messaging protocol:</p>
<pre><code>┌─────────────────┐                    ┌─────────────────┐
│   JupyterLab    │  complete_request  │    IPython      │
│   Frontend      │ ─────────────────► │    Kernel       │
│                 │                    │                 │
│                 │ ◄───────────────── │                 │
│                 │  complete_reply    │                 │
└─────────────────┘                    └─────────────────┘</code></pre>
<p>The relevant message types are: - complete_request / complete_reply - for autocompletion - inspect_request / inspect_reply - for signature/documentation help</p>
<p><strong>Patch do_complete on the Kernel</strong></p>
<p>The kernel’s do_complete method handles complete_request messages. You can patch it:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipykernel.ipkernel <span class="im">import</span> IPythonKernel</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Store original</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>_original_do_complete <span class="op">=</span> IPythonKernel.do_complete</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="at">@wraps</span>(_original_do_complete)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> custom_do_complete(<span class="va">self</span>, code, cursor_pos):</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Enhanced completion with ranking."""</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get original reply</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    reply <span class="op">=</span> _original_do_complete(<span class="va">self</span>, code, cursor_pos)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> reply[<span class="st">'status'</span>] <span class="op">==</span> <span class="st">'ok'</span>:</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        matches <span class="op">=</span> reply[<span class="st">'matches'</span>]</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Custom ranking logic</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> rank(name):</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>            ...</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filter __dunder__ unless explicitly typing them</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> code[:cursor_pos].split()[<span class="op">-</span><span class="dv">1</span>] <span class="cf">if</span> code[:cursor_pos].split() <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'__'</span> <span class="kw">not</span> <span class="kw">in</span> text:</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">=</span> [m <span class="cf">for</span> m <span class="kw">in</span> matches <span class="cf">if</span> <span class="kw">not</span> m.startswith(<span class="st">'__'</span>)]</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sort by rank</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>        reply[<span class="st">'matches'</span>] <span class="op">=</span> <span class="bu">sorted</span>(matches, key<span class="op">=</span>rank)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reply</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply patch</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>IPythonKernel.do_complete <span class="op">=</span> custom_do_complete</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Patch do_inspect for Signature Help</strong></p>
<p>For enhanced signature/documentation help:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipykernel.ipkernel <span class="im">import</span> IPythonKernel</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jedi <span class="im">import</span> Interpreter</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>_original_do_inspect <span class="op">=</span> IPythonKernel.do_inspect</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="at">@wraps</span>(_original_do_inspect)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> custom_do_inspect(<span class="va">self</span>, code, cursor_pos, detail_level<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Enhanced inspect with Jedi signatures."""</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try Jedi first for better signature info</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        ns <span class="op">=</span> <span class="va">self</span>.shell.user_ns</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get signatures at cursor</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">'status'</span>: <span class="st">'ok'</span>,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">'found'</span>: <span class="va">True</span>,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">'data'</span>: {<span class="st">'text/markdown'</span>: text, <span class="st">'text/plain'</span>: sig.docstring()},</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">'metadata'</span>: {}</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fall back to original</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _original_do_inspect(<span class="va">self</span>, code, cursor_pos, detail_level)</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>IPythonKernel.do_inspect <span class="op">=</span> custom_do_inspect</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Create an IPython Extension</strong></p>
<p>Package everything as a proper IPython extension:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_ipython_extension(ip):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Called when extension is loaded via %load_ext"""</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> ipykernel.ipkernel <span class="im">import</span> IPythonKernel</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Patch do_complete</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    _orig <span class="op">=</span> IPythonKernel.do_complete</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(_orig)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> patched_do_complete(<span class="va">self</span>, code, cursor_pos):</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    IPythonKernel.do_complete <span class="op">=</span> patched_do_complete</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Enhanced completions loaded!"</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> unload_ipython_extension(ip):</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Called when extension is unloaded"""</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Restore original if needed</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Usage:</p>
<pre><code>%load_ext my_completer_extension</code></pre>
<p>Or add to ipython_config.py:</p>
<pre><code>c.InteractiveShellApp.extensions = ['my_completer_extension']</code></pre>
</section>
<section id="programmatically-inject-variables-into-the-user-namespace" class="level4">
<h4 class="anchored" data-anchor-id="programmatically-inject-variables-into-the-user-namespace">Programmatically inject variables into the user namespace</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.xpush(<span class="va">self</span>:InteractiveShell, interactive<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kw):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Like `push`, but with kwargs"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.push(kw, interactive<span class="op">=</span>interactive)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: A convenience wrapper around InteractiveShell.push() that accepts keyword arguments instead of a dictionary.</p>
<p>Parameters: - interactive: If True, the variables are treated as if typed interactively (affects display) - **kw: Variables to inject as keyword arguments</p>
<p>Comparison:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>shell <span class="op">=</span> get_ipython()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard push() - requires a dictionary</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>shell.push({<span class="st">'x'</span>: <span class="dv">42</span>, <span class="st">'name'</span>: <span class="st">'Alice'</span>})</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># xpush() - cleaner kwargs syntax</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>shell.xpush(x<span class="op">=</span><span class="dv">42</span>, name<span class="op">=</span><span class="st">'Alice'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use case: Cleaner API when programmatically injecting variables into the user namespace.</p>
<p><strong>What InteractiveShell.push() does</strong></p>
<p>Purpose: Programmatically add variables to the user’s namespace - as if the user had typed them directly in the notebook.</p>
<p>The interactive Parameter controls how the variables are treated: - interactive=True (default): - Variables treated as if user typed them - Subject to display hooks (e.g., last expression displays) - Triggers post_execute hooks - Can show output - interactive=False: - Variables injected silently - No display output - Minimal side effects - Used for “behind the scenes” injection</p>
<p><strong>Use Cases in solveit</strong></p>
<ol type="1">
<li>Tool Results Injection</li>
</ol>
<p>When the AI calls a tool, the result needs to be available to the user:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AI calls a tool: calculate(5, 3)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate(a: <span class="bu">int</span>, b: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate(<span class="dv">5</span>, <span class="dv">3</span>)  <span class="co"># Tool executes</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Inject result into user namespace</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>shell.xpush(tool_result<span class="op">=</span>result, interactive<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># User can now access it:</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tool_result)  <span class="co"># 8</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Where: <code>claudette.toolloop</code> / <code>cosette.toolloop</code> / <code>lisette.core</code></p>
<p>File &amp; Function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># claudette/toolloop.py</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="at">@patch</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> toolloop(<span class="va">self</span>:Chat, pr, max_steps<span class="op">=</span><span class="dv">10</span>, ...):</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># After tool execution, results are automatically added to chat history</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The tool result becomes part of the conversation context</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Implementation: Tool results are typically kept in the chat history rather than pushed to namespace. However, if you wanted to inject them:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dialoghelper/core.py (hypothetical)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> execute_tool_and_inject(tool_name, args, ns):</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> call_func(tool_name, args, ns)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    shell <span class="op">=</span> get_ipython()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    shell.xpush(<span class="op">**</span>{<span class="ss">f'</span><span class="sc">{</span>tool_name<span class="sc">}</span><span class="ss">_result'</span>: result}, interactive<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Actual location: Not directly implemented in the libraries we explored - this would be custom solveit backend code.</p>
<ol start="2" type="1">
<li>Loading Context from External Sources</li>
</ol>
<p>When importing from a gist or URL:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># User runs: import_gist('abc123')</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Behind the scenes:</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>gist_code <span class="op">=</span> fetch_gist(<span class="st">'abc123'</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(gist_code, globals_dict <span class="op">:=</span> {})</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inject all functions/classes from gist</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>shell.xpush(interactive<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>globals_dict)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now user has access to everything from the gist</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Where: <code>dialoghelper.core</code></p>
<p>File &amp; Function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dialoghelper/core.py</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> import_gist(gist_id:<span class="bu">str</span>, mod_name:<span class="bu">str</span><span class="op">=</span><span class="st">'gist'</span>, run:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key line: <code>shell.user_ns[k] = v</code> - directly modifies namespace (equivalent to <code>push</code>)</p>
<ol start="3" type="1">
<li>AI-Generated Variables</li>
</ol>
<p>When AI generates code that creates variables:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AI generates this code:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>code <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="st">import pandas as pd</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">df = pd.DataFrame({'a': [1,2,3], 'b': [4,5,6]})</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute and capture namespace</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>exec_namespace <span class="op">=</span> {}</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(code, exec_namespace)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Push the dataframe to user</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>shell.xpush(df<span class="op">=</span>exec_namespace[<span class="st">'df'</span>])</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># User now has 'df' available</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Where: <code>execnb.shell</code> / <code>toolslm.shell</code></p>
<p>File &amp; Function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># toolslm/shell.py</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_shell():</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Get a `TerminalInteractiveShell` with minimal functionality"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shell maintains its own namespace</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables from executed code live in shell.user_ns</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># execnb/shell.py (from execnb library)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CaptureShell:</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>, code):</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Executes code and captures outputs</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Variables stay in shell's namespace</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>For injecting into main namespace: Custom solveit code would do:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>shell <span class="op">=</span> get_ipython()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>shell.xpush(<span class="op">**</span>exec_namespace, interactive<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="4" type="1">
<li>Sharing Variables Between Messages</li>
</ol>
<p>When running code in one message and needing results in another:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Message 1 (code cell):</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> expensive_computation()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Behind the scenes, solveit might:</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>shell.xpush(_last_result<span class="op">=</span>x, interactive<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Message 2 (prompt to AI):</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># AI can reference _last_result</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Where: <code>dialoghelper.core</code></p>
<p>File &amp; Function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dialoghelper/core.py</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_msg(content, placement<span class="op">=</span><span class="st">'afterCurrent'</span>, msgid<span class="op">=</span><span class="va">None</span>, msg_type<span class="op">=</span><span class="st">'note'</span>, ...):</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Add a message to dialog"</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Messages can contain code that executes</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Results are automatically in namespace</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_msg(msgid, dname<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Queue a message for execution"</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Executes code cell, results go to namespace automatically</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Implementation: When code cells execute in solveit, they naturally share the same namespace. No explicit <code>push()</code> needed - it’s the default behavior.</p>
<ol start="5" type="1">
<li>Pre-loading Helper Functions</li>
</ol>
<p>When starting a dialog, inject helper utilities:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On dialog start</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dialoghelper <span class="im">import</span> read_msg, add_msg, update_msg</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>shell.xpush(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    read_msg<span class="op">=</span>read_msg,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    add_msg<span class="op">=</span>add_msg,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    update_msg<span class="op">=</span>update_msg,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    interactive<span class="op">=</span><span class="va">False</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now available everywhere in the dialog</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Where: <code>ipykernel_helper.core</code></p>
<p>File &amp; Function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ipykernel_helper/core.py</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_ipython_extension(ip):</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Load extension and inject helper functions"</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> ipykernel_helper <span class="im">import</span> transient, run_cmd</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    ns <span class="op">=</span> ip.user_ns</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    ns[<span class="st">'read_url'</span>] <span class="op">=</span> read_url</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    ns[<span class="st">'transient'</span>] <span class="op">=</span> transient</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    ns[<span class="st">'run_cmd'</span>] <span class="op">=</span> run_cmd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key line: <code>ns['read_url'] = read_url</code> - directly modifies namespace dictionary</p>
<p>Also:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dialoghelper/core.py (hypothetical startup)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_dialog_helpers():</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    shell <span class="op">=</span> get_ipython()</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    shell.xpush(</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>        read_msg<span class="op">=</span>read_msg,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        add_msg<span class="op">=</span>add_msg,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>        update_msg<span class="op">=</span>update_msg,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>        find_msgs<span class="op">=</span>find_msgs,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>        interactive<span class="op">=</span><span class="va">False</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="6" type="1">
<li>Restoring Session State</li>
</ol>
<p>When loading a saved dialog:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load saved state</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>saved_vars <span class="op">=</span> load_dialog_state(<span class="st">'dialog_123'</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># saved_vars = {'x': 42, 'data': [...], 'model': &lt;object&gt;}</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Restore to namespace</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>shell.xpush(interactive<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>saved_vars)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># User's variables are back</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Where: Not explicitly implemented in the libraries we explored</p>
<p>Would be in: Custom solveit backend (not open source)</p>
<p>Hypothetical implementation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solveit/session.py (hypothetical)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> restore_dialog_state(dialog_id):</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Restore variables from saved dialog"</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> pickle</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load saved state</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'dialogs/</span><span class="sc">{</span>dialog_id<span class="sc">}</span><span class="ss">/state.pkl'</span>, <span class="st">'rb'</span>) <span class="im">as</span> f:</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        saved_vars <span class="op">=</span> pickle.load(f)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Restore to namespace</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    shell <span class="op">=</span> get_ipython()</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    shell.xpush(interactive<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>saved_vars)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> saved_vars</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Key Insight</strong></p>
<p>Most of these behaviors don’t explicitly call <code>push()</code> or <code>xpush()</code> - they use alternative approaches:</p>
<ol type="1">
<li><strong>Direct namespace modification</strong>: <code>shell.user_ns['key'] = value</code></li>
<li><strong>Natural code execution</strong>: Code cells share namespace automatically</li>
<li><strong>Extension loading</strong>: Inject at startup via <code>load_ipython_extension()</code></li>
</ol>
<p>The <code>xpush()</code> convenience wrapper is available but many implementations use the underlying mechanisms directly. The actual solveit backend (which orchestrates dialogs, AI interactions, and message execution) likely uses <code>xpush()</code> more extensively, but that code isn’t in the open-source libraries we explored.</p>
<p><strong>Architecture: How solveit Uses push()</strong></p>
<pre><code>┌─────────────────────────────────────────────────────────────────────┐
│                         USER ACTION                                 │
│   • Runs a tool                                                     │
│   • Imports a gist                                                  │
│   • AI generates code                                               │
│   • Loads dialog state                                              │
└────────────────────────────┬────────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    SOLVEIT BACKEND                                  │
│   • Executes code in isolated namespace                             │
│   • Captures results                                                │
│   • Determines what to share with user                              │
└────────────────────────────┬────────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    shell.xpush()                                    │
│   • Injects variables into user namespace                           │
│   • Makes results accessible in subsequent cells                    │
└────────────────────────────┬────────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    USER NAMESPACE                                   │
│   Variables now available:                                          │
│   • print(tool_result)                                              │
│   • df.head()                                                       │
│   • my_imported_function()                                          │
└─────────────────────────────────────────────────────────────────────┘</code></pre>
<p><strong>Example: Complete Tool Execution Flow</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. User shares a tool with AI</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fetch_data(url: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Fetch JSON from URL"""</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> httpx</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> httpx.get(url).json()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. AI decides to call it</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Behind the scenes in solveit:</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>tool_name <span class="op">=</span> <span class="st">"fetch_data"</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>tool_args <span class="op">=</span> {<span class="st">"url"</span>: <span class="st">"https://api.github.com/users/torvalds"</span>}</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Execute tool</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> toolslm.funccall <span class="im">import</span> call_func</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> call_func(tool_name, tool_args, namespace<span class="op">=</span>{<span class="st">'fetch_data'</span>: fetch_data})</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Inject result into user namespace</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>shell <span class="op">=</span> get_ipython()</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>shell.xpush(</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    github_data<span class="op">=</span>result,  <span class="co"># Make result accessible</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    interactive<span class="op">=</span><span class="va">False</span>     <span class="co"># Silent injection</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. User can now use it:</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(github_data[<span class="st">'name'</span>])  <span class="co"># 'Linus Torvalds'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Why Not Just Execute Directly?</strong></p>
<p>You might wonder: why use <code>push()</code> instead of just executing code directly?</p>
<p>Problems: - Harder to control scope - Difficult to inject complex objects - No clean separation between execution and namespace injection - Can’t easily inject from external sources</p>
<p>Benefits of using push: - Clean API for namespace manipulation - Works with any Python object (including unpicklable ones) - Respects IPython’s namespace management - Can control interactive behavior - Integrates with IPython’s hooks and events</p>
<p><strong>Summary</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Purpose in solveit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tool results</td>
<td>Make AI tool outputs available to user</td>
</tr>
<tr class="even">
<td>Gist imports</td>
<td>Inject functions from GitHub gists</td>
</tr>
<tr class="odd">
<td>AI code execution</td>
<td>Share variables from AI-generated code</td>
</tr>
<tr class="even">
<td>Session restoration</td>
<td>Reload saved dialog state</td>
</tr>
<tr class="odd">
<td>Helper injection</td>
<td>Pre-load utility functions</td>
</tr>
<tr class="even">
<td>Context sharing</td>
<td>Pass data between messages/cells</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Use Case</th>
<th>Library</th>
<th>File</th>
<th>Function/Method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1. Tool Results</td>
<td>(custom solveit)</td>
<td>N/A</td>
<td>Not in open source libs</td>
</tr>
<tr class="even">
<td>2. Gist Imports</td>
<td><code>dialoghelper</code></td>
<td><code>core.py</code></td>
<td><code>import_gist()</code></td>
</tr>
<tr class="odd">
<td>3. AI-Generated Vars</td>
<td><code>execnb</code> / <code>toolslm</code></td>
<td><code>shell.py</code></td>
<td><code>CaptureShell.run()</code> / <code>get_shell()</code></td>
</tr>
<tr class="even">
<td>4. Message Variables</td>
<td><code>dialoghelper</code></td>
<td><code>core.py</code></td>
<td><code>run_msg()</code>, <code>add_msg()</code></td>
</tr>
<tr class="odd">
<td>5. Helper Pre-loading</td>
<td><code>ipykernel_helper</code></td>
<td><code>core.py</code></td>
<td><code>load_ipython_extension()</code></td>
</tr>
<tr class="even">
<td>6. Session Restoration</td>
<td>(custom solveit)</td>
<td>N/A</td>
<td>Not in open source libs</td>
</tr>
</tbody>
</table>
<p>Key insight: <code>push()</code> / <code>xpush()</code> is the bridge between solveit’s backend execution and the user’s interactive namespace. It’s how results from AI actions become available for the user to work with.</p>
</section>
<section id="send-commands-and-display-data-to-the-javascript-frontend" class="level4">
<h4 class="anchored" data-anchor-id="send-commands-and-display-data-to-the-javascript-frontend">Send commands and display data to the Javascript frontend</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.run_cmd(cmd, data<span class="op">=</span><span class="st">''</span>, meta<span class="op">=</span><span class="va">None</span>, update<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kw)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: a convenience wrapper that sends a command to the frontend via the transient mechanism.</p>
<p>Internally using: <code>InteractiveShell.transient()</code>.</p>
<p>In Jupyter, when you output something, it gets sent to the frontend via a display_data or execute_result message. These messages have three main parts:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"data"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"text/plain"</span><span class="fu">:</span> <span class="st">"Hello"</span><span class="fu">,</span> <span class="dt">"text/html"</span><span class="fu">:</span> <span class="st">"&lt;b&gt;Hello&lt;/b&gt;"</span><span class="fu">},</span>  <span class="er">#</span> <span class="er">The</span> <span class="er">content</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"metadata"</span><span class="fu">:</span> <span class="fu">{},</span>  <span class="er">#</span> <span class="er">Extra</span> <span class="er">info</span> <span class="er">about</span> <span class="er">the</span> <span class="er">content</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"transient"</span><span class="fu">:</span> <span class="fu">{}</span>  <span class="er">#</span> <span class="er">Data</span> <span class="er">that</span> <span class="er">should</span> <span class="er">NOT</span> <span class="er">be</span> <span class="er">persisted</span> <span class="er">in</span> <span class="er">the</span> <span class="er">notebook</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Sends display data to the frontend where the actual payload is in the transient field, not the main data field.</p>
<p>The key insight: transient data is displayed but not saved when the notebook is saved. It’s ephemeral.</p>
<p>Why use transient? - Not saved to notebook - Commands and temporary UI updates don’t clutter the saved .ipynb file - Custom frontend communication - The solveit frontend watches for specific transient keys - Ephemeral state - Progress indicators, status updates, commands that shouldn’t persist</p>
<p>Example usage: <code>run_cmd("scroll_to", msg_id="abc123")</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>InteractiveShell.publish(<span class="va">self</span>:InteractiveShell, data<span class="op">=</span><span class="st">''</span>, subtype<span class="op">=</span><span class="st">'plain'</span>, mimetype<span class="op">=</span><span class="st">'text'</span>, meta<span class="op">=</span><span class="va">None</span>, update<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kw)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>InteractiveShell.transient(data<span class="op">=</span><span class="st">''</span>, subtype<span class="op">=</span><span class="st">'plain'</span>, mimetype<span class="op">=</span><span class="st">'text'</span>, meta<span class="op">=</span><span class="va">None</span>, update<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kw)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Purpose: A flexible method to publish display data to the frontend, with support for transient data.</p>
<p>Parameters: - data: Content to display (string, DisplayObject, or dict) - subtype: MIME subtype (default: ‘plain’) - mimetype: MIME type (default: ‘text’) → combined as text/plain - meta: Metadata dictionary - update: If True, updates a previous display with same -display_id - **kw: Extra kwargs go into the transient field</p>
<p>How it works: - If data is a DisplayObject (like HTML, Markdown), it formats it properly - If data is not a dict/mapping, it wraps it as {mimetype/subtype: data} - Publishes via display_pub.publish() with transient data in **kw</p>
<p>Examples:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>shell <span class="op">=</span> get_ipython()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Publish plain text</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>shell.publish(<span class="st">"Hello, world!"</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Publish HTML</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>shell.publish(<span class="st">"&lt;b&gt;Bold text&lt;/b&gt;"</span>, subtype<span class="op">=</span><span class="st">'html'</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Publish with transient data (for frontend commands)</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>shell.publish(<span class="st">"status"</span>, cmd<span class="op">=</span><span class="st">"update_status"</span>, <span class="bu">id</span><span class="op">=</span><span class="st">"123"</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Publish a DisplayObject</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>shell.publish(HTML(<span class="st">"&lt;h1&gt;Title&lt;/h1&gt;"</span>))</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Update an existing display</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>shell.publish(<span class="st">"Updated content"</span>, update<span class="op">=</span><span class="va">True</span>, display_id<span class="op">=</span><span class="st">"my_display"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>publish() is the lower-level method that transient() essentially wraps.</p>
</section>
</section>
<section id="web-access" class="level3">
<h3 class="anchored" data-anchor-id="web-access">Web access</h3>
<p>I have access to two main tools:</p>
<ol type="1">
<li>Web Search - I can search for current information, recent events, technical documentation, news, and anything where up-to-date data would be helpful. I use this when:</li>
</ol>
<ul>
<li>You need recent information (after my March 2025 knowledge cutoff)</li>
<li>You’re looking for specific facts or current conditions</li>
<li>Real-time data is important (weather, news, stock prices, etc.)</li>
</ul>
<ol start="2" type="1">
<li>Read URL - I can fetch and read content from specific web pages you provide, which is useful for analyzing articles, documentation, or other online content.</li>
</ol>
<p>I use these tools strategically - I don’t search for things I already know well (like general programming concepts, historical facts, or established knowledge), but I will search when current or specific information would genuinely help answer your question.</p>
<section id="model-inference-service" class="level4">
<h4 class="anchored" data-anchor-id="model-inference-service">Model inference service</h4>
<p>The web_search function isn’t defined in your Python environment - it’s a tool that’s available to me (the AI assistant) but not directly accessible to you in your Python code.</p>
<p>When I use web_search, I’m calling it through my own tool-calling mechanism, not through your Python interpreter. It’s part of my capabilities, separate from the Python environment you’re working in.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>web_search(query: <span class="bu">str</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Parameters - Takes a search query string and returns web search results</p>
</section>
<section id="ipykernel_helper-1" class="level4">
<h4 class="anchored" data-anchor-id="ipykernel_helper-1">ipykernel_helper</h4>
<p>Full-featured URL reader that can extract sections, convert to markdown, handle math (KaTeX/MathJax), absolutify image URLs, and optionally tag images for AI processing</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>read_url(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    url: <span class="bu">str</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    as_md: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    extract_section: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    selector: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Parameters - url: The URL to read (required) - as_md: Whether to convert HTML to Markdown (default: True) - extract_section: If URL has an anchor, return only that section (default: True) - selector: CSS selector to extract specific sections using BeautifulSoup.select syntax (optional)</p>
<p>Uses internally - scrape_url() - Fetch URL content using cloudscraper (handles anti-bot protections) - get_md() - Convert HTML to clean markdown</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/wordslab-org\.github\.io\/wordslab-notebooks-lib");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/wordslab-org/wordslab-notebooks-lib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>