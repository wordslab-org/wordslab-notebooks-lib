<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Access wordslab-notebooks Jupyterlab extension version, current notebook path, json content and cell id, and create or update cells.">

<title>wordslab-notebooks-lib.notebook – wordslab-notebooks-lib</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="wordslab-notebooks-lib.notebook – wordslab-notebooks-lib">
<meta property="og:description" content="Access wordslab-notebooks Jupyterlab extension version, current notebook path, json content and cell id, and create or update cells.">
<meta property="og:site_name" content="wordslab-notebooks-lib">
<meta name="twitter:title" content="wordslab-notebooks-lib.notebook – wordslab-notebooks-lib">
<meta name="twitter:description" content="Access wordslab-notebooks Jupyterlab extension version, current notebook path, json content and cell id, and create or update cells.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">wordslab-notebooks-lib</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./notebook.html">wordslab-notebooks-lib.notebook</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.core</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.env</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.chat</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">wordslab-notebooks-lib.tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_answerai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Answerai tools study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_anthropic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anthropic tools study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools_study_mistral-vibe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mistral vibe 2.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">wordslab-notebooks-lib.notebook</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#work-with-ai-in-a-jupyterlab-notebook---the-solveit-method" id="toc-work-with-ai-in-a-jupyterlab-notebook---the-solveit-method" class="nav-link active" data-scroll-target="#work-with-ai-in-a-jupyterlab-notebook---the-solveit-method">Work with AI in a Jupyterlab notebook - the Solveit method</a></li>
  <li><a href="#install-the-jupyterlab-extension---wordslab-notebooks-lib" id="toc-install-the-jupyterlab-extension---wordslab-notebooks-lib" class="nav-link" data-scroll-target="#install-the-jupyterlab-extension---wordslab-notebooks-lib">Install the Jupyterlab extension - wordslab-notebooks-lib</a></li>
  <li><a href="#extend-the-ipython-kernel-with-useful-utilities" id="toc-extend-the-ipython-kernel-with-useful-utilities" class="nav-link" data-scroll-target="#extend-the-ipython-kernel-with-useful-utilities">Extend the ipython kernel with useful utilities</a>
  <ul class="collapse">
  <li><a href="#interactiveshell.user_items" id="toc-interactiveshell.user_items" class="nav-link" data-scroll-target="#interactiveshell.user_items">InteractiveShell.user_items</a></li>
  <li><a href="#interactiveshell.get_variables_values" id="toc-interactiveshell.get_variables_values" class="nav-link" data-scroll-target="#interactiveshell.get_variables_values">InteractiveShell.get_variables_values</a></li>
  <li><a href="#interactiveshell.get_tools_schemas_and_functions" id="toc-interactiveshell.get_tools_schemas_and_functions" class="nav-link" data-scroll-target="#interactiveshell.get_tools_schemas_and_functions">InteractiveShell.get_tools_schemas_and_functions</a></li>
  </ul></li>
  <li><a href="#access-the-notebook-path-cells-content-and-current-cell-id" id="toc-access-the-notebook-path-cells-content-and-current-cell-id" class="nav-link" data-scroll-target="#access-the-notebook-path-cells-content-and-current-cell-id">Access the notebook path, cells content and current cell id</a>
  <ul class="collapse">
  <li><a href="#find_var" id="toc-find_var" class="nav-link" data-scroll-target="#find_var">find_var</a></li>
  <li><a href="#wordslabnotebook" id="toc-wordslabnotebook" class="nav-link" data-scroll-target="#wordslabnotebook">WordslabNotebook</a></li>
  </ul></li>
  <li><a href="#create-update-delete-and-run-notebook-cells" id="toc-create-update-delete-and-run-notebook-cells" class="nav-link" data-scroll-target="#create-update-delete-and-run-notebook-cells">Create, update, delete and run notebook cells</a>
  <ul class="collapse">
  <li><a href="#wordslabnotebook.add_cell" id="toc-wordslabnotebook.add_cell" class="nav-link" data-scroll-target="#wordslabnotebook.add_cell">WordslabNotebook.add_cell</a></li>
  <li><a href="#wordslabnotebook.update_cell" id="toc-wordslabnotebook.update_cell" class="nav-link" data-scroll-target="#wordslabnotebook.update_cell">WordslabNotebook.update_cell</a></li>
  <li><a href="#wordslabnotebook.delete_cell" id="toc-wordslabnotebook.delete_cell" class="nav-link" data-scroll-target="#wordslabnotebook.delete_cell">WordslabNotebook.delete_cell</a></li>
  <li><a href="#wordslabnotebook.run_cell" id="toc-wordslabnotebook.run_cell" class="nav-link" data-scroll-target="#wordslabnotebook.run_cell">WordslabNotebook.run_cell</a></li>
  <li><a href="#wordslabnotebook.read_cell" id="toc-wordslabnotebook.read_cell" class="nav-link" data-scroll-target="#wordslabnotebook.read_cell">WordslabNotebook.read_cell</a></li>
  </ul></li>
  <li><a href="#explore-the-notebook-variables-functions-and-objects" id="toc-explore-the-notebook-variables-functions-and-objects" class="nav-link" data-scroll-target="#explore-the-notebook-variables-functions-and-objects">Explore the notebook variables, functions and objects</a>
  <ul class="collapse">
  <li><a href="#wordslabnotebook.show_variables_and_functions" id="toc-wordslabnotebook.show_variables_and_functions" class="nav-link" data-scroll-target="#wordslabnotebook.show_variables_and_functions">WordslabNotebook.show_variables_and_functions</a></li>
  <li><a href="#wordslabnotebook.show_object_members" id="toc-wordslabnotebook.show_object_members" class="nav-link" data-scroll-target="#wordslabnotebook.show_object_members">WordslabNotebook.show_object_members</a></li>
  </ul></li>
  <li><a href="#get-variable-values-and-tool-schemas-referenced-in-prompt-cells" id="toc-get-variable-values-and-tool-schemas-referenced-in-prompt-cells" class="nav-link" data-scroll-target="#get-variable-values-and-tool-schemas-referenced-in-prompt-cells">Get $variable values and &amp;tool schemas referenced in prompt cells</a>
  <ul class="collapse">
  <li><a href="#wordslabnotebook.get_tools_schemas_and_functions" id="toc-wordslabnotebook.get_tools_schemas_and_functions" class="nav-link" data-scroll-target="#wordslabnotebook.get_tools_schemas_and_functions">WordslabNotebook.get_tools_schemas_and_functions</a></li>
  <li><a href="#wordslabnotebook.get_variables_values" id="toc-wordslabnotebook.get_variables_values" class="nav-link" data-scroll-target="#wordslabnotebook.get_variables_values">WordslabNotebook.get_variables_values</a></li>
  </ul></li>
  <li><a href="#collect-the-notebook-context-for-llm-calls" id="toc-collect-the-notebook-context-for-llm-calls" class="nav-link" data-scroll-target="#collect-the-notebook-context-for-llm-calls">Collect the notebook context for LLM calls</a>
  <ul class="collapse">
  <li><a href="#wordslabnotebook.get_context_for_llm" id="toc-wordslabnotebook.get_context_for_llm" class="nav-link" data-scroll-target="#wordslabnotebook.get_context_for_llm">WordslabNotebook.get_context_for_llm</a></li>
  </ul></li>
  <li><a href="#notebook.chat---the-notebook-assistant" id="toc-notebook.chat---the-notebook-assistant" class="nav-link" data-scroll-target="#notebook.chat---the-notebook-assistant">notebook.chat - the notebook assistant</a>
  <ul class="collapse">
  <li><a href="#prompt-template" id="toc-prompt-template" class="nav-link" data-scroll-target="#prompt-template">Prompt template</a></li>
  <li><a href="#tools-and-variables" id="toc-tools-and-variables" class="nav-link" data-scroll-target="#tools-and-variables">Tools and variables</a></li>
  <li><a href="#wordslabnotebook.set_ollama_chat_model" id="toc-wordslabnotebook.set_ollama_chat_model" class="nav-link" data-scroll-target="#wordslabnotebook.set_ollama_chat_model">WordslabNotebook.set_ollama_chat_model</a></li>
  <li><a href="#wordslabnotebook.set_openrouter_chat_model" id="toc-wordslabnotebook.set_openrouter_chat_model" class="nav-link" data-scroll-target="#wordslabnotebook.set_openrouter_chat_model">WordslabNotebook.set_openrouter_chat_model</a></li>
  <li><a href="#wordslabnotebook.chat" id="toc-wordslabnotebook.chat" class="nav-link" data-scroll-target="#wordslabnotebook.chat">WordslabNotebook.chat</a></li>
  </ul></li>
  <li><a href="#develop-a-jupyterlab-frontend-extension" id="toc-develop-a-jupyterlab-frontend-extension" class="nav-link" data-scroll-target="#develop-a-jupyterlab-frontend-extension">Develop a Jupyterlab frontend extension</a>
  <ul class="collapse">
  <li><a href="#understand-jupyterlab-kernels-and-frontend-extensions" id="toc-understand-jupyterlab-kernels-and-frontend-extensions" class="nav-link" data-scroll-target="#understand-jupyterlab-kernels-and-frontend-extensions">Understand Jupyterlab kernels and frontend extensions</a></li>
  <li><a href="#intialize-the-components-of-a-frontend-extension" id="toc-intialize-the-components-of-a-frontend-extension" class="nav-link" data-scroll-target="#intialize-the-components-of-a-frontend-extension">Intialize the components of a frontend extension</a></li>
  <li><a href="#install-the-jupyterlab-frontend-extension-in-development-mode" id="toc-install-the-jupyterlab-frontend-extension-in-development-mode" class="nav-link" data-scroll-target="#install-the-jupyterlab-frontend-extension-in-development-mode">Install the Jupyterlab frontend extension in development mode</a></li>
  <li><a href="#test-the-jupyterlab-frontend-extension" id="toc-test-the-jupyterlab-frontend-extension" class="nav-link" data-scroll-target="#test-the-jupyterlab-frontend-extension">Test the Jupyterlab frontend extension</a></li>
  </ul></li>
  <li><a href="#explore-the-notebook-format" id="toc-explore-the-notebook-format" class="nav-link" data-scroll-target="#explore-the-notebook-format">Explore the notebook format</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/wordslab-org/wordslab-notebooks-lib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="notebook.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">wordslab-notebooks-lib.notebook</h1>
</div>

<div>
  <div class="description">
    Access wordslab-notebooks Jupyterlab extension version, current notebook path, json content and cell id, and create or update cells.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="work-with-ai-in-a-jupyterlab-notebook---the-solveit-method" class="level2">
<h2 class="anchored" data-anchor-id="work-with-ai-in-a-jupyterlab-notebook---the-solveit-method">Work with AI in a Jupyterlab notebook - the Solveit method</h2>
<p>A Jupyter notebook is a convenient way to build context for a LLM one cell after the other: you are working in a fully editable conversation, while interacting with AI and with code.</p>
<p><strong>Jeremy Howard</strong> and his team at <strong>Answer.ai</strong> explored how to work efficiently in this kind of conversation: they developed a method and platform called Solveit.</p>
<p>https://solve.it.com/</p>
<p>We would like to replicate this approach to working with AI in a wordslab notebooks environment.</p>
<p>Here is how we chose to do it: - in a jupyterlab notebook, there are two types of cells: markdown and code - we want to simulate a third type of cell: a “prompt” cell - the content of this cell is a prompt (text in markdown format) which is sent to an llm when the cell is executed, along with the text of all the cells situated above in the notebook (context) - the llm response is streamed just below and formatted as markdown.</p>
<p>To simulate this “prompt” cell we need to develop a <strong>Jupyterlab frontend extension</strong> which implements the following behaviors : - three buttons are added to the cell toolbar: “note”, “prompt”, “code” - a click on one of these buttons changes the type of the cell - “note” selects a classic markdown cell - “prompt” selects a code cell, modified with the special “prompt behavior” defined below - “code” selects a classic code cell - a “prompt” cell is distinguished from a regular code cell by a metadata property registered in the ipynb file - each cell type is visualized by a specific color in the left border of the cell - “note” cell has a green border - “prompt” cell a red border - “code” cell has a blue border - the “prompt” cell is a code cell with the specific modified behaviors - the code syntax highlighting is replaced by markdown syntax highlighting when the user types text in this cell - when the user executes this cell, the frontend extension does the following - calls the kernel to inject the following variables - __notebook_path with the path and name of the notebook in the workspace - __notebook_content with the full json representation of the notebook - __cell_id with the id of the current cell - then calls the kernel to execute a specific chat(message) python function - where the message parameter is the content of the cell - and the content of the notebook above the current cell is inluded as context - the python chat() function streams the response tokens from the llm to the output section of the code cell, with markdown rendering</p>
<p>See the section “Develop a Jupyterlab frontend extension” at the bottom of this page to understand how the extension was developed.</p>
</section>
<section id="install-the-jupyterlab-extension---wordslab-notebooks-lib" class="level2">
<h2 class="anchored" data-anchor-id="install-the-jupyterlab-extension---wordslab-notebooks-lib">Install the Jupyterlab extension - wordslab-notebooks-lib</h2>
<p>If you want to use “prompt” cells, you will first need to install the Jupyterlab frontend extension: - activate your Jupyterlab python virtual environment - <strong>pip install wordslab-notebooks-lib</strong> - restart your Jupyterlab server</p>
<p>The extension is <strong>already pre-installed in the wordslab-notebooks environment</strong>.</p>
<p>To be clear: the wordslab-notebooks-lib package contains both: the Javascript Jupyterlab frontend extension AND the python library wich is loaded in the python kernel.</p>
<p>The Jupyterlab frontend extension is reloaded and re-initialized each time you refresh your browser page: - to check is the extension is installed and running, look at the browser console and llok for the message ‘Wordslab notebooks extension vx.y.z activated’ - hit the refresh button if you encounter a bug and the extension stops working</p>
</section>
<section id="extend-the-ipython-kernel-with-useful-utilities" class="level2">
<h2 class="anchored" data-anchor-id="extend-the-ipython-kernel-with-useful-utilities">Extend the ipython kernel with useful utilities</h2>
<p>You also need to install the wordslab-notebooks-lib library in the virtual environnement used by the ipython kernel which runs each notebook in which you want to use the Solveit method.</p>
<p>It is the client of the Jupyterlab extension, and provides many utilties and tools which support this new way of working with AI.</p>
<p>The main python object used to interact with an ipython kernel is the InteractiveShell. You get an instance of it with the get_ipython() method.</p>
<div id="a7cf728f-e3b3-425d-b6ea-0d2a7692933c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>shell <span class="op">=</span> get_ipython()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(shell)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>ipykernel.zmqshell.ZMQInteractiveShell</code></pre>
</div>
</div>
<p>We will start by extending this shell with capabilities useful to work in a notebook with the Solveit method. These extensions are inspired by the library <strong>ipykernel_helper</strong> from <strong>Answer.ai</strong>. As of december 2025, this library is not open source, but it is available to users in the solve.it.com environment and is a dependency of other Apache 2.0 libraries, so I think it is OK to use it as an inspiration.</p>
<div id="746162ba-6e11-4686-9a20-2033b332ad51" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>escape??</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> escape(s, quote<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Replace special characters "&amp;", "&lt;" and "&gt;" to HTML-safe sequences.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">    If the optional flag quote is true (the default), the quotation mark</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">    characters, both double quote (") and single quote (') characters are also</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">    translated.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> s.replace(<span class="st">"&amp;"</span>, <span class="st">"&amp;amp;"</span>) <span class="co"># Must be done first!</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> s.replace(<span class="st">"&lt;"</span>, <span class="st">"&amp;lt;"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> s.replace(<span class="st">"&gt;"</span>, <span class="st">"&amp;gt;"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> quote:</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s.replace(<span class="st">'"'</span>, <span class="st">"&amp;quot;"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s.replace(<span class="st">'</span><span class="ch">\'</span><span class="st">'</span>, <span class="st">"&amp;#x27;"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>File:</strong> <code>/home/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/html/__init__.py</code></p>
</div>
</div>
<hr>
<section id="interactiveshell.user_items" class="level3">
<h3 class="anchored" data-anchor-id="interactiveshell.user_items">InteractiveShell.user_items</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> user_items(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    max_str_len:<span class="bu">int</span><span class="op">=</span><span class="dv">200</span>, xtra_ignore:<span class="bu">tuple</span><span class="op">=</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Get an overview of the variables &amp; functions defined by the user so far in the notebook.</em> The value addded by this function is to filter out all internal ipython and wordslab variables. Returns a tuple of dictionaries (user_variables, user_functions): - the keys are the variables or function names - the value is a truncated string representation of the variable value or the function signature The <code>max_str_len</code> parameter is used to truncate the string representation of the variables. The <code>xtra_ignore</code> parameter is used to hide additional names from the result.</p>
<div id="17e557f5-c6d7-4d95-90dc-e0fc0986c8e2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>variables, functions <span class="op">=</span> shell.user_items()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>variables, functions</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>({'Code': "functools.partial(&lt;function ft&gt;, 'code', void_=False)",
  'Source': "functools.partial(&lt;function ft&gt;, 'source', void_=True)",
  'shell': '&lt;ipykernel.zmqshell.ZMQInteractiveShell object&gt;',
  'user_items': 'None'},
 {'_safe_str': '(obj, max_str_len=200)'})</code></pre>
</div>
</div>
<hr>
</section>
<section id="interactiveshell.get_variables_values" class="level3">
<h3 class="anchored" data-anchor-id="interactiveshell.get_variables_values">InteractiveShell.get_variables_values</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_variables_values(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    var_names:<span class="bu">list</span>, literal:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Get a safe and serializable representation of variables values from the user namespace.</em> This method preserves real Python values when they are safe literals, otherwise it falls back to strings. You can call it in two modes: - literal = True : Preserve actual Python values when safe, best for internal tools - literal = False : Force everything to strings, best for logging / UI display / debug output</p>
<div id="dcc6e3b0-e546-4f3a-b69b-fe8148ea6e67" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>shell.get_variables_values(var_names<span class="op">=</span>[<span class="st">"variables"</span>, <span class="st">"functions"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'variables': {'Code': "functools.partial(&lt;function ft&gt;, 'code', void_=False)",
  'Source': "functools.partial(&lt;function ft&gt;, 'source', void_=True)",
  'shell': '&lt;ipykernel.zmqshell.ZMQInteractiveShell object&gt;',
  'user_items': 'None'},
 'functions': {'_safe_str': '(obj, max_str_len=200)'}}</code></pre>
</div>
</div>
<hr>
</section>
<section id="interactiveshell.get_tools_schemas_and_functions" class="level3">
<h3 class="anchored" data-anchor-id="interactiveshell.get_tools_schemas_and_functions">InteractiveShell.get_tools_schemas_and_functions</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_tools_schemas_and_functions(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    func_names:<span class="bu">list</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Get a json schema and a function object for the functions defined in the user namespace which can be used as tools.</em></p>
<div id="00b31ae9-1324-42ea-95e8-a694032f2e74" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example tool definition</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> example_sum(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    a: <span class="bu">int</span>,  <span class="co"># First thing to sum</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    b: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1</span>,  <span class="co"># Second thing to sum</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">int</span>:  <span class="co"># The sum of the inputs</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Adds a + b."</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="e1e38efd-ca9c-4857-8caa-764dcc98586c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>shell.get_tools_schemas_and_functions([<span class="st">"example_sum"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'example_sum': ({'type': 'function',
   'function': {'name': 'example_sum',
    'description': 'Adds a + b.\n\nReturns:\n- type: integer',
    'parameters': {'type': 'object',
     'properties': {'a': {'type': 'integer',
       'description': 'First thing to sum'},
      'b': {'type': 'integer',
       'description': 'Second thing to sum',
       'default': 1}},
     'required': ['a']}}},
  &lt;function __main__.example_sum(a: int, b: int = 1) -&gt; int&gt;)}</code></pre>
</div>
</div>
</section>
</section>
<section id="access-the-notebook-path-cells-content-and-current-cell-id" class="level2">
<h2 class="anchored" data-anchor-id="access-the-notebook-path-cells-content-and-current-cell-id">Access the notebook path, cells content and current cell id</h2>
<p>The 4 notebook properties below are <strong>silently injected by the Jupyterlab frontend extension</strong> before each code cell is executed.</p>
<p>This will not work if the wordslab-notebooks-lib Jupyterlab extension is not installed.</p>
<hr>
<section id="find_var" class="level3">
<h3 class="anchored" data-anchor-id="find_var">find_var</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_var(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    var:<span class="bu">str</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Search for var in all frames of the call stack</em></p>
<hr>
</section>
<section id="wordslabnotebook" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook">WordslabNotebook</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> WordslabNotebook(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Jupyterlab notebook introspection and metaprogramming.</em></p>
<div id="16180d26-5d5b-4c01-93d6-60c910f257bf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>notebook <span class="op">=</span> WordslabNotebook()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="13af8845-c7f8-440b-a80f-097c7cf1a541" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>notebook.jupyterlab_extension_version</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'0.0.13'</code></pre>
</div>
</div>
<div id="2906d67c-0764-4816-92c6-4063f17621aa" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>notebook.path</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'wordslab-notebooks-lib/nbs/04_notebook.ipynb'</code></pre>
</div>
</div>
<div id="45a764c9-e0ab-415c-947c-bdb12d26a2dd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>notebook.content.metadata</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'kernelspec': {'display_name': 'wordslab-notebooks-lib',
  'language': 'python',
  'name': 'wordslab-notebooks-lib'},
 'language_info': {'codemirror_mode': {'name': 'ipython', 'version': 3},
  'file_extension': '.py',
  'mimetype': 'text/x-python',
  'name': 'python',
  'nbconvert_exporter': 'python',
  'pygments_lexer': 'ipython3',
  'version': '3.12.12'}}</code></pre>
</div>
</div>
<div id="d16ad869-d651-40bd-af2c-623d82b4edf0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>notebook.cell_id</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'d16ad869-d651-40bd-af2c-623d82b4edf0'</code></pre>
</div>
</div>
<div id="59347d6e-d1f7-4d23-b041-143e42887f6d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>notebook.cell_id</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'59347d6e-d1f7-4d23-b041-143e42887f6d'</code></pre>
</div>
</div>
</section>
</section>
<section id="create-update-delete-and-run-notebook-cells" class="level2">
<h2 class="anchored" data-anchor-id="create-update-delete-and-run-notebook-cells">Create, update, delete and run notebook cells</h2>
<p>These methods can be used to manipulate the notebook cells when the wordslab-notebooks-lib Jupyterlab frontend extension is installed.</p>
<p>They are inspired by the library <strong>dialoghelper</strong> from <strong>Answer.ai</strong>, but are adapted to the standard Jupyterlab context.</p>
<hr>
<section id="wordslabnotebook.add_cell" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.add_cell">WordslabNotebook.add_cell</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_cell(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    content:<span class="bu">str</span>, <span class="co"># Content of the cell (i.e the prompt, code, or note cell text)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    placement:<span class="bu">str</span><span class="op">=</span><span class="st">'add_after'</span>, <span class="co"># Can be 'add_after', 'add_before', 'at_start', 'at_end'</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    cell_id:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of the cell that placement is relative to (if None, uses current cell)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    cell_type:<span class="bu">str</span><span class="op">=</span><span class="st">'note'</span>, <span class="co"># Cell type, can be 'code', 'note', or 'prompt'</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    notebook_path:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Notebook to update, defaults to current notebook</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Add a cell to the current notebook or any other opened notebook (<code>notebook_path</code>),</em> at the start/end of the notebook or before/after any cell (<code>placement</code>and <code>cell_id</code>), with a <code>cell_type</code> (note|prompt|code) and <code>content</code> (text). Returns the new cell id.</p>
<div id="c5f82d04-da89-467d-824c-6b927d9e4611" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test note"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'a1cc961e-e918-4ac7-9398-7c6fa574f6f2'</code></pre>
</div>
</div>
<p>Test note</p>
<div id="0d6cdddf-e3e8-439c-b84c-ad4574904b20" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test note 2"</span>, placement<span class="op">=</span><span class="st">"add_after"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'984dea0c-450c-488f-8115-82e92d56c0ea'</code></pre>
</div>
</div>
<p>Test note 2</p>
<p>Test note 3</p>
<div id="c8493a92-de5d-405b-9af0-a61925033f48" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test note 3"</span>, placement<span class="op">=</span><span class="st">"add_before"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'1e24f157-66dc-4200-8b12-523c92bb447d'</code></pre>
</div>
</div>
<div id="df9be2ea-ca6e-493d-b47d-9db553ccc618" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test note 4"</span>, placement<span class="op">=</span><span class="st">"at_start"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'01d8ebd2-7a4d-479a-939a-d345a9660211'</code></pre>
</div>
</div>
<div id="8b7599ed-71a6-42f4-afef-d1e9fda0282f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test note 5"</span>, placement<span class="op">=</span><span class="st">"at_end"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'b135d91b-63c0-4a73-8172-d7e73e3a5cf3'</code></pre>
</div>
</div>
<div id="604d0398-12f5-4dca-b4ed-2d318353fd2c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a new cell at the end of the notebook</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test note somewhere"</span>, placement<span class="op">=</span><span class="st">"somewhere"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'28690fe7-bf10-4781-8067-432f45d18c7f'</code></pre>
</div>
</div>
<div id="ffde7023-6401-4b47-a367-96bb311096ba" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test prompt"</span>, cell_type<span class="op">=</span><span class="st">'prompt'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'c41b364b-74da-4886-a974-1683e8143864'</code></pre>
</div>
</div>
<div id="c41b364b-74da-4886-a974-1683e8143864" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Test prompt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2a7c6ef1-8f1a-42f5-a526-d8598c400b0b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test code"</span>, cell_type<span class="op">=</span><span class="st">'code'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'cd02e818-4989-40a8-90ce-8e92a99bcd59'</code></pre>
</div>
</div>
<div id="cd02e818-4989-40a8-90ce-8e92a99bcd59" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Test code</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="63369af0-c559-41e7-8d76-e85298bd2f1d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new cell of type note</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test sometype"</span>, cell_type<span class="op">=</span><span class="st">'sometype'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'e80dbc6b-0832-423f-8e33-aacc0ea52039'</code></pre>
</div>
</div>
<p>Test sometype</p>
<div id="1d8cb999-9bac-461d-a51e-7d3b49280f5b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test bad cell id"</span>, cell_id<span class="op">=</span><span class="st">"bad_cell_id"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[69]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">await</span> notebook.add_cell(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Test bad cell id</span><span class="ansi-yellow-fg">"</span>, cell_id=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">bad_cell_id</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[65]</span><span class="ansi-green-fg">, line 25</span>, in <span class="ansi-cyan-fg">add_cell</span><span class="ansi-blue-fg">(self, content, placement, cell_id, cell_type, notebook_path)</span>
<span class="ansi-green-fg">     23</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">cell_id</span><span class="ansi-yellow-fg">'</span>]
<span class="ansi-green-fg">     24</span> <span style="font-weight:bold;color:rgb(0,135,0)">elif</span> <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span> <span style="font-weight:bold;color:rgb(175,0,255)">in</span> result:
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">25</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">RuntimeError</span>(result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span>])

<span class="ansi-red-fg">RuntimeError</span>: Cell not found: bad_cell_id</pre>
</div>
</div>
</div>
<div id="c998d2d3-bd05-4984-bd50-ec02b63119da" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test other notebook (bad notebook name)"</span>, placement<span class="op">=</span><span class="st">"at_start"</span>, notebook_path<span class="op">=</span><span class="st">"wordslab-notebooks-lib/nbs/temp.ipynb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[73]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">await</span> notebook.add_cell(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Test other notebook (bad notebook name)</span><span class="ansi-yellow-fg">"</span>, placement=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">at_start</span><span class="ansi-yellow-fg">"</span>, notebook_path=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">wordslab-notebooks-lib/nbs/temp.ipynb</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[65]</span><span class="ansi-green-fg">, line 25</span>, in <span class="ansi-cyan-fg">add_cell</span><span class="ansi-blue-fg">(self, content, placement, cell_id, cell_type, notebook_path)</span>
<span class="ansi-green-fg">     23</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">cell_id</span><span class="ansi-yellow-fg">'</span>]
<span class="ansi-green-fg">     24</span> <span style="font-weight:bold;color:rgb(0,135,0)">elif</span> <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span> <span style="font-weight:bold;color:rgb(175,0,255)">in</span> result:
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">25</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">RuntimeError</span>(result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span>])

<span class="ansi-red-fg">RuntimeError</span>: Notebook not found: wordslab-notebooks-lib/nbs/temp.ipynb. Make sure the notebook is opened in Jupyterlab.</pre>
</div>
</div>
</div>
<div id="9d5d5ef1-fdc7-4676-afd1-0328811c7044" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test other notebook (open)"</span>, placement<span class="op">=</span><span class="st">"at_start"</span>, notebook_path<span class="op">=</span><span class="st">"wordslab-notebooks-lib/nbs/test.ipynb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'637eb2a9-421c-4a7c-99aa-e2426b9eab64'</code></pre>
</div>
</div>
<div id="7a54e677-f926-4014-8913-a5ed25ff13a6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.add_cell(<span class="st">"Test other notebook (closed)"</span>, placement<span class="op">=</span><span class="st">"at_start"</span>, notebook_path<span class="op">=</span><span class="st">"wordslab-notebooks-lib/nbs/01_env.ipynb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[75]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">await</span> notebook.add_cell(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Test other notebook (closed)</span><span class="ansi-yellow-fg">"</span>, placement=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">at_start</span><span class="ansi-yellow-fg">"</span>, notebook_path=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">wordslab-notebooks-lib/nbs/01_env.ipynb</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[65]</span><span class="ansi-green-fg">, line 25</span>, in <span class="ansi-cyan-fg">add_cell</span><span class="ansi-blue-fg">(self, content, placement, cell_id, cell_type, notebook_path)</span>
<span class="ansi-green-fg">     23</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">cell_id</span><span class="ansi-yellow-fg">'</span>]
<span class="ansi-green-fg">     24</span> <span style="font-weight:bold;color:rgb(0,135,0)">elif</span> <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span> <span style="font-weight:bold;color:rgb(175,0,255)">in</span> result:
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">25</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">RuntimeError</span>(result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span>])

<span class="ansi-red-fg">RuntimeError</span>: Notebook not found: wordslab-notebooks-lib/nbs/01_env.ipynb. Make sure the notebook is opened in Jupyterlab.</pre>
</div>
</div>
</div>
<hr>
</section>
<section id="wordslabnotebook.update_cell" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.update_cell">WordslabNotebook.update_cell</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_cell(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    cell_id:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of the cell to update (if None, uses current cell)</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    content:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Content of the cell (i.e the prompt, code, or note cell text)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    notebook_path:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Notebook to update, defaults to current notebook</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Update the cell identified by <code>cell_id</code>,</em> in the current notebook or any other opened notebook (<code>notebook_path</code>), with a new <code>content</code>. Returns the updated cell id.</p>
<div id="41cf27a2-cada-4c03-a3a4-3f9852160afd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>orig_cell_id <span class="op">=</span> <span class="cf">await</span> notebook.add_cell(<span class="st">"original cell content"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>updated cell content</p>
<div id="d9a7a601-6463-473f-aaae-be68224c7f18" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.update_cell(cell_id<span class="op">=</span>orig_cell_id, content<span class="op">=</span><span class="st">"updated cell content"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'293c77e8-5449-407a-8b4f-0d628c45bfc7'</code></pre>
</div>
</div>
<div id="fdb7129f-e987-4ba1-91f5-973a9a5e86ed" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.update_cell(content<span class="op">=</span><span class="st">"no id"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[95]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">await</span> notebook.update_cell(content=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">no id</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[94]</span><span class="ansi-green-fg">, line 13</span>, in <span class="ansi-cyan-fg">update_cell</span><span class="ansi-blue-fg">(self, cell_id, content, notebook_path)</span>
<span class="ansi-green-fg">     11</span> <span style="color:rgb(0,135,0)">self</span>._ensure_jupyterlab_extension()
<span class="ansi-green-fg">     12</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> cell_id:
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">13</span>      <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">`cell_id` parameter is mandatory</span><span class="ansi-yellow-fg">"</span>)
<span class="ansi-green-fg">     14</span> result = <span style="font-weight:bold;color:rgb(0,135,0)">await</span> <span style="color:rgb(0,135,0)">self</span>._comm.send({<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">action</span><span class="ansi-yellow-fg">'</span>: <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">update_cell</span><span class="ansi-yellow-fg">'</span>, <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">cell_id</span><span class="ansi-yellow-fg">'</span>: cell_id, <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">content</span><span class="ansi-yellow-fg">'</span>: content, <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">notebook_path</span><span class="ansi-yellow-fg">'</span>: notebook_path })
<span class="ansi-green-fg">     15</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">success</span><span class="ansi-yellow-fg">'</span> <span style="font-weight:bold;color:rgb(175,0,255)">in</span> result <span style="font-weight:bold;color:rgb(175,0,255)">and</span> result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">success</span><span class="ansi-yellow-fg">'</span>]:

<span class="ansi-red-fg">ValueError</span>: `cell_id` parameter is mandatory</pre>
</div>
</div>
</div>
<div id="ac044f66-c7d8-4390-a94b-73aad009e22f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.update_cell(cell_id<span class="op">=</span><span class="st">"bad_cell_id"</span>, content<span class="op">=</span><span class="st">"bad id"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[96]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">await</span> notebook.update_cell(cell_id=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">bad_cell_id</span><span class="ansi-yellow-fg">"</span>, content=<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">bad id</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[94]</span><span class="ansi-green-fg">, line 18</span>, in <span class="ansi-cyan-fg">update_cell</span><span class="ansi-blue-fg">(self, cell_id, content, notebook_path)</span>
<span class="ansi-green-fg">     16</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">cell_id</span><span class="ansi-yellow-fg">'</span>]
<span class="ansi-green-fg">     17</span> <span style="font-weight:bold;color:rgb(0,135,0)">elif</span> <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span> <span style="font-weight:bold;color:rgb(175,0,255)">in</span> result:
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">18</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">RuntimeError</span>(result[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">error</span><span class="ansi-yellow-fg">'</span>])

<span class="ansi-red-fg">RuntimeError</span>: Cell not found: bad_cell_id</pre>
</div>
</div>
</div>
<div id="e11eeb90-a7b9-482f-9004-f9f3e05e6cd1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>orig_cell_id <span class="op">=</span> <span class="cf">await</span> notebook.add_cell(<span class="st">"original cell content in other notebook"</span>, placement<span class="op">=</span><span class="st">"at_start"</span>, notebook_path<span class="op">=</span><span class="st">"wordslab-notebooks-lib/nbs/test.ipynb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="3095419b-ea27-4c7f-90ba-9b12ca63d587" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.update_cell(cell_id<span class="op">=</span>orig_cell_id, content<span class="op">=</span><span class="st">"updated cell content in other notebook"</span>, notebook_path<span class="op">=</span><span class="st">"wordslab-notebooks-lib/nbs/test.ipynb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'55d9b34d-7e39-4cb6-9c95-eb0b9e0176f3'</code></pre>
</div>
</div>
<hr>
</section>
<section id="wordslabnotebook.delete_cell" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.delete_cell">WordslabNotebook.delete_cell</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delete_cell(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    cell_id:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of cell to delete</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    notebook_path:<span class="bu">str</span><span class="op">=</span><span class="st">''</span>, <span class="co"># Notebook to update, defaults to current notebook</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>“Update the cell identified by <code>cell_id</code>,</em> in the current notebook or any other opened notebook (<code>notebook_path</code>). Returns the deleted cell id.</p>
<div id="828edc62-ff0f-47fa-b8ed-ee174de1be79" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.delete_cell(cell_id<span class="op">=</span><span class="st">"01d8ebd2-7a4d-479a-939a-d345a9660211"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'01d8ebd2-7a4d-479a-939a-d345a9660211'</code></pre>
</div>
</div>
<div id="7a90da94-d823-40de-9395-851baa3bb0e3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.delete_cell(cell_id<span class="op">=</span><span class="st">"55d9b34d-7e39-4cb6-9c95-eb0b9e0176f3"</span>, notebook_path<span class="op">=</span><span class="st">"wordslab-notebooks-lib/nbs/test.ipynb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'55d9b34d-7e39-4cb6-9c95-eb0b9e0176f3'</code></pre>
</div>
</div>
<hr>
</section>
<section id="wordslabnotebook.run_cell" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.run_cell">WordslabNotebook.run_cell</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_cell(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    cell_id:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of cell to execute</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>“Adds the cell identified by <code>cell_id</code> to the run queue, only in the current notebook (jupyterlab ‘run-cell’ command limitation).</em> Returns the cell id. DOES NOT return the result of the execution: the target cell will only be run after the current cell execution finishes. Use the <code>read_cell</code> method later with the same <code>cell_id</code> to get the result of the execution.</p>
<div id="bb9dd42c-21ed-468b-847f-e7b5454fd4ae" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>code_cell_id <span class="op">=</span> <span class="cf">await</span> notebook.add_cell(cell_type<span class="op">=</span><span class="st">"code"</span>, content<span class="op">=</span><span class="st">"1+1"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="2a7bc090-ef99-4a21-bf9e-475d24de51c5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>2</code></pre>
</div>
</div>
<div id="fb39c131-297c-4d91-be99-59fefae1a79b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> notebook.run_cell(cell_id<span class="op">=</span>code_cell_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'2a7bc090-ef99-4a21-bf9e-475d24de51c5'</code></pre>
</div>
</div>
<hr>
</section>
<section id="wordslabnotebook.read_cell" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.read_cell">WordslabNotebook.read_cell</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_cell(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    cell_id:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># id of cell to delete</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>“Read the text content of the cell identified by <code>cell_id</code>, only in the current notebook.</em> Returns the text content of the cell as a single multiline string.</p>
<div id="8030fe52-4f54-4987-8a4e-22a275661cbe" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>above_cell_id <span class="op">=</span> <span class="st">"df396dbb-8ecf-41df-b4cf-1f484dabb0fb"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="aba3cd98-16b7-45c4-91db-8ae058665f2c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>notebook.read_cell(above_cell_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'#|export\n@patch\ndef read_cell(\n    self: WordslabNotebook,\n    cell_id: str = None,  # id of cell to delete\n):\n    """"Read the text content of the cell identified by `cell_id`, only in the current notebook.\n    Returns the text content of the cell as a single multiline string."""\n    self._ensure_jupyterlab_extension()\n    if not cell_id:\n        raise ValueError("`cell_id` parameter is mandatory")\n    cell = next((c for c in self.content.cells if c.id == cell_id), None)\n    if not cell:\n        raise ValueError(f"Cell not found: {cell_id}")\n    return cell.source'</code></pre>
</div>
</div>
</section>
</section>
<section id="explore-the-notebook-variables-functions-and-objects" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-notebook-variables-functions-and-objects">Explore the notebook variables, functions and objects</h2>
<hr>
<section id="wordslabnotebook.show_variables_and_functions" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.show_variables_and_functions">WordslabNotebook.show_variables_and_functions</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_variables_and_functions(</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Display the variables and functions defined by the user so far in the notebook.</em></p>
<div id="75fe1e32-c04d-475f-8632-0cc3d3f93ba8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>notebook.show_variables_and_functions()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<h4 class="anchored">Variables</h4>
<table class="caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Value</th>
</tr>
<tr class="even">
<td>Code</td>
<td>functools.partial(&lt;function ft at 0x7b36600a9580&gt;, 'code', void_=False)</td>
</tr>
<tr class="odd">
<td>Source</td>
<td>functools.partial(&lt;function ft at 0x7b36600a9580&gt;, 'source', void_=True)</td>
</tr>
<tr class="even">
<td>shell</td>
<td>&lt;ipykernel.zmqshell.ZMQInteractiveShell object at 0x7b3670078680&gt;</td>
</tr>
<tr class="odd">
<td>user_items</td>
<td>None</td>
</tr>
<tr class="even">
<td>variables</td>
<td>{'Code': "functools.partial(&lt;function ft at 0x7b36600a9580&gt;, 'code', void_=False)", 'Source': "functools.partial(&lt;function ft at 0x7b36600a9580&gt;, 'source', void_=True)", 'shell': '&lt;ipykernel.zmqshell.…</td>
</tr>
<tr class="odd">
<td>functions</td>
<td>{'_safe_str': '(obj, max_str_len=200)'}</td>
</tr>
<tr class="even">
<td>get_variables_values</td>
<td>None</td>
</tr>
<tr class="odd">
<td>get_tools_schemas_and_functions</td>
<td>None</td>
</tr>
<tr class="even">
<td>notebook</td>
<td>&lt;__main__.WordslabNotebook object at 0x7b3640f956a0&gt;</td>
</tr>
<tr class="odd">
<td>add_cell</td>
<td>None</td>
</tr>
<tr class="even">
<td>update_cell</td>
<td>None</td>
</tr>
<tr class="odd">
<td>delete_cell</td>
<td>None</td>
</tr>
<tr class="even">
<td>run_cell</td>
<td>None</td>
</tr>
<tr class="odd">
<td>read_cell</td>
<td>None</td>
</tr>
<tr class="even">
<td>show_variables_and_functions</td>
<td>None</td>
</tr>
</tbody>
</table>
<h4 class="anchored">Functions</h4>
<table class="caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Signature</th>
</tr>
<tr class="even">
<td>_safe_str</td>
<td>(obj, max_str_len=200)</td>
</tr>
<tr class="odd">
<td>_get_schema</td>
<td>(ns: dict, t)</td>
</tr>
<tr class="even">
<td>example_sum</td>
<td>(a: int, b: int = 1) -&gt; int</td>
</tr>
<tr class="odd">
<td>_find_frame_dict</td>
<td>(var: str)</td>
</tr>
<tr class="even">
<td>find_var</td>
<td>(var: str)</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="wordslabnotebook.show_object_members" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.show_object_members">WordslabNotebook.show_object_members</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_object_members(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    obj</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Display the attributes and methods of a given python object</em></p>
<div id="b602a192-b7e7-4976-a26d-4fa1854879b4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>notebook.show_object_members(notebook)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Object of type: WordslabNotebook</h3><pre>Jupyterlab notebook introspection and metaprogramming.</pre><h4 class="anchored">Attributes</h4>
<table class="caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Value</th>
<th data-quarto-table-cell-role="th">Doc</th>
</tr>
<tr class="even">
<td>cell_id</td>
<td>str</td>
<td>b602a192-b7e7-4976-a26d-4fa1854879b4</td>
<td>Unique ID of the current notebook cell, useful to locate the current cell in the full notebook content</td>
</tr>
<tr class="odd">
<td>chat_model</td>
<td>str</td>
<td>qwen3:30b</td>
<td></td>
</tr>
<tr class="even">
<td>chat_thinking</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
<tr class="odd">
<td>content</td>
<td>NotebookNode</td>
<td>{'metadata': {'kernelspec': {'display_name': 'wordslab-notebooks-lib', 'language': 'python', 'name': 'wordslab-notebooks-lib'}, 'language_info': {'codemirror_mode': {'name': 'ipython', 'version': 3}, …</td>
<td>Full content of the notebook returned as a NotebookNode object from the nbformat library</td>
</tr>
<tr class="even">
<td>jupyterlab_extension_installed</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
<tr class="odd">
<td>jupyterlab_extension_version</td>
<td>str</td>
<td>0.0.13</td>
<td>wordslab-notebooks-lib version number injected by the Jupyterlab frontend extension</td>
</tr>
<tr class="even">
<td>path</td>
<td>str</td>
<td>wordslab-notebooks-lib/nbs/04_notebook.ipynb</td>
<td>Relative path of the notebook .ipynb file in the notebook workspace</td>
</tr>
</tbody>
</table>
<h4 class="anchored">Methods</h4>
<table class="caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Signatue</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Doc</th>
</tr>
<tr class="even">
<td>JupyterlabExtensionComm</td>
<td>(target_name='wordslab_notebooks', timeout=2.0)</td>
<td>instance method</td>
<td></td>
</tr>
<tr class="odd">
<td>add_cell</td>
<td>(content: str, placement: str = 'add_after', cell_id: str = None, cell_type: str = 'note', notebook_path: str = '')</td>
<td>instance method</td>
<td>Add a cell to the current notebook or any other opened notebook (`notebook_path`), at the start/end of the notebook or before/after any cell (`placement`and `cell_id`), with a `cell_type` (note|prompt…</td>
</tr>
<tr class="even">
<td>delete_cell</td>
<td>(cell_id: str = None, notebook_path: str = '')</td>
<td>instance method</td>
<td>"Update the cell identified by `cell_id`, in the current notebook or any other opened notebook (`notebook_path`). Returns the deleted cell id.</td>
</tr>
<tr class="odd">
<td>read_cell</td>
<td>(cell_id: str = None)</td>
<td>instance method</td>
<td>"Read the text content of the cell identified by `cell_id`, only in the current notebook. Returns the text content of the cell as a single multiline string.</td>
</tr>
<tr class="even">
<td>run_cell</td>
<td>(cell_id: str = None)</td>
<td>instance method</td>
<td>"Adds the cell identified by `cell_id` to the run queue, only in the current notebook (jupyterlab 'run-cell' command limitation). Returns the cell id. DOES NOT return the result of the execution: the …</td>
</tr>
<tr class="odd">
<td>show_object_members</td>
<td>(obj)</td>
<td>instance method</td>
<td>Display the attributes and methods of a given python object</td>
</tr>
<tr class="even">
<td>show_variables_and_functions</td>
<td>()</td>
<td>instance method</td>
<td>Display the variables and functions defined by the user so far in the notebook.</td>
</tr>
<tr class="odd">
<td>update_cell</td>
<td>(cell_id: str = None, content: str = None, notebook_path: str = '')</td>
<td>instance method</td>
<td>Update the cell identified by `cell_id`, in the current notebook or any other opened notebook (`notebook_path`), with a new `content`. Returns the updated cell id.</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="get-variable-values-and-tool-schemas-referenced-in-prompt-cells" class="level2">
<h2 class="anchored" data-anchor-id="get-variable-values-and-tool-schemas-referenced-in-prompt-cells">Get $variable values and &amp;tool schemas referenced in prompt cells</h2>
<hr>
<section id="wordslabnotebook.get_tools_schemas_and_functions" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.get_tools_schemas_and_functions">WordslabNotebook.get_tools_schemas_and_functions</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_tools_schemas_and_functions(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    func_names:<span class="bu">list</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Get a json schema of functions which can be used as tools.</em></p>
<hr>
</section>
<section id="wordslabnotebook.get_variables_values" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.get_variables_values">WordslabNotebook.get_variables_values</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_variables_values(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    var_names:<span class="bu">list</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Get a safe and serializable representation of variables values.</em></p>
<div id="3d5255a8-3b6c-4f0b-b2a5-eff7900e924f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>notebook.get_variables_values(var_names<span class="op">=</span>[<span class="st">"variables"</span>, <span class="st">"functions"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'variables': {'Code': "functools.partial(&lt;function ft&gt;, 'code', void_=False)",
  'Source': "functools.partial(&lt;function ft&gt;, 'source', void_=True)",
  'shell': '&lt;ipykernel.zmqshell.ZMQInteractiveShell object&gt;',
  'user_items': 'None'},
 'functions': {'_safe_str': '(obj, max_str_len=200)'}}</code></pre>
</div>
</div>
<div id="8b662c62-553a-416c-89bd-6d77e65b9ddb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>notebook.get_tools_schemas_and_functions([<span class="st">"example_sum"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'example_sum': ({'type': 'function',
   'function': {'name': 'example_sum',
    'description': 'Adds a + b.\n\nReturns:\n- type: integer',
    'parameters': {'type': 'object',
     'properties': {'a': {'type': 'integer',
       'description': 'First thing to sum'},
      'b': {'type': 'integer',
       'description': 'Second thing to sum',
       'default': 1}},
     'required': ['a']}}},
  &lt;function __main__.example_sum(a: int, b: int = 1) -&gt; int&gt;)}</code></pre>
</div>
</div>
</section>
</section>
<section id="collect-the-notebook-context-for-llm-calls" class="level2">
<h2 class="anchored" data-anchor-id="collect-the-notebook-context-for-llm-calls">Collect the notebook context for LLM calls</h2>
<p>The notebook cells format is documented here:</p>
<p>https://nbformat.readthedocs.io/en/latest/format_description.html</p>
<p>Code cell outputs are a list, where each item has an output_type. The main types are:</p>
<ul>
<li>stream — stdout/stderr text (e.g., from print())</li>
</ul>
<p>Has name (stdout/stderr) and text fields</p>
<ul>
<li>execute_result — the return value of the last expression</li>
</ul>
<p>Has data dict with MIME types like text/plain, text/html, image/png</p>
<ul>
<li>display_data — from display() calls</li>
</ul>
<p>Same data dict structure as execute_result</p>
<ul>
<li>error — exceptions</li>
</ul>
<p>Has ename, evalue, and traceback fields</p>
<p>The tricky part is that execute_result and display_data can contain multiple representations of the same data (e.g., a pandas DataFrame might have both text/plain and text/html versions).</p>
<blockquote class="blockquote">
<p>Here is an example of “note” cell</p>
</blockquote>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'id'</span>: <span class="st">'eb560f48-42a2-4573-bf12-b3edb40bff20'</span>,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'cell_type'</span>: <span class="st">'markdown'</span>,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'source'</span>: <span class="st">'Code cell outputs in nbformat are a list, where each item has an output_type. The main types are:</span><span class="ch">\n\n</span><span class="st">- stream — stdout/stderr text (e.g., from print())</span><span class="ch">\n\n</span><span class="st">Has name (stdout/stderr) and text fields</span><span class="ch">\n\n</span><span class="st">- execute_result — the return value of the last expression</span><span class="ch">\n\n</span><span class="st">Has data dict with MIME types like text/plain, text/html, image/png</span><span class="ch">\n\n</span><span class="st">- display_data — from display() calls</span><span class="ch">\n\n</span><span class="st">Same data dict structure as execute_result</span><span class="ch">\n\n</span><span class="st">- error — exceptions</span><span class="ch">\n\n</span><span class="st">Has ename, evalue, and traceback fields</span><span class="ch">\n\n</span><span class="st">The tricky part is that execute_result and display_data can contain multiple representations of the same data (e.g., a pandas DataFrame might have both text/plain and text/html versions).'</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'metadata'</span>: {}}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<blockquote class="blockquote">
<p>Here is an example of “prompt” cell</p>
</blockquote>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'id'</span>: <span class="st">'3d5a241d-890c-46db-acf5-d92886f9a77d'</span>,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'cell_type'</span>: <span class="st">'code'</span>,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'source'</span>: <span class="st">'# This is an example of prompt</span><span class="ch">\n</span><span class="st">print("and this is an example of answer")'</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'metadata'</span>: {<span class="st">'trusted'</span>: <span class="va">True</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'wordslab_cell_type'</span>: <span class="st">'prompt'</span>,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'execution'</span>: {<span class="st">'iopub.status.busy'</span>: <span class="st">'2025-12-29T15:47:42.347364Z'</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>   <span class="st">'iopub.execute_input'</span>: <span class="st">'2025-12-29T15:47:42.347549Z'</span>,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>   <span class="st">'iopub.status.idle'</span>: <span class="st">'2025-12-29T15:47:42.350815Z'</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">'shell.execute_reply.started'</span>: <span class="st">'2025-12-29T15:47:42.347534Z'</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>   <span class="st">'shell.execute_reply'</span>: <span class="st">'2025-12-29T15:47:42.349884Z'</span>}},</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'outputs'</span>: [{<span class="st">'name'</span>: <span class="st">'stdout'</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>   <span class="st">'output_type'</span>: <span class="st">'stream'</span>,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>   <span class="st">'text'</span>: <span class="st">'and this is an example of answer</span><span class="ch">\n</span><span class="st">'</span>}],</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a> <span class="st">'execution_count'</span>: <span class="dv">248</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<blockquote class="blockquote">
<p>Here is an example of code cell</p>
</blockquote>
<p>This code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML, Markdown</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stream (stdout)</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"This is stdout"</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co"># stream (stderr)</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"This is stderr"</span>, <span class="bu">file</span><span class="op">=</span>sys.stderr)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co"># display_data (multiple formats)</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>display(HTML(<span class="st">"&lt;b&gt;Bold HTML&lt;/b&gt;"</span>))</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="st">"**Bold Markdown**"</span>))</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co"># execute_result (last expression)</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>{<span class="st">"key"</span>: <span class="st">"value"</span>, <span class="st">"number"</span>: <span class="dv">42</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Produces these outputs</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>[{<span class="st">'name'</span>: <span class="st">'stdout'</span>, <span class="st">'output_type'</span>: <span class="st">'stream'</span>, <span class="st">'text'</span>: <span class="st">'This is stdout</span><span class="ch">\n</span><span class="st">'</span>},</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a> {<span class="st">'name'</span>: <span class="st">'stderr'</span>, <span class="st">'output_type'</span>: <span class="st">'stream'</span>, <span class="st">'text'</span>: <span class="st">'This is stderr</span><span class="ch">\n</span><span class="st">'</span>},</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a> {<span class="st">'output_type'</span>: <span class="st">'display_data'</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'data'</span>: {<span class="st">'text/plain'</span>: <span class="st">'&lt;IPython.core.display.HTML object&gt;'</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>   <span class="st">'text/html'</span>: <span class="st">'&lt;b&gt;Bold HTML&lt;/b&gt;'</span>},</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'metadata'</span>: {}},</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a> {<span class="st">'output_type'</span>: <span class="st">'display_data'</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'data'</span>: {<span class="st">'text/plain'</span>: <span class="st">'&lt;IPython.core.display.Markdown object&gt;'</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">'text/markdown'</span>: <span class="st">'**Bold Markdown**'</span>},</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">'metadata'</span>: {}},</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a> {<span class="st">'execution_count'</span>: <span class="dv">223</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">'output_type'</span>: <span class="st">'execute_result'</span>,</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">'data'</span>: {<span class="st">'text/plain'</span>: <span class="st">"{'key': 'value', 'number': 42}"</span>},</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">'metadata'</span>: {}},</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a> {<span class="st">'traceback'</span>: [<span class="st">'</span><span class="ch">\x1b</span><span class="st">[31m---------------------------------------------------------------------------</span><span class="ch">\x1b</span><span class="st">[39m'</span>,</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>   <span class="st">'</span><span class="ch">\x1b</span><span class="st">[31mValueError</span><span class="ch">\x1b</span><span class="st">[39m                                Traceback (most recent call last)'</span>,</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>   <span class="st">'</span><span class="ch">\x1b</span><span class="st">[36mCell</span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\x1b</span><span class="st">[36m </span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\x1b</span><span class="st">[32mIn[224]</span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\x1b</span><span class="st">[32m, line 1</span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\n\x1b</span><span class="st">[32m----&gt; </span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\x1b</span><span class="st">[32m1</span><span class="ch">\x1b</span><span class="st">[39m </span><span class="ch">\x1b</span><span class="st">[38;5;28;01mraise</span><span class="ch">\x1b</span><span class="st">[39;00m </span><span class="ch">\x1b</span><span class="st">[38;5;167;01mValueError</span><span class="ch">\x1b</span><span class="st">[39;00m(</span><span class="ch">\x1b</span><span class="st">[33m"</span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\x1b</span><span class="st">[33mExample error message</span><span class="ch">\x1b</span><span class="st">[39m</span><span class="ch">\x1b</span><span class="st">[33m"</span><span class="ch">\x1b</span><span class="st">[39m)</span><span class="ch">\n</span><span class="st">'</span>,</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>   <span class="st">'</span><span class="ch">\x1b</span><span class="st">[31mValueError</span><span class="ch">\x1b</span><span class="st">[39m: Example error message'</span>],</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ename'</span>: <span class="st">'ValueError'</span>,</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">'evalue'</span>: <span class="st">'Example error message'</span>,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'output_type'</span>: <span class="st">'error'</span>}]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In this code cell</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'id'</span>: <span class="st">'a1d9fbe2-9a84-4d7d-9415-a2e4693ba7ac'</span>,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'cell_type'</span>: <span class="st">'code'</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'source'</span>: <span class="st">'import sys</span><span class="ch">\n</span><span class="st">from IPython.display import display, HTML, Markdown</span><span class="ch">\n\n</span><span class="st"># stream (stdout)</span><span class="ch">\n</span><span class="st">print("This is stdout")</span><span class="ch">\n\n</span><span class="st"># stream (stderr)</span><span class="ch">\n</span><span class="st">print("This is stderr", file=sys.stderr)</span><span class="ch">\n\n</span><span class="st"># display_data (multiple formats)</span><span class="ch">\n</span><span class="st">display(HTML("&lt;b&gt;Bold HTML&lt;/b&gt;"))</span><span class="ch">\n</span><span class="st">display(Markdown("**Bold Markdown**"))</span><span class="ch">\n\n</span><span class="st"># execute_result (last expression)</span><span class="ch">\n</span><span class="st">{"key": "value", "number": 42}'</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'metadata'</span>: {<span class="st">'trusted'</span>: <span class="va">True</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'execution'</span>: {<span class="st">'iopub.status.busy'</span>: <span class="st">'2025-12-29T15:07:25.670149Z'</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>   <span class="st">'iopub.execute_input'</span>: <span class="st">'2025-12-29T15:07:25.670496Z'</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>   <span class="st">'iopub.status.idle'</span>: <span class="st">'2025-12-29T15:07:25.678474Z'</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>   <span class="st">'shell.execute_reply.started'</span>: <span class="st">'2025-12-29T15:07:25.670471Z'</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">'shell.execute_reply'</span>: <span class="st">'2025-12-29T15:07:25.677678Z'</span>}},</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'outputs'</span>: [...],</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'execution_count'</span>: <span class="dv">223</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The following methods are inspired by the library <strong>toolslm</strong> from <strong>Answer.ai</strong>, but are adapted to our specific goal with prompt cells.</p>
<p>Test</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>[to_xml(_cell_output_to_xml(o)) <span class="cf">for</span> o <span class="kw">in</span> example_output]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Result</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">'&lt;out type="stdout"&gt;This is stdout</span><span class="ch">\n</span><span class="st">&lt;/out&gt;'</span>,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'&lt;out type="stderr"&gt;This is stderr</span><span class="ch">\n</span><span class="st">&lt;/out&gt;'</span>,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'&lt;out type="html"&gt;&amp;lt;b&amp;gt;Bold HTML&amp;lt;/b&amp;gt;&lt;/out&gt;'</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'&lt;out type="markdown"&gt;**Bold Markdown**&lt;/out&gt;'</span>,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'&lt;out type="text"&gt;{</span><span class="ch">\'</span><span class="st">key</span><span class="ch">\'</span><span class="st">: </span><span class="ch">\'</span><span class="st">value</span><span class="ch">\'</span><span class="st">, </span><span class="ch">\'</span><span class="st">number</span><span class="ch">\'</span><span class="st">: 42}&lt;/out&gt;'</span>,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'&lt;out type="error"&gt;ValueError: Example error message&lt;/out&gt;'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Test</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>to_xml(_cell_to_xml(note_cell))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Result</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">'&lt;note&gt;Code cell outputs in nbformat are a list, where each item has an output_type. The main types are:</span><span class="ch">\n\n</span><span class="co">- stream — stdout/stderr text (e.g., from print())</span><span class="ch">\n\n</span><span class="co">Has name (stdout/stderr) and text fields</span><span class="ch">\n\n</span><span class="co">- execute_result — the return value of the last expression</span><span class="ch">\n\n</span><span class="co">Has data dict with MIME types like text/plain, text/html, image/png</span><span class="ch">\n\n</span><span class="co">- display_data — from display() calls</span><span class="ch">\n\n</span><span class="co">Same data dict structure as execute_result</span><span class="ch">\n\n</span><span class="co">- error — exceptions</span><span class="ch">\n\n</span><span class="co">Has ename, evalue, and traceback fields</span><span class="ch">\n\n</span><span class="co">The tricky part is that execute_result and display_data can contain multiple representations of the same data (e.g., a pandas DataFrame might have both text/plain and text/html versions).&lt;/note&gt;'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Test</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>to_xml(_cell_to_xml(prompt_cell))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Result</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">'&lt;prompt&gt;&lt;user&gt;# This is an example of prompt</span><span class="ch">\n</span><span class="co">print("and this is an example of answer")&lt;/user&gt;&lt;assistant&gt;&lt;out type="stdout"&gt;and this is an example of answer</span><span class="ch">\n</span><span class="co">&lt;/out&gt;&lt;/assistant&gt;&lt;/prompt&gt;'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Test</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>to_xml(_cells_to_notebook_xml([note_cell, prompt_cell, code_cell]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Result</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">'&lt;note&gt;Code cell outputs in nbformat are a list, where each item has an output_type. The main types are:</span><span class="ch">\n\n</span><span class="co">- stream — stdout/stderr text (e.g., from print())</span><span class="ch">\n\n</span><span class="co">Has name (stdout/stderr) and text fields</span><span class="ch">\n\n</span><span class="co">- execute_result — the return value of the last expression</span><span class="ch">\n\n</span><span class="co">Has data dict with MIME types like text/plain, text/html, image/png</span><span class="ch">\n\n</span><span class="co">- display_data — from display() calls</span><span class="ch">\n\n</span><span class="co">Same data dict structure as execute_result</span><span class="ch">\n\n</span><span class="co">- error — exceptions</span><span class="ch">\n\n</span><span class="co">Has ename, evalue, and traceback fields</span><span class="ch">\n\n</span><span class="co">The tricky part is that execute_result and display_data can contain multiple representations of the same data (e.g., a pandas DataFrame might have both text/plain and text/html versions).&lt;/note&gt;&lt;prompt&gt;&lt;user&gt;# This is an example of prompt</span><span class="ch">\n</span><span class="co">print("and this is an example of answer")&lt;/user&gt;&lt;assistant&gt;&lt;out type="stdout"&gt;and this is an example of answer</span><span class="ch">\n</span><span class="co">&lt;/out&gt;&lt;/assistant&gt;&lt;/prompt&gt;&lt;code&gt;&lt;source&gt;import sys</span><span class="ch">\n</span><span class="co">from IPython.display import display, HTML, Markdown</span><span class="ch">\n\n</span><span class="co"># stream (stdout)</span><span class="ch">\n</span><span class="co">print("This is stdout")</span><span class="ch">\n\n</span><span class="co"># stream (stderr)</span><span class="ch">\n</span><span class="co">print("This is stderr", file=sys.stderr)</span><span class="ch">\n\n</span><span class="co"># display_data (multiple formats)</span><span class="ch">\n</span><span class="co">display(HTML("&amp;lt;b&amp;gt;Bold HTML&amp;lt;/b&amp;gt;"))</span><span class="ch">\n</span><span class="co">display(Markdown("**Bold Markdown**"))</span><span class="ch">\n\n</span><span class="co"># execute_result (last expression)</span><span class="ch">\n</span><span class="co">{"key": "value", "number": 42}&lt;outputs&gt;&lt;out type="stdout"&gt;This is stdout</span><span class="ch">\n</span><span class="co">&lt;/out&gt;&lt;out type="stderr"&gt;This is stderr</span><span class="ch">\n</span><span class="co">&lt;/out&gt;&lt;out type="html"&gt;&amp;lt;b&amp;gt;Bold HTML&amp;lt;/b&amp;gt;&lt;/out&gt;&lt;out type="markdown"&gt;**Bold Markdown**&lt;/out&gt;&lt;out type="text"&gt;{</span><span class="ch">\'</span><span class="co">key</span><span class="ch">\'</span><span class="co">: </span><span class="ch">\'</span><span class="co">value</span><span class="ch">\'</span><span class="co">, </span><span class="ch">\'</span><span class="co">number</span><span class="ch">\'</span><span class="co">: 42}&lt;/out&gt;&lt;/outputs&gt;&lt;/code&gt;'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<section id="wordslabnotebook.get_context_for_llm" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.get_context_for_llm">WordslabNotebook.get_context_for_llm</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_context_for_llm(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="c6f532d2-d6cc-477b-939e-613189801b2f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated number of tokens for this notebook</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(<span class="bu">len</span>(notebook.get_context_for_llm())<span class="op">/</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>16843</code></pre>
</div>
</div>
</section>
</section>
<section id="notebook.chat---the-notebook-assistant" class="level2">
<h2 class="anchored" data-anchor-id="notebook.chat---the-notebook-assistant">notebook.chat - the notebook assistant</h2>
<section id="prompt-template" class="level3">
<h3 class="anchored" data-anchor-id="prompt-template">Prompt template</h3>
<p>Syntax to reference tools and variables</p>
</section>
<section id="tools-and-variables" class="level3">
<h3 class="anchored" data-anchor-id="tools-and-variables">Tools and variables</h3>
<p>Define test tools and variables</p>
<div id="ca4b650c-a81a-40d5-935c-09daad803a51" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add(a: <span class="bu">int</span>,  <span class="co"># The first number</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>        b: <span class="bu">int</span>   <span class="co"># The second number</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>       ) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co"># The sum of the two numbers</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""Add two numbers"""</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiply(a: <span class="bu">int</span>,  <span class="co"># The first number </span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>             b: <span class="bu">int</span>   <span class="co"># The second number</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co"># The product of the two numbers</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""Multiply two numbers"""</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a <span class="op">*</span> b</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>cat_name <span class="op">=</span> <span class="st">"My cat is named Jerry"</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>dog_name <span class="op">=</span> <span class="st">"My dog is named Rex"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Mention them so they are available to the AI assistant:</p>
<ul>
<li>you can use functions <code>&amp;add</code>, <code>&amp;multiply</code> as tools</li>
<li>you can use variables <code>$cat_name</code>, <code>$dog_name</code>as variables</li>
</ul>
<div id="9b634194-62d1-471f-a022-a01a4308f04f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>context <span class="op">=</span> notebook.get_context_for_llm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d68bc7dd-b2fc-4c9f-8e66-e2478d084e8f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>funcs_names <span class="op">=</span> FUNC_RE.findall(context)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>vars_names <span class="op">=</span> VAR_RE.findall(context)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(funcs_names)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vars_names)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>['myfunc', 'add', 'multiply']
['myvar', 'cat_name', 'dog_name']</code></pre>
</div>
</div>
<div id="54c26111-989d-4572-9149-e9d72d7cdee5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>tools_schemas_and_functions <span class="op">=</span> notebook.get_tools_schemas_and_functions(funcs_names)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>tools_schemas_and_functions</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'add': ({'type': 'function',
   'function': {'name': 'add',
    'description': 'Add two numbers\n\nReturns:\n- type: integer',
    'parameters': {'type': 'object',
     'properties': {'a': {'type': 'integer',
       'description': 'The first number'},
      'b': {'type': 'integer', 'description': 'The second number'}},
     'required': ['a', 'b']}}},
  &lt;function __main__.add(a: int, b: int) -&gt; int&gt;),
 'multiply': ({'type': 'function',
   'function': {'name': 'multiply',
    'description': 'Multiply two numbers\n\nReturns:\n- type: integer',
    'parameters': {'type': 'object',
     'properties': {'a': {'type': 'integer',
       'description': 'The first number'},
      'b': {'type': 'integer', 'description': 'The second number'}},
     'required': ['a', 'b']}}},
  &lt;function __main__.multiply(a: int, b: int) -&gt; int&gt;)}</code></pre>
</div>
</div>
<div id="b21ab45d-208f-4db8-9fa7-1356001a89d3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>tools <span class="op">=</span> Tools([t[<span class="dv">1</span>] <span class="cf">for</span> t <span class="kw">in</span> tools_schemas_and_functions.values()])</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>tools.get_functions()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>[&lt;function __main__.add(a: int, b: int) -&gt; int&gt;,
 &lt;function __main__.multiply(a: int, b: int) -&gt; int&gt;]</code></pre>
</div>
</div>
<div id="2f21614d-e391-43d7-b628-e3d841023f43" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>var_values <span class="op">=</span> notebook.get_variables_values(vars_names)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>var_values</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>{'cat_name': 'My cat is named Jerry', 'dog_name': 'My dog is named Rex'}</code></pre>
</div>
</div>
<div id="4d948c05-8637-4fea-8717-ef4add888ead" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>referenced_variables <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(L([Var(value, name<span class="op">=</span>name) <span class="cf">for</span> name,value <span class="kw">in</span> var_values.items()]).<span class="bu">map</span>(to_xml))</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>referenced_variables</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'&lt;var name="cat_name"&gt;My cat is named Jerry&lt;/var&gt;\n&lt;var name="dog_name"&gt;My dog is named Rex&lt;/var&gt;'</code></pre>
</div>
</div>
<hr>
</section>
<section id="wordslabnotebook.set_ollama_chat_model" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.set_ollama_chat_model">WordslabNotebook.set_ollama_chat_model</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_ollama_chat_model(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    model:<span class="bu">str</span>, think:Union<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    context_size:<span class="bu">int</span><span class="op">=</span><span class="dv">32768</span>, <span class="co"># This is the default value for the ollama server in wordslab-notebooks</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    web_search:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># The ollama API key is necessary to activate web search</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    base_url:<span class="bu">str</span><span class="op">=</span><span class="st">'http://localhost:11434'</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    api_key:Optional<span class="op">=</span><span class="va">None</span>, <span class="co"># If not provided, the optional key will be pulled from WordslabEnv</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="wordslabnotebook.set_openrouter_chat_model" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.set_openrouter_chat_model">WordslabNotebook.set_openrouter_chat_model</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_openrouter_chat_model(</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    model:<span class="bu">str</span>, think:Union<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    context_size:Optional<span class="op">=</span><span class="va">None</span>, <span class="co"># For OpenRouter this parameter is ignored, we inherit the remote model config</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    web_search:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># Web search is activated by default four cloud models in openrouter</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    base_url:<span class="bu">str</span><span class="op">=</span><span class="st">'https://openrouter.ai/api/v1'</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    api_key:Optional<span class="op">=</span><span class="va">None</span>, <span class="co"># If not provided, the mandatory key will be pulled from WordslabEnv</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="wordslabnotebook.chat" class="level3">
<h3 class="anchored" data-anchor-id="wordslabnotebook.chat">WordslabNotebook.chat</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chat(</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    user_instruction:<span class="bu">str</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="0ee54507-adf4-4b27-bfce-7da95e888b3d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> importlib</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wordslab_notebooks_lib.chat</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>importlib.<span class="bu">reload</span>(wordslab_notebooks_lib.chat)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordslab_notebooks_lib.chat <span class="im">import</span> OllamaModelClient, OpenRouterModelClient, Tools</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="646fb4aa-aee7-46fa-88a5-b5de6b7b77fd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>notebook <span class="op">=</span> WordslabNotebook()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6e4598a2-a363-488c-a835-d1b0684f0075" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>notebook.chat(<span class="st">"Using only the provided tools to make no mistake, what is (11545468+78782431)*418742?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown">
<blockquote class="blockquote">
<p>[Thinking] … thought in 1285 words</p>
</blockquote>
<blockquote class="blockquote">
<p>[Tool call] … <code>add</code> returned <code>90327899</code></p>
</blockquote>
<blockquote class="blockquote">
<p>[Tool call] … <code>multiply</code> returned <code>37824085083058</code></p>
</blockquote>
<blockquote class="blockquote">
<p>[Thinking] … thought in 191 words</p>
</blockquote>
<p>37824085083058</p>
</div>
</div>
<div id="ea0a0252-01f9-40e4-8e63-cb7dc4d5a936" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_weather(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    city: <span class="bu">str</span> <span class="co"># A city name</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>: <span class="co"># A sentence describing the weather</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"A service predicting the weather city by city"</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"The weather is nice in </span><span class="sc">{</span>city<span class="sc">}</span><span class="ss"> today"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You can use the service <code>&amp;get_weather</code>.</p>
<div id="084b13d4-a70b-4ff2-b199-ec972db98e3c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>notebook.chat(<span class="st">"What will the weather be like tomorrow in Paris?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown">
<blockquote class="blockquote">
<p>[Thinking] … thought in 309 words</p>
</blockquote>
<blockquote class="blockquote">
<p>[Tool call] … <code>get_weather</code> returned <code>The weather is nice in Paris today</code></p>
</blockquote>
<blockquote class="blockquote">
<p>[Thinking] … thought in 199 words</p>
</blockquote>
<p>The weather is nice in Paris today.</p>
</div>
</div>
<div id="95990a1d-6f17-46da-a31e-7dec7f57c6d6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>notebook.chat(<span class="st">"What's the name of my dog ?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown">
<blockquote class="blockquote">
<p>[Thinking] … thought in 272 words</p>
</blockquote>
<p>Rex</p>
</div>
</div>
<p>Here is the check that the frontend extension will do before executing notebook.chat:</p>
<div id="fe83cfd8-6885-4b93-93ee-aa8e677837b4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"notebook"</span> <span class="kw">in</span> <span class="bu">globals</span>()) <span class="kw">and</span> (<span class="st">"WordslabNotebook"</span> <span class="kw">in</span> <span class="bu">str</span>(<span class="bu">type</span>(notebook)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</section>
</section>
<section id="develop-a-jupyterlab-frontend-extension" class="level2">
<h2 class="anchored" data-anchor-id="develop-a-jupyterlab-frontend-extension">Develop a Jupyterlab frontend extension</h2>
<section id="understand-jupyterlab-kernels-and-frontend-extensions" class="level3">
<h3 class="anchored" data-anchor-id="understand-jupyterlab-kernels-and-frontend-extensions">Understand Jupyterlab kernels and frontend extensions</h3>
<p>Jupyter kernels technical implementation details</p>
<p>https://chatgpt.com/share/692bea08-4510-8004-b9ab-c02feeb97c08</p>
<p>Jupyterlab extension development tutorial</p>
<p>https://jupyterlab.readthedocs.io/en/latest/extension/extension_tutorial.html</p>
</section>
<section id="intialize-the-components-of-a-frontend-extension" class="level3">
<h3 class="anchored" data-anchor-id="intialize-the-components-of-a-frontend-extension">Intialize the components of a frontend extension</h3>
<p>The source code of the Jupyterlab frontend extension can be found in the following files:</p>
<p>Typescript source code, dependencies, and compilation config:</p>
<ul>
<li><code>src/index.ts</code></li>
<li><code>package.json</code></li>
<li><code>tsconfig.json</code></li>
<li><code>.yarnrc.yml</code></li>
</ul>
<p>Extension manifest and Javascript compiled code</p>
<ul>
<li>wordslab_notebooks_lib/labextension
<ul>
<li>package.json</li>
<li>static/remoteEntry.97d57e417eaf8ebadeb6.js</li>
</ul></li>
</ul>
<p>This is how the extension files are included in the python package:</p>
<ul>
<li><code>MANIFEST.in</code></li>
</ul>
<pre><code>include install.json
include package.json
recursive-include wordslab_notebooks_lib/labextension *

graft wordslab_notebooks_lib/labextension
graft src</code></pre>
<p>This is how the extension files are installed in Jupyterlab extensions directory when the python package is installed:</p>
<ul>
<li><code>pyproject.toml</code></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb128"><pre class="sourceCode toml code-with-copy"><code class="sourceCode toml"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[tool.setuptools]</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="dt">include-package-data</span> <span class="op">=</span> <span class="cn">true</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="kw">[tool.setuptools.data-files]</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="dt">"share/jupyter/labextensions/wordslab-notebooks-lib"</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wordslab_notebooks_lib/labextension/package.json"</span><span class="op">,</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"install.json"</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="op">]</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="dt">"share/jupyter/labextensions/wordslab-notebooks-lib/static"</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wordslab_notebooks_lib/labextension/static/*"</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This how the command <code>jupyter labextension develop</code> finds the directory where the extension files live:</p>
<ul>
<li><code>wordslab_notebooks_lib\__init__.py</code></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _jupyter_labextension_paths():</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"src"</span>: <span class="st">"labextension"</span>,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dest"</span>: <span class="st">"wordslab-notebooks-lib"</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    }]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This is how the python package is identified as a Jupyterlab extension in pypi:</p>
<ul>
<li><code>pyproject.toml</code></li>
</ul>
<pre><code>classifiers = [ "Framework :: Jupyter :: JupyterLab :: Extensions :: Prebuilt" ]</code></pre>
</section>
<section id="install-the-jupyterlab-frontend-extension-in-development-mode" class="level3">
<h3 class="anchored" data-anchor-id="install-the-jupyterlab-frontend-extension-in-development-mode">Install the Jupyterlab frontend extension in development mode</h3>
<p>Open a Terminal</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb131"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$WORDSLAB_WORKSPACE</span>/wordslab-notebooks-lib</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> <span class="va">$JUPYTERLAB_ENV</span>/.venv/bin/activate</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Javascript dependencies</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="ex">jlpm</span> install</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Build TypeScript extension</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="ex">jlpm</span> build</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Register the extension with JupyterLab during development</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># jupyter labextension develop . --overwrite</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$JUPYTERLAB_ENV</span>/.venv/share/jupyter/labextensions/wordslab-notebooks-lib</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> <span class="va">$WORDSLAB_WORKSPACE</span>/wordslab-notebooks-lib/wordslab_notebooks_lib/labextension/ <span class="va">$JUPYTERLAB_ENV</span>/.venv/share/jupyter/labextensions/wordslab-notebooks-lib</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify extension is found</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="ex">jupyter</span> labextension list</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="test-the-jupyterlab-frontend-extension" class="level3">
<h3 class="anchored" data-anchor-id="test-the-jupyterlab-frontend-extension">Test the Jupyterlab frontend extension</h3>
<p>After installing the extension in development mode once, you can iterate fast: - update the code in <code>src/index.ts</code> - build the extension with <code>jlpm build</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb132"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$WORDSLAB_WORKSPACE</span>/wordslab-notebooks-lib</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> <span class="va">$JUPYTERLAB_ENV</span>/.venv/bin/activate</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build TypeScript extension</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="ex">jlpm</span> build</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><strong>refresh</strong> the Jupyterlab single page app in your browser</li>
<li>test the updated extension</li>
</ul>
<p>No need to reinstall the extension or to restart Jupyterlab itself, just refresh your browser page.</p>
</section>
</section>
<section id="explore-the-notebook-format" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-notebook-format">Explore the notebook format</h2>
<p>https://nbformat.readthedocs.io/en/latest/format_description.html</p>
<div id="fa0f1ea6-7a2d-4346-acc6-0fd87d27bef9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>nb <span class="op">=</span> nbformat.from_dict(__notebook_content)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>code_language <span class="op">=</span> nb.metadata.language_info.name</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"&gt; "</span> <span class="op">+</span> code_language <span class="op">+</span> <span class="st">" notebook"</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cell <span class="kw">in</span> nb.cells:</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cell.<span class="bu">id</span> <span class="op">==</span> __cell_id: <span class="cf">break</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    is_markdown <span class="op">=</span> cell.cell_type <span class="op">==</span> <span class="st">"markdown"</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    is_code <span class="op">=</span> cell.cell_type <span class="op">==</span> <span class="st">"code"</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    is_raw <span class="op">=</span> cell.cell_type <span class="op">==</span> <span class="st">"raw"</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"---------------------"</span>)</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"cell"</span>, cell.<span class="bu">id</span>, cell.cell_type)</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"---------------------"</span>)</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_markdown:</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(cell.source[:<span class="dv">100</span>])</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> is_code:</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"```</span><span class="sc">{</span>code_language<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">+</span> cell.source[:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">```"</span>)</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> is_raw:</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(cell.source[:<span class="dv">100</span>])</span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_code <span class="kw">and</span> cell.execution_count<span class="op">&gt;</span><span class="dv">0</span> <span class="kw">and</span> <span class="bu">len</span>(cell.outputs)<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"---------------------"</span>)</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"cell outputs"</span>, cell.<span class="bu">id</span>, cell.execution_count)</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"---------------------"</span>)</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> output <span class="kw">in</span> cell.outputs:</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> output.output_type <span class="op">==</span> <span class="st">"stream"</span>:</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"&lt;</span><span class="sc">{</span>output<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&gt;"</span>)</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(output.text[:<span class="dv">100</span>])</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"&lt;/</span><span class="sc">{</span>output<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&gt;"</span>)</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> output.output_type <span class="op">==</span> <span class="st">"display_data"</span>:</span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"&lt;display&gt;"</span>)</span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"data"</span> <span class="kw">in</span> output:</span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;data&gt;"</span>)</span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">repr</span>(output.data)</span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;/data&gt;"</span>)</span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"metadata"</span> <span class="kw">in</span> output <span class="kw">and</span> <span class="bu">len</span>(output.metadata)<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;metadata&gt;"</span>)</span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">repr</span>(output.metadata)</span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;/metadata&gt;"</span>)</span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"&lt;/display&gt;"</span>)</span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> output.output_type <span class="op">==</span> <span class="st">"execute_result"</span>:</span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"&lt;result&gt;"</span>)</span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"data"</span> <span class="kw">in</span> output:</span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;data&gt;"</span>)</span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(output.data)</span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;/data&gt;"</span>)</span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"metadata"</span> <span class="kw">in</span> output <span class="kw">and</span> <span class="bu">len</span>(output.metadata)<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;metadata&gt;"</span>)</span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(output.metadata)</span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"  &lt;/metadata&gt;"</span>)</span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"&lt;/result&gt;"</span>)</span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> output.output_type <span class="op">==</span> <span class="st">"error"</span>:</span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"&lt;error&gt;"</span>)</span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(output.ename)</span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(output.evalue)</span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> frame <span class="kw">in</span> output.traceback:</span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(frame)</span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"&lt;/error&gt;"</span>)</span>
<span id="cb133-60"><a href="#cb133-60" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"---------------------"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; python notebook
---------------------
cell 9d8a6aa0-8f58-4860-bcc1-2bfbdcb438b6 markdown
---------------------
# wordslab-notebooks-lib.jupyterlab

&gt; Access wordslab-notebooks Jupyterlab extension version, curre
---------------------
cell 68f3493d-c252-4eb4-844b-abbd68ed3a70 markdown
---------------------
## Work together with AI in a Jupyterlab notebook - the Solveit method

A Jupyter notebook is a conv
---------------------
cell 0ff6fbdc-4a54-4e29-acbb-07529df8cfdd markdown
---------------------
## Install the Jupyterlab extension - wordslab-notebooks-lib

If you want to use "prompt" cells, you
---------------------
cell 65cd4cf8-d77b-4026-b428-bbd9550ea971 markdown
---------------------
## Communicate with the Jupyterlab extension
---------------------
cell ece4d545-8f78-4232-82fb-e837ea0185e4 code
---------------------
```python
#| export
import nbformat
```
---------------------
cell af2f3f45-f0da-4d37-9e39-b37d19ba5650 code
---------------------
```python
class JupyterlabNotebook:
    def __init__(self):
        if not "__wordslab_extension_version" in g
```
---------------------
cell 16180d26-5d5b-4c01-93d6-60c910f257bf code
---------------------
```python
notebook = JupyterlabNotebook()
```
---------------------
cell 13af8845-c7f8-440b-a80f-097c7cf1a541 code
---------------------
```python
notebook.jupyterlab_extension_version
```
---------------------
cell outputs 13af8845-c7f8-440b-a80f-097c7cf1a541 39
---------------------
&lt;result&gt;
  &lt;data&gt;
{'text/plain': "'0.0.11'"}
  &lt;/data&gt;
&lt;/result&gt;
---------------------
---------------------
cell 2906d67c-0764-4816-92c6-4063f17621aa code
---------------------
```python
notebook.path
```
---------------------
cell outputs 2906d67c-0764-4816-92c6-4063f17621aa 40
---------------------
&lt;result&gt;
  &lt;data&gt;
{'text/plain': "'wordslab-notebooks-lib/nbs/02_jupyterlab.ipynb'"}
  &lt;/data&gt;
&lt;/result&gt;
---------------------
---------------------
cell 45a764c9-e0ab-415c-947c-bdb12d26a2dd code
---------------------
```python
notebook.content.metadata
```
---------------------
cell outputs 45a764c9-e0ab-415c-947c-bdb12d26a2dd 41
---------------------
&lt;result&gt;
  &lt;data&gt;
{'text/plain': "{'kernelspec': {'display_name': 'wordslab-notebooks-lib',\n  'language': 'python',\n  'name': 'wordslab-notebooks-lib'},\n 'language_info': {'codemirror_mode': {'name': 'ipython', 'version': 3},\n  'file_extension': '.py',\n  'mimetype': 'text/x-python',\n  'name': 'python',\n  'nbconvert_exporter': 'python',\n  'pygments_lexer': 'ipython3',\n  'version': '3.12.12'}}"}
  &lt;/data&gt;
&lt;/result&gt;
---------------------
---------------------
cell d16ad869-d651-40bd-af2c-623d82b4edf0 code
---------------------
```python
notebook.cell_id
```
---------------------
cell outputs d16ad869-d651-40bd-af2c-623d82b4edf0 42
---------------------
&lt;result&gt;
  &lt;data&gt;
{'text/plain': "'d16ad869-d651-40bd-af2c-623d82b4edf0'"}
  &lt;/data&gt;
&lt;/result&gt;
---------------------
---------------------
cell 59347d6e-d1f7-4d23-b041-143e42887f6d code
---------------------
```python
notebook.cell_id
```
---------------------
cell outputs 59347d6e-d1f7-4d23-b041-143e42887f6d 43
---------------------
&lt;result&gt;
  &lt;data&gt;
{'text/plain': "'59347d6e-d1f7-4d23-b041-143e42887f6d'"}
  &lt;/data&gt;
&lt;/result&gt;
---------------------
---------------------
cell 9843c2c4-ac54-46d6-9725-0e957e944e3a markdown
---------------------
## Develop a Jupyterlab frontend extension
---------------------
cell 4178ac20-4612-4c8d-8d48-0fd2d2605aa9 markdown
---------------------
### Understand Jupyterlab kernels and frontend extensions

Jupyter kernels technical implementation 
---------------------
cell da7ecd61-80f6-4a00-a795-6866d62b32bb markdown
---------------------
### Intialize the components of a frontend extension

The source code of the Jupyterlab frontend ext
---------------------
cell 7a4146ce-96e0-4c13-9296-67374c833560 markdown
---------------------
### Install the Jupyterlab frontend extension in development mode

Open a Terminal

```bash
cd $WORD
---------------------
cell 6a891df5-84b9-4579-a1ec-18fd7a13ebc2 markdown
---------------------
### Test the Jupyterlab frontend extension 

After installing the extension in development mode once
---------------------
cell 61a8b5d6-7821-4c76-acde-9080fb8ad95b markdown
---------------------
## Explore the notebook format
---------------------
cell bfe108e4-6b27-403d-b5d7-fde736c1f01c markdown
---------------------
https://nbformat.readthedocs.io/en/latest/format_description.html</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/wordslab-org\.github\.io\/wordslab-notebooks-lib");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/wordslab-org/wordslab-notebooks-lib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>