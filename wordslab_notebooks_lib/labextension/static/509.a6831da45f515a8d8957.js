"use strict";(self.webpackChunkwordslab_notebooks_extension=self.webpackChunkwordslab_notebooks_extension||[]).push([[509],{509:(o,e,t)=>{t.r(e),t.d(e,{default:()=>l});var n=t(766);const l={id:"wordslab-notebooks-extension:plugin",description:"JupyterLab extension for wordslab-notebooks",autoStart:!0,requires:[n.INotebookTracker],activate:(o,e)=>{console.log("Wordslab notebooks extension activated");const t=new Map;n.NotebookActions.executionScheduled.connect((o,n)=>{const{notebook:l,cell:s}=n,d=e.find(o=>(null==o?void 0:o.content)===l);if(!d)return;const a=d.sessionContext.path,c=s.model.id;t.set(a,c),console.log(`Cell ${c} executing in notebook ${a}`);const i=()=>{null!==s.model.executionCount&&(t.delete(a),console.log(`Cell ${c} finished executing in notebook ${a}`),s.model.stateChanged.disconnect(i))};s.model.stateChanged.connect(i)});const l=new Set,s=o=>{const e=o.sessionContext;if(!e)return;const n=()=>{var n;const s=null===(n=e.session)||void 0===n?void 0:n.kernel;s&&!l.has(s.id)&&(l.add(s.id),s.registerCommTarget("wordslab_notebook_comm",(n,l)=>{console.log("Comm opened:",{commId:n.commId,targetName:l.content.target_name,openMsgData:l.content.data,notebookPath:e.path}),n.onMsg=l=>{var s,d;if(console.log("Comm message received:",{commId:n.commId,msgData:l.content.data}),"get_notebook_data"===l.content.data.request){const l=e.path,a=t.get(l),c=null===(s=o.model)||void 0===s?void 0:s.toJSON();n.send({notebook:c,cell_id:a}),console.log("Sent notebook data:",{notebookPath:l,cellId:a,cellCount:null===(d=null==c?void 0:c.cells)||void 0===d?void 0:d.length})}}}),console.log(`Comm target registered for kernel ${s.id} (${e.path})`))};e.kernelChanged.connect((o,e)=>{e.oldValue&&(l.delete(e.oldValue.id),console.log(`Kernel ${e.oldValue.id} removed from registry`)),e.newValue&&n()}),e.ready.then(()=>n())};e.forEach(o=>s(o)),e.widgetAdded.connect((o,e)=>s(e))}}}}]);