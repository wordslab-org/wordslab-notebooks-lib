"use strict";(self.webpackChunkwordslab_notebooks_lib=self.webpackChunkwordslab_notebooks_lib||[]).push([[509],{509:(e,o,t)=>{t.r(o),t.d(o,{default:()=>l});var n=t(766);const l={id:"wordslab-notebooks-extension:plugin",description:"JupyterLab extension for wordslab-notebooks",autoStart:!0,requires:[n.INotebookTracker],activate:(e,o)=>{console.log("Wordslab notebooks extension activated");const t=new Map;n.NotebookActions.executionScheduled.connect((e,n)=>{const{notebook:l,cell:s}=n,d=o.find(e=>(null==e?void 0:e.content)===l);if(!d)return;const a=d.sessionContext.path,c=s.model.id;t.has(a)||t.set(a,[]),t.get(a).push(c),console.log(`Cell ${c} queued for execution in ${a}. Queue:`,t.get(a));const i=()=>{if(null!==s.model.executionCount){const e=t.get(a);if(e){const o=e.shift();console.log(`Cell ${o} finished in ${a}. Queue:`,e)}s.model.stateChanged.disconnect(i)}};s.model.stateChanged.connect(i)});const l=new Set,s=e=>{const o=e.sessionContext;if(!o)return;const n=()=>{var n;const s=null===(n=o.session)||void 0===n?void 0:n.kernel;s&&!l.has(s.id)&&(l.add(s.id),s.registerCommTarget("wordslab_notebook_comm",(n,l)=>{console.log("Comm opened:",{commId:n.commId,targetName:l.content.target_name,openMsgData:l.content.data,notebookPath:o.path}),n.onMsg=l=>{var s,d;if(console.log("Comm message received:",{commId:n.commId,msgData:l.content.data}),"get_notebook_data"===l.content.data.request){const l=o.path,a=t.get(l),c=a&&a.length>0?a[0]:void 0,i=null===(s=e.model)||void 0===s?void 0:s.toJSON();n.send({notebook:i,cell_id:c}),console.log("Sent notebook data:",{notebookPath:l,cellId:c,cellCount:null===(d=null==i?void 0:i.cells)||void 0===d?void 0:d.length})}}}),console.log(`Comm target registered for kernel ${s.id} (${o.path})`))};o.kernelChanged.connect((e,o)=>{o.oldValue&&(l.delete(o.oldValue.id),console.log(`Kernel ${o.oldValue.id} removed from registry`)),o.newValue&&n()}),o.ready.then(()=>n())};o.forEach(e=>s(e)),o.widgetAdded.connect((e,o)=>s(o))}}}}]);