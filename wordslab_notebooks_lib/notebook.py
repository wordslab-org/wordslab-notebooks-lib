"""Access wordslab-notebooks Jupyterlab extension version, current notebook path, json content and cell id, and create or update cells."""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/02_notebook.ipynb.

# %% auto 0
__all__ = ['find_var', 'JupyterlabNotebook']

# %% ../nbs/02_notebook.ipynb 5
import nbformat
from inspect import currentframe

# %% ../nbs/02_notebook.ipynb 6
def _find_frame_dict(var:str):
    "Find the dict (globals or locals) containing var"
    frame = currentframe().f_back.f_back
    while frame:
        if var in frame.f_globals: return frame.f_globals
        frame = frame.f_back
    raise ValueError(f"Could not find {var} in any scope")

def find_var(var:str):
    "Search for var in all frames of the call stack"
    return _find_frame_dict(var)[var]

# %% ../nbs/02_notebook.ipynb 7
class JupyterlabNotebook:
    def __init__(self):
        try:
            self.jupyterlab_extension_version
        except:
            raise RuntimeError(
                "The JupyterLab extension for wordslab-notebooks is not activated: "
                "please execute `pip install wordslab-notebooks-lib` in JupyterLab virtual environment "
                "and refresh you web browser."
            )
    
    @property
    def jupyterlab_extension_version(self):
        return find_var("__wordslab_extension_version")
    
    @property
    def path(self):
        return find_var("__notebook_path")

    @property
    def content(self):
        return nbformat.from_dict(find_var("__notebook_content"))
    
    @property
    def cell_id(self):
        return find_var("__cell_id")
